verbose = true

dt = 0.00001

steps = 100000

[grids]
	[grid]
		id = layer_1
		[node]
			name = ElasticMetaNode2D
		[/node]
		[material_node]
		[/material_node]
		[material]
			c1 = 250
			c2 = 150
			rho = 1700
		[/material]
		[factory]
			name = RedGridFactory
			file = layer_1.red
		[/factory]
		[schema]
			name = ElasticCurveSchema2DTVD2MC
		[/schema]
		[fillers]
			[filler]
				name = RectNoReflectFiller
				axis = 0
				side = 0
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 0
				side = 1
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 1
				side = 0
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 1
				side = 1
			[/filler]
	        [/fillers]
	        [correctors]
			[corrector]
				name = ForceRectElasticBoundary2D
				axis = 1
				side = 1
                                [function]
                                        name = RIFunction
                                        time_from = 0
                                        time_to = 0.050329212 # 60 Hz
                                        #time_to = 0.01
                                        magnitude = 0, -10000
                                        [region]
                                                name = CircleRegion
                                                center = 54.5454545455, 62.0784403522
                                                r = 3
                                        [/region]
                                        [impulse]
                                                name = ReikerImpulse
                                        [/impulse]
                                [/function]
			[/corrector]
	        [/correctors]
	[/grid]
	[grid]
		id = layer_2
		[node]
			name = ElasticMetaNode2D
		[/node]
		[material_node]
		[/material_node]
		[material]
			c1 = 700
			c2 = 450
			rho = 1900
		[/material]
		[factory]
			name = RedGridFactory
			file = layer_2.red
		[/factory]
		[schema]
			name = ElasticCurveSchema2DTVD2MC
		[/schema]
		[fillers]
			[filler]
				name = RectNoReflectFiller
				axis = 0
				side = 0
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 0
				side = 1
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 1
				side = 0
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 1
				side = 1
			[/filler]
	        [/fillers]
	        [correctors]
	        [/correctors]
	[/grid]
	[grid]
		id = layer_3
		[node]
			name = ElasticMetaNode2D
		[/node]
		[material_node]
		[/material_node]
		[material]
			c1 = 2000
			c2 = 1300
			rho = 2200
		[/material]
		[factory]
			name = RedGridFactory
			file = layer_3.red
		[/factory]
		[schema]
			name = ElasticCurveSchema2DTVD2MC
		[/schema]
		[fillers]
			[filler]
				name = RectNoReflectFiller
				axis = 0
				side = 0
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 0
				side = 1
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 1
				side = 0
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 1
				side = 1
			[/filler]
	        [/fillers]
	        [correctors]
	        [/correctors]
	[/grid]
[/grids]

[contacts]
	[contact]
		name = GlueRectElasticContact2D
		grid1 = layer_1
		grid2 = layer_2
		tol = 0.005
	[/contact]
	[contact]
		name = GlueRectElasticContact2D
		grid1 = layer_2
		grid2 = layer_3
		tol = 0.005
	[/contact]
[/contacts]

[initials]
[/initials]

[savers]
	[saver]
		name = StructuredVTKSaver
		path = ./VTK/%g_%s.vtk
		order = 0
		save = 100
		params = v, vx, vy
		norms = 1, 0, 0
	[/saver]
	[saver]
		name = SeismogramSaver
		path = ./receivers.csv
		order = 1
		save = 1
		eps = 0.001
		# Day surface.
		points = 0.0, 69.9585858586, 1.51515151515, 70.0671262367, 3.0303030303, 70.0898737746, 4.54545454545, 70.0286138665, 6.06060606061, 69.8829614006, 7.57575757576, 69.6582335445, 9.09090909091, 69.3714056958, 10.6060606061, 69.045368192, 12.1212121212, 68.6974338466, 13.6363636364, 68.3465058836, 15.1515151515, 68.0212439826, 16.6666666667, 67.7519024962, 18.1818181818, 67.5689800618, 19.696969697, 67.5037081867, 21.2121212121, 67.5192707629, 22.7272727273, 67.5021524271, 24.2424242424, 67.3836762107, 25.7575757576, 67.1563031554, 27.2727272727, 66.8191460886, 28.7878787879, 66.380519975, 30.303030303, 65.8923027012, 31.8181818182, 65.4423181179, 33.3333333333, 65.1127870894, 34.8484848485, 64.9010573391, 36.3636363636, 64.7662940999, 37.8787878788, 64.6686189034, 39.3939393939, 64.5405107552, 40.9090909091, 64.310561944, 42.4242424242, 63.9951116227, 43.9393939394, 63.6906242429, 45.4545454545, 63.4680500984, 46.9696969697, 63.320934689, 48.4848484848, 63.226953921, 50.0, 63.1549887243, 51.5151515152, 63.0153530348, 53.0303030303, 62.6948998201, 54.5454545455, 62.0784403522, 56.0606060606, 61.1413831514, 57.5757575758, 60.3731071122, 59.0909090909, 60.2177015402, 60.6060606061, 60.3531677253, 62.1212121212, 60.3184350299, 63.6363636364, 59.9752861779, 65.1515151515, 59.3913898358, 66.6666666667, 58.6381094974, 68.1818181818, 57.8545024449, 69.696969697, 57.3361678759, 71.2121212121, 57.2268280299, 72.7272727273, 57.1936182696, 74.2424242424, 56.8234169404, 75.7575757576, 55.707899418, 77.2727272727, 53.7385110698, 78.7878787879, 53.0068624894, 80.303030303, 53.3208912925, 81.8181818182, 53.3139159634, 83.3333333333, 52.7376433971, 84.8484848485, 52.1477798496, 86.3636363636, 51.7532337348, 87.8787878788, 51.4272030022, 89.3939393939, 51.030366231, 90.9090909091, 50.5172992839, 92.4242424242, 49.9306387743, 93.9393939394, 49.3163242099, 95.4545454545, 48.704902368, 96.9696969697, 48.0942325626, 98.4848484848, 47.4778446315, 100.0, 46.8497543375, 101.515151515, 46.2339132779, 103.03030303, 45.701133548, 104.545454545, 45.3235384497, 106.060606061, 45.0786112517, 107.575757576, 44.8290032023, 109.090909091, 44.4304560823, 110.606060606, 43.7467485996, 112.121212121, 42.8015070027, 113.636363636, 41.7654448962, 115.151515152, 40.7932725914, 116.666666667, 39.9206299134, 118.181818182, 39.1421354666, 119.696969697, 38.4521605942, 121.212121212, 37.8447711902, 122.727272727, 37.3174781788, 124.242424242, 36.8709911148, 125.757575758, 36.5060264998, 127.272727273, 36.1879624806, 128.787878788, 35.7963681343, 130.303030303, 35.19807327, 131.818181818, 34.2621483732, 133.333333333, 33.0222310342, 134.848484848, 31.8089429572, 136.363636364, 30.9182637003, 137.878787879, 30.3542627147, 139.393939394, 30.0329475351, 140.909090909, 29.845470721, 142.424242424, 29.6776706223, 143.939393939, 29.4422313475, 145.454545455, 29.1541888961, 146.96969697, 28.8529678546, 148.484848485, 28.5742123516, 150.0, 28.3239533669
	[/saver]
[/savers]
