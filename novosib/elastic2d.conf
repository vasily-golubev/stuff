verbose = true

dt = 0.00001

#steps = 1
steps = 60000

[grids]
	[grid]
		id = layer_1
		[node]
			name = ElasticMetaNode2D
		[/node]
		[material_node]
		[/material_node]
		[material]
			c1 = 250
			c2 = 125
			rho = 100
		[/material]
		[factory]
			name = RedGridFactory
			file = layer_1.red
		[/factory]
		[schema]
			name = ElasticCurveSchema2DTVD2MC
		[/schema]
		[fillers]
			[filler]
				name = RectNoReflectFiller
				axis = 0
				side = 0
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 0
				side = 1
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 1
				side = 0
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 1
				side = 1
			[/filler]
	        [/fillers]
	        [correctors]
			[corrector]
				name = ForceRectElasticBoundary2D
				axis = 1
				side = 1
                                [function]
                                        name = RIFunction
                                        time_from = 0
                                        time_to = 0.01
                                        magnitude = 0, -10000
                                        [region]
                                                name = CircleRegion
                                                center = 54.5454545455, 61.1651209752
                                                r = 2
                                        [/region]
                                        [impulse]
                                                name = ReikerImpulse
                                        [/impulse]
                                [/function]
			[/corrector]
	        [/correctors]
	[/grid]
	[grid]
		id = layer_2
		[node]
			name = ElasticMetaNode2D
		[/node]
		[material_node]
		[/material_node]
		[material]
			c1 = 700
			c2 = 350
			rho = 280
		[/material]
		[factory]
			name = RedGridFactory
			file = layer_2.red
		[/factory]
		[schema]
			name = ElasticCurveSchema2DTVD2MC
		[/schema]
		[fillers]
			[filler]
				name = RectNoReflectFiller
				axis = 0
				side = 0
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 0
				side = 1
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 1
				side = 0
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 1
				side = 1
			[/filler]
	        [/fillers]
	        [correctors]
	        [/correctors]
	[/grid]
	[grid]
		id = layer_3
		[node]
			name = ElasticMetaNode2D
		[/node]
		[material_node]
		[/material_node]
		[material]
			c1 = 1500
			c2 = 750
			rho = 600
		[/material]
		[factory]
			name = RedGridFactory
			file = layer_3.red
		[/factory]
		[schema]
			name = ElasticCurveSchema2DTVD2MC
		[/schema]
		[fillers]
			[filler]
				name = RectNoReflectFiller
				axis = 0
				side = 0
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 0
				side = 1
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 1
				side = 0
			[/filler]
			[filler]
				name = RectNoReflectFiller
				axis = 1
				side = 1
			[/filler]
	        [/fillers]
	        [correctors]
	        [/correctors]
	[/grid]
[/grids]

[contacts]
	[contact]
		name = GlueRectElasticContact2D
		grid1 = layer_1
		grid2 = layer_2
		tol = 0.005
	[/contact]
	[contact]
		name = GlueRectElasticContact2D
		grid1 = layer_2
		grid2 = layer_3
		tol = 0.005
	[/contact]
[/contacts]

[initials]
#    [initial]
#        order = 0
#        name = ElasticBallInitial2D
#	velocity_magnitude = 1
#	center = 40, 50
#	r1 = 1
#	r2 = 5
#        [impulse]
#            name = ConstImpulse
#        [/impulse]
#    [/initial]
[/initials]

[savers]
	[saver]
		name = StructuredVTKSaver
		path = ./VTK/%g_%s.vtk
		order = 0
		save = 100
		params = v
		norms = 1
	[/saver]
	[saver]
		name = SeismogramSaver
		path = ./receivers.csv
		order = 1
		save = 1
		eps = 0.001
		# Day surface.
		points = 0.0, 70.0, 1.51515151515, 70.2242921941, 3.0303030303, 70.3240273095, 4.54545454545, 70.3183380281, 6.06060606061, 70.226357032, 7.57575757576, 70.0672170031, 9.09090909091, 69.8596787585, 10.6060606061, 69.6179752566, 12.1212121212, 69.3533179098, 13.6363636364, 69.0768630653, 15.1515151515, 68.7996193059, 16.6666666667, 68.5254111351, 18.1818181818, 68.24780011, 19.696969697, 67.9595595884, 21.2121212121, 67.6546107948, 22.7272727273, 67.335358407, 24.2424242424, 67.0080094119, 25.7575757576, 66.6787887316, 27.2727272727, 66.3539212884, 28.7878787879, 66.0396320046, 30.303030303, 65.7421296233, 31.8181818182, 65.4641929339, 33.3333333333, 65.2009480459, 34.8484848485, 64.9464856108, 36.3636363636, 64.6948962804, 37.8787878788, 64.4402707062, 39.3939393939, 64.17669954, 40.9090909091, 63.8982734338, 42.4242424242, 63.6011085753, 43.9393939394, 63.2892787664, 45.4545454545, 62.9688117233, 46.9696969697, 62.6457351622, 48.4848484848, 62.3260767989, 50.0, 62.0158643497, 51.5151515152, 61.7210607015, 53.0303030303, 61.4413713723, 54.5454545455, 61.1651209752, 56.0606060606, 60.8794281759, 57.5757575758, 60.57141164, 59.0909090909, 60.2281900332, 60.6060606061, 59.8372624545, 62.1212121212, 59.4009173476, 63.6363636364, 58.9406550378, 65.1515151515, 58.4792598129, 66.6666666667, 58.0392042177, 68.1818181818, 57.6287501654, 69.696969697, 57.2363890943, 71.2121212121, 56.8491505852, 72.7272727273, 56.4540642191, 74.2424242424, 56.0386860249, 75.7575757576, 55.5978017216, 77.2727272727, 55.1314488246, 78.7878787879, 54.6397830066, 80.303030303, 54.1232876176, 81.8181818182, 53.589018331, 83.3333333333, 53.0501082765, 84.8484848485, 52.5199190975, 86.3636363636, 52.0118124378, 87.8787878788, 51.5340870978, 89.3939393939, 51.0732781102, 90.9090909091, 50.6100736501, 92.4242424242, 50.1251618174, 93.9393939394, 49.6032025963, 95.4545454545, 49.0473186614, 96.9696969697, 48.4659931963, 98.4848484848, 47.8677099639, 100.0, 47.260952727, 101.515151515, 46.6539886694, 103.03030303, 46.0469564252, 104.545454545, 45.4296006681, 106.060606061, 44.7909878089, 107.575757576, 44.1201913388, 109.090909091, 43.4125613485, 110.606060606, 42.6812475261, 112.121212121, 41.9425331621, 113.636363636, 41.212701547, 115.151515152, 40.507340154, 116.666666667, 39.8298804557, 118.181818182, 39.1734151195, 119.696969697, 38.5307074242, 121.212121212, 37.8945206486, 122.727272727, 37.2576180715, 124.242424242, 36.6133884609, 125.757575758, 35.9605926109, 127.272727273, 35.300727094, 128.787878788, 34.635310205, 130.303030303, 33.9658645387, 131.818181818, 33.294824299, 133.333333333, 32.6266576091, 134.848484848, 31.9661077954, 136.363636364, 31.318354352, 137.878787879, 30.7022671595, 139.393939394, 30.1528127687, 140.909090909, 29.704813447, 142.424242424, 29.3644642498, 143.939393939, 29.1068399217, 145.454545455, 28.9054498301, 146.96969697, 28.7312330854, 148.484848485, 28.543879033, 150.0, 28.3
	[/saver]
[/savers]
