\begin{center}
\Large { \textbf {Построение миграционных изображений в упругих средах}}
\end{center}
\rule[5pt]{\textwidth}{0.5pt} \vspace {-8mm}

\section*{Введение}
\addcontentsline{toc}{section}{Введение}


Ввиду того, что нефть и природный газ являются ключевыми топливными ресурсами, поиск и разведка их месторождений является приоритетной задачей.
Для её решения применяются полевые исследования, проводимые с использованием взрывных и вибрационных источников.
Основной задачей сейсмической разведки является создание достоверной модели подповерхностного пространства геологической среды.
Сейсмическая разведка была применена впервые более ста лет назад и значительно развита и усовершенствована к настощему времени.
Можно выделить два основных направления: сейсмическая миграция и сейсмическая инверсия.
Результатом процесса инверсии является пространственное распределение параметров среды, тогда как миграция позволяет лишь установить положения отражающих горизонтов (и, возможно, точечных отражателей – трещин, включений).
Таким образом, геометрия месторождения углеводородов может быть успешно определена.

Работы [1, 2] можно отнести к одним из первых, посвящённых миграции и построению сейсмических изображений и положивших начало бурному развитию данной области.
В дальнейшем в работах [3,4] был предложен подход, названный Kirchhoff Summation Approach, в работе [5] – представлена
$k-f$ миграция.
В работе [6] проблема построения миграционного изображения сопоставлена с пространственной деконволюцией в области
пространственных частот.
В последнее время предпринимаются значительные усилия для повышения точности миграционных изображений для сложных геологических сред (например, в условиях соляных куполов [7]).
И определённые надежды возлагаются на использование полноволновых подходов к упругой миграции.

Данная работа посвящена проблеме построения миграционных изображений геологических сред.
Представлены определяющие уравнения для случая акустического приближения.
Приведена формула Кирхгофа, и приближение Борна, позволяющие решить прямую задачу
в достаточно простой модели среды.
На основе них получены способы построения миграционных изображений: формула Рэлея и присоединённый оператор в приближении Борна.
Сформулирован ряд исследовательских задач, позволяющих студентам глубже понять изложенный материал.
Также проведено обобщение подхода с приближением Борна на случай упругой среды.
Приведены алгоритмы, позволяющие решить прямую задачу и задачу миграции в упругой среде с произвольной структурой.

Работа выполнена при поддержке стипендии Президента РФ молодым учёным и аспирантам СП-1591.2016.5.

\section{Акустическое приближение}

\subsection{Определяющие уравнения}

Пусть геологическая среда описывается в акустическом приближении, в котором существуют только продольные волны.
Тогда она характеризуется одним параметров, зависящим от радиус-вектора и называемым скоростью распространения акустической волны $c$.
Если ввести в рассмотрение величину, равную давлению в среде $P(\vec{r}, t)$, то она удовлетворяет уравнению[8]:

\begin{equation}
\label{eq_wave_equation}
\nabla^2P(\vec{r},t) - \frac{1}{c^2(\vec{r})}\frac{\partial^2}{\partial t^2}
	P(\vec{r},t) = - F^e(\vec{r},t).
\end{equation}

Решение этого уравнения в случае, когда $F^e(\vec{r},t)$ - точечный источник (дельта-функция по времени и по пространству), называется функцией Грина, и для однородного бесконечного пространства она может быть записана в виде:
\begin{equation}
\label{eq_grin_function}
G^w(\vec{r}, t | \vec{r'}, t') = \frac{1}{4\pi|\vec{r} - \vec{r'}|}\delta(t - t' - \frac{|\vec{r} -
\vec{r'}|}{c}),
\end{equation}
где $\vec{r'}, t'$ - место расположения источника и время, в которое он начал действовать.

\subsection{Формула Кирхгофа}

В общем случае как для ограниченной, так и для неограниченной области можно записать интегральную связь между полем давления на её границе $S$ ($\vec{n}$ - внешняя нормаль) и полем в произвольной точке внутри неё.
Эта связь называется формулой Кирхгофа и представляется в виде:

\begin{equation}
\label{eq_kirchhoff_formula}
P(\vec{r'}, t') = \int_S \int_{-\infty}^{+\infty} [G^w(\vec{r'}, t' | \vec{r}, t) \frac{\partial}
{\partial n} P(\vec{r}, t) - P(\vec{r}, t) \frac{\partial}{\partial n} G^w(\vec{r'}, t' |
\vec{r}, t)] dt ds.
\end{equation}

Здесь штриховые координаты соотвествуют точке, лежащей внутри рассматриваемой области.
Подставляя в (\ref{eq_kirchhoff_formula}) выражение для формулы Грина в явном виде (\ref{eq_grin_function}) получим
\begin{equation}
\label{eq_kirchhoff_homogeneous}
P(\vec{r'}, t') = \frac{1}{4\pi} \int_S [\frac{1}{c|\vec{r'} - \vec{r}|}
\frac{\partial |\vec{r'} - \vec{r}|}{\partial n}\frac{\partial P'}{\partial t'}
- \frac{\partial}{\partial n}(\frac{1}{|\vec{r'} - \vec{r}|}) P' + 
\frac{1}{|\vec{r'} - \vec{r}|}\frac{\partial}{\partial n}P'] ds,
\end{equation}
где $P' = P(\vec{r}, t' - \frac{|\vec{r'} - \vec{r}|}{c})$.

Рассмотрим случай однородного полупространства, ограниченного сверху плоскостью $z=0$ (стандартные площадные полевые сейсморазведочные работы).
В этом случае $\frac{\partial}{\partial n} = -\frac{\partial}{\partial z}$, следовательно выражение
(\ref{eq_kirchhoff_homogeneous}) может быть упрощено до вида:
\begin{equation}
\label{eq_kirchhoff_final}
P(\vec{r'}, t') = \frac{1}{4\pi} \int_S [\frac{z' - z}{|\vec{r'} - \vec{r}|}(\frac{1}{c}
\frac{\partial P'}{\partial t'} + \frac{1}{|\vec{r'} - \vec{r}|^2} P') - \frac{1}{|\vec{r'}
- \vec{r}|}\frac{\partial P'}{\partial z}] ds
\end{equation}

Разберемся теперь со временной функцией источника.
Пусть на поверхность полупространства воздействует давление в виде импульса Риккера:
\begin{equation}
\label{eq_ricker_wavelet}
P_{ricker} = P_0(1-2 \pi^2f^2t^2)e^{-\pi^2f^2t^2},
\end{equation}
тогда функция $P'(\vec{r'}, t')$ может быть записана в виде:
\begin{equation}
\label{eq_surface_pressure}
P'(\vec{r'}, t') = P(\vec{r}, t' - \frac{|\vec{r'} - \vec{r}|}{c}) = P_0(1-2 \pi^2f^2(t' - \frac{|\vec{r'} - \vec{r}|}{c})^2)e^{-\pi^2f^2(t'-\frac{|\vec{r'} - \vec{r}|}{c})^2}.
\end{equation}

С учётом (\ref{eq_ricker_wavelet}) аналитически могут быть получены значения
\begin{equation}
\label{eq_dp'_dt'}
\frac{\partial P'}{\partial t'} = -2\pi^2f^2P_0(3-2 \pi^2f^2(t' - \frac{|\vec{r'} - \vec{r}|}{c})^2)e^{-\pi^2f^2(t' - \frac{|\vec{r'} - \vec{r}|}{c})^2},
\end{equation}
и
\begin{equation}
\label{eq_dp'_dz}
\frac{\partial P'}{\partial z} = -2\pi^2f^2P_0(t' - \frac{|\vec{r'} - \vec{r}|}{c})[3-2 \pi^2f^2(t' - \frac{|\vec{r'} - \vec{r}|}{c})^2]e^{-\pi^2f^2(t' - \frac{|\vec{r'} - \vec{r}|}{c})^2}
\frac{z'-z}{c|\vec{r'}-\vec{r}|},
\end{equation}
Таким образом, может быть рассчитано поле в произвольной точке внутри области, ограниченной поверхностью $S$.

\textbf{$\blacktriangle$ Исследовательские задания}

\begin {enumerate}
\item{Повторите выкладки для различных временных зависимостей сигнала-источника: Берлаге, Пузырева, Гельфанда, затухающей синусоиды, колокольной огибающей.}
\item{Напишите программу, реализующую расчёт акустического поля в среде в соотвествии с формулой Кирхгофа.
Рассчитайте поля от точечного источника, плоской продольной волны.}
\item{Модифицируя разработанную программу, исследуйте вопрос точности численного вычисления поверхностного интеграла с применением различных формул Ньютона-Котеса.}
\end {enumerate}

\subsection{Миграция Кирхгофа}

Для случая, когда область интереса представляет собой бесконечное полупространство, ограниченное плоскостью $z=0$, возможно получить аналитическое выражение, определяющее пространственное распределение скаляра $U^m(\vec{r'})$, описывающего структуру подповерхностного пространства.
Данное соотношение называется формулой Рэлея:
\begin{equation}
\label{rayleigh_migration}
U^m(\vec{r'}) = -\frac{1}{2\pi}\frac{\partial}{\partial z'}
	\int_S \frac{P(\vec{r},\frac{2|\vec{r'}-\vec{r}|}{c})}{|\vec{r'}-\vec{r}|}ds,
\end{equation}
где $U^m$ - скалярное поле, $P$ - давление на поверхности, $\vec{r}$ - координата на поверхности, в которой записывается
сейсмограмма, $\vec{r'}$ - координата в объёме, где ищется мигрированное изображение, $c$ - скорость распространения акустической волны.

Рассмотрим простейший случай, когда расчётная сетка кубическая, и на поверхности сейсмоприёмники расположены в каждом её узле.
В таком случае формула (\ref{rayleigh_migration}) может быть записана в виде:
\begin{equation}
\label{rayleigh_migration_discrete}
U^m(i,j,k) = -\frac{1}{2\pi}\frac{\sum\limits_{l,m} \frac{P(l,m,\frac{2d(i,j,k+1,l,m)}{c})}{d(i,j,k+1,l,m)}\delta x \delta y - \sum\limits_{l,m} \frac{P(l,m,\frac{2d(i,j,k,l,m)}{c})}{d(i,j,k,l,m)}\delta x \delta y}{\delta z},
\end{equation}
где $d(i,j,k,l,m)=\sqrt{(l-i)^2(\delta x)^2 + (m-j)^2(\delta y)^2  + (k)^2(\delta z)^2}$, а начало координат находится в точке $(i,j,k)=(0,0,0)$.

\textbf{$\blacktriangle$ Исследовательские задания}

\begin {enumerate}
\item{Получите миграционное изображение по сигналу от точечного источника.
Для генерации синтетической сейсмограммы используйте формулу Кирхгофа.}
\item{
Сравните результаты, полученные при численном расчёте сейсмограммы и при использовании аналитической зависимости для точечного истоника в однородной среде.}
\end {enumerate}

\subsection{Приближение Борна}

Представим распределение $c(\vec{r})$ в области в виде
\begin{equation}
\label{eq_c_spacial}
\frac{1}{c^2(\vec{r})} = \frac{1}{c^2_b(\vec{r})}(1 + a(\vec{r}))
\end{equation}
где $c_b$ - фоновое распределение скорости, а функция $a(\vec{r})$ задаёт распределение внутри локальной аномальной области $D$, где скорость отлична от фоновой.

Рассмотрим процесс распространения акустических волн в частотной области.
Запишем поле давления $p(\vec{r}, \omega)$ в виде суммы двух полей, фонового поля $p^i(\vec{r}, \omega)$ и отражённого $p^s(\vec{r}, \omega)$.
Первое из них получено для случая модели с фоновым распределением скорости $c_b(\vec{r})$, а второе определяется её отличием в области $D$.
В таком случае может быть записано интегральное уравнение для отражённого волнового поля
\begin{equation}
\label{eq_scattered_integral}
p^s(\vec{r}_j, w) = w^2\int_D G^w_b(\vec{r}_j|\vec{r};w)\Delta s^2(\vec{r})[p^i(\vec{r},w) + p^s(\vec{r},w)]  dv,
\end{equation}
в котором $\vec{r}_j$ - радиус-вектор точки приёмника, $D$ - область, в которой параметр медленности ($s = \frac{1}{c}$)
отличается от фоновой медленности ($s_b = \frac{1}{c_b},\Delta s^2 = \frac{1}{c^2} - \frac{1}{c^2_b})$, $p^i$ - давление, которое создавалось бы
в отсутствии неоднородности в области $D$, $G^w_b$ - функция Грина для фоновой медленности.

Приближение Борна получается из приведённого выражения, если в правой части пренебречь величиной отражённого поля относительно фонового.
Тогда выражение представляется в виде:
\begin{equation}
\label{eq_born_approximation_1}
p^s(\vec{r}_j, w) = w^2\int_D G^w_b(\vec{r}_j|\vec{r};w)\Delta s^2(\vec{r})p^i(\vec{r},w)  dv,
\end{equation}


Рассмотрим случай однородной фоновой модели.
Функция Грина в этом случае в частотной области записывается в виде:
\begin{equation}
\label{eq_grin_function_w}
 G^w_b(\vec{r}_j|\vec{r};w) = \frac{1}{4\pi|\vec{r}-\vec{r}_j|}e^{iw\frac{|\vec{r}-\vec{r}_j|}{c_b}}.
\end{equation}

Подставляя (\ref{eq_grin_function_w}) в формулу (\ref{eq_born_approximation_1}) получим:

\begin{equation}
\label{eq_born_approximation_2}
p^s(\vec{r}_j, w) = w^2\int_D \frac{1}{4\pi|\vec{r}-\vec{r}_j|}e^{iw\frac{|\vec{r}-\vec{r}_j|}{c_b}} \Delta s^2(\vec{r})p^i(\vec{r},w)  dv.
\end{equation}

Займёмся теперь вычислением $p^i$.
Пусть источник возмущения - точечный взрыв, происходящий в нулевой момент времени в точке $\vec{r}_0$.
Тогда в случае однородной среды с фоновой медленностью $s_b$ можно записать решение в виде:

\begin{equation}
\label{eq_point_explosion}
p^i(\vec{r}, w) = \frac{1}{4\pi|\vec{r}-\vec{r}_0|}e^{iw\frac{|\vec{r}-\vec{r}_0|}{c_b}}.
\end{equation}

Подставляя (\ref{eq_point_explosion}) в формулу (\ref{eq_born_approximation_2}) получим:

\begin{eqnarray}
\label{eq_born_approximation_3}
p^s(\vec{r}_j, w) = w^2\int_D \frac{1}{4\pi|\vec{r}-\vec{r}_j|}e^{iw\frac{|\vec{r}-\vec{r}_j|}{c_b}} \Delta s^2(\vec{r})\frac{1}{4\pi|\vec{r}-\vec{r}_0|}e^{iw\frac{|\vec{r}-\vec{r}_0|}{c_b}}  dv = \nonumber \\
= \frac{w^2}{16\pi^2} \int_D \frac{e^{iw\frac{|\vec{r}-\vec{r}_0| + |\vec{r}-\vec{r}_j|}{c_b}}}{|\vec{r}-\vec{r}_j||\vec{r}-\vec{r}_0|} \Delta s^2(\vec{r}) dv.
\end{eqnarray}

Это и является конечной аналитической формулой для вычисления отражённого поля.

В случае произвольной формы области $D$ и распределения в ней медленности $\Delta s^2(\vec{r})$ данный поверхностный интеграл может быть вычислен численно.
Вводя дискретизацию по пространству в виде параллелепипедной сетки с шагами $\delta x, \delta y, \delta z$ и индексами $l, m, p$ формулу (\ref{eq_born_approximation_3}) можно
привести к виду:

\begin{equation}
\label{eq_born_approximation_num}
p^s(\vec{r}_j, w) = \frac{w^2}{16\pi^2} \sum_{(l,m,p)\in D} \frac{e^{iw\frac{|\vec{r}_{l,m,p}-\vec{r}_0| + |\vec{r}_{l,m,p}-\vec{r}_j|}{c_b}}}{|\vec{r}_{l,m,p}-\vec{r}_j||\vec{r}_{l,m,p}-\vec{r}_0|} \Delta s_{l,m,p}^2 \delta x \delta y \delta z.
\end{equation}

Рассмотрим двумерный случай, когда вдоль $Y$ содержится всего одна ячейка.
Тогда можно избавиться от индекса $m$, а также сейсмодатчики устанавливаются вдоль одной линии $OX$ и могут быть параметризованы одним индексом $j$.
Формула (\ref{eq_born_approximation_num}) сводится к виду:

\begin{equation}
\label{eq_born_approximation_num_2D}
p^s(x_j, w) = \frac{w^2 \delta x \delta z}{16\pi^2} \sum_{(l,p)\in D} \frac{e^{iw\frac{D_{l,p}+d_{j,l,p}}{c_b}}}{D_{l,p}d_{j,l,p}} \Delta s_{l,p}^2,
\end{equation}

где $D_{l,p}=|\vec{r}_{l,p}-\vec{r}_0|$ и $d_{j,l,p}=|\vec{r}_{l,p}-\vec{x}_j|$.

Пусть матрица $\Delta s_{l,p}^2$ развернута в $1D$ массив так, что последовательно в нём лежат её строки.
И пусть размер модели по $X$ равен $P$, а по $Z$ - $L$.
Тогда индекс в массиве имеет вид $ind = p + l * P$, $p \in [0, P - 1], l \in [0, L - 1]$.
Также справедливы равенства: $l = [\frac{ind}{P}]$ и $p = ind - [\frac{ind}{P}] * P$.

С учётом введённой параметризации массива и того факта, что вне неоднородности $\Delta s^2 = 0$, можно записать формулу (\ref{eq_born_approximation_num_2D}) в виде:

\begin{equation}
\label{eq_born_approximation_num_2D_ind}
p^s(x_j, w) = \sum_{(ind)\in [0, L * P - 1]} L_{j,ind} \Delta s_{ind}^2,
\end{equation}

где матрица $L_{j,ind} = \frac{w^2 \delta x \delta z}{16\pi^2} \frac{e^{iw\frac{D_{ind}+d_{j,ind}}{c_b}}}{D_{ind}d_{j,ind}}$,
$D_{ind}=\sqrt{(x_{ind} - x_0)^2 + (y_{ind} - y_0)^2}$ и $d_{j,ind}=\sqrt{(x_{ind} - x_j)^2 + y_{ind}^2}$.

Таким образом, получена линеаризованная связь между данными на приёмниках и параметрами модели.

\textbf{$\blacktriangle$ Исследовательские задания}

\begin {enumerate}
\item{Реализуйте компьютерную программу по расчёту синтетических сейсмограмм на основе приближения Борна. Получите отклик от двухслойной среды с горизонтальной границей и сравните результаты с аналитическим расчётами.}
\item{
Проведите обобщение на трёхмерный случай и получите вид матрицы связи наблюдений и параметров модели.}
\item{
Для случая симметричной системы наблюдений и сферической области $D$ с постоянным значением медленности вычислите аналитически интеграл в (\ref{eq_born_approximation_3}).}
\end {enumerate}

\subsection{Миграция Борна}

Прямая задача сейсморазведки может быть представлена в виде
\begin{equation} \label{dLm}
\vec d = \op L \vec m .
\end{equation}

Здесь $\vec d$ -- наблюдаемые на сейсмоприемниках данные, $\vec m$ -- параметры среды, $\op L$ -- оператор прямой задачи. Миграционное изображение среды задается выражением
\begin{equation}
\vec m_{migr} = \op L^* \vec d .
\end{equation}

Присоединенный оператор $\op L^*$ определяется как
\begin{equation}
\left(\vec d, \op L \vec m \right) = \left( \op L^* \vec d, \vec m \right),\quad \forall \vec m,\vec d ,
\end{equation}

где круглыми скобками обозначено скалярное произведение.

Для акустической среды в случае однородной фоновой модели в приближении Борна выражение для отражённого поля (\ref{eq_born_approximation_2}) с использованием обратного преобразования Фурье может быть записано во временной области в виде

\begin{equation} \begin{gathered} \label{Born}
\fun_p^s(\vR,t)      \simeq -        \int_{\vr\in D} \frac{\dsr}                   {4\pi \armR} \pdsqr_{\fun_p^i(\vr,t - s_b\armR)}_t dV.
\end{gathered} \end{equation}

Пусть источник возмущения -- точечный импульс Рикера, возникающий в нулевой момент времени в точке $\vec r_0$: 
\begin{equation} \label{10}
\fun_p^i(\vr,t) = \inv{4 \pi \armrz } \fun_RW( t - s_b \armrz ) ,
\end{equation}
где
\begin{equation} \label{eq:ricker}
RW(t) = \left( 1 - 2 \pi^2 f_M^2 t^2 \right) e^{- \pi^2 f_M^2 t^2}.
\end{equation}
Тогда 
\begin{equation}
\fun_p^s(\vR,t) = \int_{\vr\in D} \frac{ f_M^2 }{ 2 \armR \armrz } e^{ -\tau^2 } \left( \tau^4 - 3 \tau^2 + \frac{3}{4} \right) \dsr dV ,
\end{equation}
где $\tau = \pi f_M \left( t - s_b \armR - s_b \armrz \right)$.

Будем рассматривать далее случай "нулевого удаления" (zero-offset) источника возмущения от приемника $\left( \vec r_0 = \vec R \right)$
\begin{equation} \label{eq:13}
\fun_p^s(\vR,t) = \int_{\vr\in D} \frac{ f_M^2 }{ 2 \left( \rmR \right)^2 } e^{ -\tau^2 } \left( \tau^4 - 3 \tau^2 + \frac{3}{4} \right) \dsr dV ,
\end{equation}
и $\tau = \pi f_M \left( t - 2 s_b \armR \right)$. В соответствии с полученным выражением оператор прямого моделирования $\op L$ имеет вид
\begin{equation} \label{th_1}
\fun_d(\vR,t) = \fun_L(\vR,t|\vr) \fun_m(\vr) = \int_{\vr\in D} \frac{ f_M^2 }{ 2 \left( \rmR \right)^2 } e^{ -\tau^2 } \left( \tau^4 - 3 \tau^2 + \frac{3}{4} \right) \fun_m(\vr) dV ,
\end{equation}
а сопряженный к нему оператор $\op L^*$ --
\begin{equation} \label{th_2}
\fun_m(\vR) = \fun_L^*(\vR|\vr,t) \fun_d(\vr, t) = \int_{t_{min}}^{t_{max}} \int_{\vr\in S} \frac{ f_M^2 }{ 2 \left( \rmR \right)^2 } e^{ -\tau^2 } \left( \tau^4 - 3 \tau^2 + \frac{3}{4} \right) \fun_d(\vr,t) dS dt ,
\end{equation}
где $S$ -- принадлежит границе области $G$, а $\left(t_{min},t_{max}\right)$ -- некоторый временной диапазон.

\textbf{$\blacktriangle$ Исследовательские задания}

\begin {enumerate}
\item{Как изменятся выражения (\ref{th_1}) и (\ref{th_2}), если временную функцию источника заменить на импульс Берлаге.}
\item{Получите выражение для оператора $\op L$ и для сопряжённого оператора $\op L^*$ в частотной области.}
\item{Напишите программу, вычисляющую миграционное изображение среды в 2D постановке. Верифицируйте результат на простейших моделях неоднородных сред.}
\end {enumerate}

\clearpage
