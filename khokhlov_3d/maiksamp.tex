\documentclass[
aps,%
12pt,%
final,%
notitlepage,%
oneside,%
onecolumn,%
nobibnotes,%
nofootinbib,% 
superscriptaddress,%
noshowpacs,%
centertags]%
{revtex4}
\usepackage{epstopdf}
\bibliographystyle{maik}
\begin{document}
\selectlanguage{russian}

\title{КОМПАКТНЫЕ СЕТОЧНО-ХАРАКТЕРИСТИЧЕСКИЕ СХЕМЫ ПОВЫШЕННОГО ПОРЯДКА ТОЧНОСТИ ДЛЯ ТРЁХМЕРНОГО ЛИНЕЙНОГО УРАВНЕНИЯ ПЕРЕНОСА}% Разбиение на строки осуществляется командой \\

\author{\firstname{В.~И.}~\surname{Голубев}}
% Здесь разбиение на строки осуществляется автоматически или командой \\
\email{w.golubev@mail.ru}
\affiliation{%
Московский физико-технический институт
}%
\author{\firstname{И.~Б.}~\surname{Петров}}
%
\email{petrov@mipt.ru}
\affiliation{%
Московский физико-технический институт
}%
\author{\firstname{Н.~И.}~\surname{Хохлов}}
\email{k_h@inbox.ru}
\affiliation{%
Московский физико-технический институт
}%


\begin{abstract}
В работе рассматривается численное решение трёхмерного линейного уравнения переноса на параллелепипедных расчётных сетках.
С использованием подхода расщепления по координатам проведено обобщение компактных сеточно-характеристических схем повышенного порядка точности на трёхмерный случай.
Исследуется влияние отдельных шагов вычислительного алгоритма на точность итоговой схемы.
Предложен подход, позволяющий сохранить порядок сходимости схемы на гладком решении и минимизировать нефизические осцилляции на разрывном решении в трёхмерном случае.
\end{abstract}

\maketitle

\section{Введение}

\textbf{НАПИСАТЬ НОВОЕ ВВЕДЕНИЕ}

Гиперболические системы уравнений являются основой математических моделей, используемых для описания
широкого класса физических явлений (задачи газовой динамики, динамическая нагрузка упруго-пластических сред,
движение взвеси частиц в жидкости) \cite{Kholodov2008}.
Отметим, что введением соответствующей замены переменных их решение может быть сведено к последовательному
решению набора линейных уравнений переноса \cite{Magometov-Kholodov-1969, Yanenko1978}.
К сожалению, его решение для произвольной геометрии расчётной области и начальных данных не может быть получено
аналитически.
Таким образом, важным направлением является совершенствование существующих и разработка новых
численных методов для решения уравнений рассматриваемого типа.

Поскольку при моделировании динамических процессов в сплошных средах важным фактором является точность используемого метода, к настоящему времени разработано несколько подходов
к разработке методов повышения аппроксимации разностных схем: расширение сеточного шаблона \cite{Rusanov1961}, использование комбинаций сеточных функций, полученных на разных сетках,
использование дифференциальных следствий начальных уравнений \cite{Courant1949, Khol2006, Grudn1977, Yanenko1978, Petuhov1964}.
Схемы, построенные с использованием последнего, принято называть компактными \cite{Tolstih1990}.
К их преимуществам можно отнести локальность шаблона, позволяющую легко сформулировать граничные условия, и
повышенный порядок сходимости на гладких решениях.

В работе \cite{Tolstih1990} использовался трёточечный, а в работах \cite{Rogov2011, Khol2006} - двухточечный шаблон
для построения компактных схем.
В работах \cite{Rogov2011, Khol2006} на двухточечном шаблоне были предложены схемы четвёртого порядка точности.
Отметим, однако, принципиальное различие в методике их построения.
В работе \cite{Rogov2011} повышенный порядок схемы достигается за счет введения пространственной первообразной функции в качестве дополнительной искомой функции, а в работе \cite{Khol2006}
 - за счет последовательного решения дифференциального следствия и исходной системы.

В работе \cite{Yabe1991} была предложена бикомпактная \cite{Kalitkin2008} схема третьего порядка, построенная с использованием интерполяционных полиномов
на двухточечном шаблоне.
В дальнейшем она была обобщена на многомерный случай \cite{Yabe2004}.
Отметим, однако, что указанная схема не является монотонной и приводит к нефизическим осцилляциям на разрывном решении.
Для преодоления данного недостатка в работе \cite{Khokhlov_NEW} были предложены две компактные схемы (БИС-1 и БИС-2) для одномерного
линейного уравнения переноса, построенные на основе сеточно-характеристического метода \cite{Magometov-Kholodov-1969, Kholodov1990}.
На гладких решениях они демонстрируют, соответственно, второй и третий порядок сходимости, как по пространству, так и по времени.
При этом с использованием гибридизации решения \cite{petrov1984} на основе сеточно-характеристического критерия \cite{van1979} и на основе критерия,
основанного на поиске экстремума интерполяционного полинома на выбранном интервале, предложенного в работе \cite{Khokhlov_NEW},
удалось добиться отсутствия нефизических осцилляций и слабого размытия решения со временем.

В данной работе проводится обобщение бикомпактных сеточно-характеристических схем для линейного одномерного уравнения переноса на двумерный случай.
Используется подход расщепления по координатам, позволяющий свести задачу к последовательному решению одномерных задач.
В дальнейшем проводится дополнение начальных уравнений их дифференциальными следствиями, что позволяет использовать схемы БИС-1 и БИС-2 на данном этапе.
Отдельно исследуется вопрос о влиянии способа переноса ортогональной (дополнительной) производной на порядок сходимости итоговой схемы.
Предложен подход, позволяющий сохранить повышенный порядок сходимости на гладких решениях и отсутствие нефизических осцилляций на разрывном решении в двумерном случае.

\section{Трёхмерное линейное уравнение переноса}

Рассмотрим простейшее трёхмерное линейное уравнение переноса:
\begin{equation}
\label{eq_advection_2d}
u_t + \lambda_x u_x + \lambda_y u_y + \lambda_z u_z = 0
\end{equation}

и четырёхточечный по пространству шаблон (рис. \ref{img_stencil}) с пространственным шагом $h$ и временным шагом $\tau$:\begin{equation}
\label{eq_stencil_4}
(t^n, x_{i - 1}, y_j, z_k), (t^n, x_i, y_{j - 1}, z_k), (t^n, x_i, y_j, z_{k - 1}), (t^n, x_i, y_j, z_k), (t^{n + 1}, x_i, y_j, z_k).
\end{equation}

Будем полагать, что $\lambda_x = const > 0$, $\lambda_y = const > 0$ и $\lambda_z = const > 0$, поскольку для отрицательных $\lambda_x, \lambda_y, \lambda_z$ все построения аналогичны и могут быть осуществлены заменой $\lambda_x, \lambda_y, \lambda_z$ на $-\lambda_x, -\lambda_y, -\lambda_z$, соответственно, и сеточного шаблона на симметричный по $x, y, z$ относительно точки $(t^n, x_i, y_j, z_k)$.

На этапе построения разностных схем для решения уравнения (\ref{eq_advection_2d}) используем метод расщепления по координатам ($X$, $Y$ и $Z$).
При этом примем связь между оператором перехода с текущего на следующий временной слой ($\hat{F_{3d}}$)
 и для отдельных шагов расщепления ($\hat{F_X}$, $\hat{F_Y}$, $\hat{F_Z}$) в виде:
\begin{equation}
\label{eq_operators}
\hat{F_{3d}} u^n_{i,j,k} = \hat{F_Z} \hat{F_Y} \hat{F_X} u^n_{i,j,k}.
\end{equation}

Рассмотрим подробнее, например, шаг расщепления по $X$:
\begin{equation}
\label{eq_advection_x}
u_t + \lambda_x u_x = 0.
\end{equation}

Для удобства записи будем обозначать значения величин, полученные после данного шага, индексом $n + \frac{1}{3}$ по времени, а после шага расшепления по $Y$ - индексом $n + \frac{2}{3}$.
Дополним уравнение (\ref{eq_advection_x}) его следствием, получаемым дифференцированием по $x$ и введением дополнительной неизвестной функции $\nu(t, x, y, z) = \frac{\partial u(t, x, y, z)}{\partial x}$:
\begin{equation}
\label{eq_advection_x_ext}
\nu_t + \lambda_x \nu_x = 0.
\end{equation}

Отметим,что система (\ref{eq_advection_x}, \ref{eq_advection_x_ext}) является продолженной и может быть решена на рассматриваемом шаблоне с использованием одной из компактных схем (CIP, БИС1 или БИС2) \cite{Khokhlov_NEW} или схемой CIR \cite{Courant1952}.
Таким образом, могут быть вычислены значения $u^{n + \frac{1}{3}}_{i, j, k}$ и $\nu^{n + \frac{1}{3}}_{i, j, k}$.

Однако, на следующем шаге расщепления по $Y$ нам необходимо знать дополнительно значение $w^{n + \frac{1}{3}}_{i, j, k}$, где введено обозначение $w(t, x, y, z) = \frac{\partial u(t, x, y, z)}{\partial y}$.
На шаге расщепления по $Z$ необходимо знать также значение $q^{n + \frac{2}{3}}_{i, j, k}$, где введено обозначение $q(t, x, y, z) = \frac{\partial u(t, x, y, z)}{\partial z}$.
Для краткости в дальнейшем будем называть первую производную по координате, не совпадающей с шагом расщепления, ортогональной (или дополнительной).
Так, например, на шаге расщепления по $X$ ортогональными являются $w$ и $q$.
Авторами было предложено два различных способа вычисления их значений, существенно влияющих на порядок сходимости итоговой схемы.

\section{Перенос ортогональных (дополнительных) производных схемой CIR}

Дополним уравнение (\ref{eq_advection_x}) его следствиями, получаемыми дифференцированием по $y$ и $z$:
\begin{eqnarray}
\label{eq_advection_x_ort_y}
w_t + \lambda_x w_x = 0, \\
\label{eq_advection_x_ort_z}
q_t + \lambda_x q_x = 0.
\end{eqnarray}

Будем вычислять значение $w^{n + \frac{1}{3}}_{i, j, k}$ на шаге расщепления по $X$ решением уравнения (\ref{eq_advection_x_ort_y}), а $q^{n + \frac{1}{3}}_{i, j, k}$ - уравнения (\ref{eq_advection_x_ort_z}) по схеме первого порядка сходимости по пространству CIR:
\begin{eqnarray}
\label{eq_advection_x_ort_y_g}
w^{n + \frac{1}{3}}_{i, j, k} = w^{n}_{i, j, k} - \frac{\lambda_x\tau}{h}(w^{n}_{i, j, k} - w^{n}_{i - 1, j, k}), \\
\label{eq_advection_x_ort_z_g}
q^{n + \frac{1}{3}}_{i, j, k} = q^{n}_{i, j, k} - \frac{\lambda_x\tau}{h}(q^{n}_{i, j, k} - q^{n}_{i - 1, j, k}).
\end{eqnarray}

Полученные компактные трёхмерные сеточно-характеристические схемы назовём CIP-3D-1, БИС1-3D-1, БИС2-3D-1, соответственно, в зависимости от используемой компактной схемы для решения продолженной системы уравнений (\ref{eq_advection_x}, \ref{eq_advection_x_ext}) и аналогичной ей на шагах расщепления по $Y$ и $Z$.

\section{Перенос ортогональных (дополнительных) производных компактной схемой}

Введём в рассмотрение новую искомую функцию $p(t, x, y, z) = \frac{\partial^2 u(t, x, y, z)}{\partial x \partial y}$ и рассмотрим следствие уравнения (\ref{eq_advection_x_ort_y}), получаемое дифференцированием его по $x$:
\begin{equation}
\label{eq_advection_y_ext}
p_t + \lambda_x p_x = 0.
\end{equation}

При таком подходе система уравнений (\ref{eq_advection_x_ort_y}, \ref{eq_advection_y_ext}) также является продолженной.
Расширим пространство искомых функций введением $r(t, x, y, z) = \frac{\partial^2 u(t, x, y, z)}{\partial  x \partial z}$ и рассмотрим следствие уравнения (\ref{eq_advection_x_ort_z}), получаемое дифференцированием его по $x$:
\begin{equation}
\label{eq_advection_z_ext}
r_t + \lambda_x r_x = 0.
\end{equation}

При таком подходе система уравнений (\ref{eq_advection_x_ort_z}, \ref{eq_advection_z_ext}) также является продолженной.
Вводя новые искомые функции $s(t, x, y, z) = \frac{\partial^2 u(t, x, y, z)}{\partial y \partial z}$ и $g(t, x, y, z) = \frac{\partial^3 u(t, x, y, z)}{\partial x \partial y \partial z}$ и дифференцируя уравнение (\ref{eq_advection_x_ort_y}) сначала по $z$, а потом по $x$, получим ещё одну продолженную систему уравнений:
\begin{eqnarray}
\label{eq_advection_x_add_yz}
s_t + \lambda_x s_x = 0, \\
\label{eq_advection_x_add_xyz}
g_t + \lambda_x g_x = 0.
\end{eqnarray}

Каждая из трёх записанных систем на шаге расщепления по $X$ может быть решена с использованием одной из компактных схем (CIP, БИС1 или БИС2).
Таким образом, могут быть вычислены значения всех величин $u, u_x, u_y, u_z, u_{xy}, u_{xz}, u_{xyz}$ на слое $n + \frac{1}{3}$.
На шаге расщепления по $Y$ и по $Z$ выражения для вычисления значений на слое $n + \frac{2}{3}$ и $n + 1$ строятся полностью аналогично вышеизложенному.
Полученные компактные трёхмерные сеточно-характеристические схемы назовём CIP-3D-2, БИС1-3D-2, БИС2-3D-2, соответственно, в зависимости от используемой компактной схемы для решения продолженных систем уравнений.
Отметим, что в настоящей работе не исследовались трёхмерные схемы, которые могут быть получены при решении систем (\ref{eq_advection_x}, \ref{eq_advection_x_ext}),  (\ref{eq_advection_x_ort_y}, \ref{eq_advection_y_ext}), (\ref{eq_advection_x_ort_z}, \ref{eq_advection_z_ext}) и (\ref{eq_advection_x_add_yz}, \ref{eq_advection_x_add_xyz}) отличными друг от друга компактными схемами.

\section{Порядок сходимости и поведение на разрывном решении}

Тест на качественное поведение построенных трёхмерных разностных схем проводился с импульсом прямоугольной формы:
\begin{equation}
\label{eq_impulse}
u(0, x, y, z) = 
\begin{cases}
1, & -0.5 \le x, y, z \le 0.5, \\
0, & \mbox{в противном случае}.
\end{cases}
\end{equation}

Использовалась сетка, состоящая из 20 узлов по каждой из координат и покрывающая область $[-1,1]\times[-1,1]\times[-1,1]$, с периодическими граничными условиями.
Решение представлено после 100 шагов разностной схемы, шаг по времени выбирался исходя из числа Куранта $0.6$.
Использовались значения параметров $\lambda_x = 1, \lambda_y = 2, \lambda_z = 3$.
Результаты для всех схем (сечение области расчёта вдоль главной диагонали) представлены на рис. \ref{img_impulse_1} и \ref{img_impulse_2}.
Как видно из графиков, при построении численной схемы на основе подхода к решению продолженной системы уравнений, удаётся добиться намного меньшего размытия, чем при использовании схемы CIR (см. рис. \ref{img_impulse_1}).
Отметим, что схемы CIP-3D-1 и CIP-3D-2 являются осциллирующими.

В таблицах \ref{tab_convergence_diagonal} и \ref{tab_convergence_nondiagonal} приведены результаты тестирования сеточной сходимости рассмотренных схем.
Использовались следующие нормы: $L_1 = \sum\limits_{i, j, k} |u_{i, j, k}|h^3$, $L_{\infty} = max |u_{i, j,k}|$.
Исследовался, как случай вектора переноса, направленного вдоль диагонали ячейки сетки, так и не вдоль неё.
В качестве начальных условий задавался импульс $u(0, x, y, z) = \sin^4(\pi x)\sin^4(\pi y)\sin^4(\pi z)$ в области $[-1,1]\times[-1,1]\times[-1,1]$, и на границах области использовались периодические граничные условия.
При этом, если перенос ортогональных (дополнительных) производных в численной схеме осуществлялся схемой CIR, то задавались начальные условия на частные производные искомой функции:
\begin{equation}
\label{eq_partial_derivatives}
\begin{cases}
\frac{\partial u}{\partial x} (0, x, y, z) = 4\pi\cos(\pi x)\sin^3(\pi x)\sin^4(\pi y)\sin^4(\pi z), \\
\frac{\partial u}{\partial y} (0, x, y, z) = 4\pi\cos(\pi y)\sin^3(\pi y)\sin^4(\pi x)\sin^4(\pi z), \\
\frac{\partial u}{\partial z} (0, x, y, z) = 4\pi\cos(\pi z)\sin^3(\pi z)\sin^4(\pi x)\sin^4(\pi y).
\end{cases}
\end{equation}

При тестировании сходимости численных схем, использующих подход продолженных систем уравнений для переноса ортогональных (дополнительных) производных, дополнительно задавались начальные условия на следующие производные искомой функции:
\begin{equation}
\label{eq_cross_derivative}
\begin{cases}
\frac{\partial^2 u}{\partial x \partial y} (0, x, y, z) = 16\pi^2\cos(\pi x)\sin^3(\pi x)\cos(\pi y)\sin^3(\pi y)\sin^4(\pi z), \\
\frac{\partial^2 u}{\partial x \partial z} (0, x, y, z) = 16\pi^2\cos(\pi x)\sin^3(\pi x)\cos(\pi z)\sin^3(\pi z)\sin^4(\pi y), \\
\frac{\partial^2 u}{\partial y \partial z} (0, x, y, z) = 16\pi^2\cos(\pi y)\sin^3(\pi y)\cos(\pi z)\sin^3(\pi z)\sin^4(\pi x), \\
\frac{\partial^3 u}{\partial x \partial y \partial z} (0, x, y, z) = 64\pi^3\cos(\pi x)\sin^3(\pi x)\cos(\pi y)\sin^3(\pi y)\cos(\pi z)\sin^3(\pi z).
\end{cases}
\end{equation}

Поскольку вычислительная сложность задачи получилась довольно высокой, и не представлялось возможным провести расчёт на персональном компьютере за приемлемое время, была проведена параллелизация расчётного алгоритма с использованием технологии MPI, и все расчёты проводились на кластере Информационно-вычислительного центра Новосибирского государственного университета \href{http://www.nusc.ru/}{http://www.nusc.ru/}.

Согласно результатам расчётов, схема CIP-3D-1 обладает вторым порядком сходимости по нормам $L_1$ и $L_{\infty}$,
схема БИС1-3D-1 - полуторным порядком по норме $L_{\infty}$ и вторым по норме $L_1$, схема БИС2-3D-1 -
вторым порядком по нормам $L_1$ и $L_{\infty}$ вне зависимости от направления вектора потока.
Также, схема CIP-3D-2 обладает третьим порядком сходимости по нормам $L_1$ и $L_{\infty}$,
схема БИС1-3D-2 - полуторным порядком по норме $L_{\infty}$ и вторым с половиной по норме $L_1$, схема БИС2-3D-2 -
третьим порядком по нормам $L_1$ и $L_{\infty}$ вне зависимости от направления вектора потока.

\section{Заключение}

В работе рассмотрена задача численного решения трёхмерного линейного уравнения переноса на прямоугольных расчётных сетках.
На основе метода расщепления по координатам решение исходной системы уравнений сведено к последовательному решению
трёх одномерных систем уравнений.
Проведено расширение одномерных систем уравнений их дифференциальными следствиями с получение набора продолженных систем уравнений.
Для их решения используются явные компактные сеточно-характеристические численные схемы на двухточечном по пространству шаблону.

Проведено обобщение схем CIP, БИС1 и БИС2 на трёхмерный случай.
Численное исследование порядка сходимости построенных схем на гладком решении показало его сохранение схемами
CIP-3D-2, БИС1-3D-2 и БИС2-3D-2.
При переносе ортогональных (дополнительных) производных схемой первого порядка точности порядок схем снижается до второго.
%
% Список литературы
%
\bibliography{ref}{}
\bibliographystyle{ieeetr}

\begin{figure}[htb]
\setcaptionmargin{5mm}
\onelinecaptionstrue
\includegraphics{./images/fig1-crop.pdf}
\captionstyle{normal}
\caption{Шаблон разностной схемы}
\label{img_stencil}
\end{figure}

\begin{figure}[htb]
\setcaptionmargin{5mm}
\onelinecaptionstrue
\includegraphics{./images/fig2.pdf}
\captionstyle{normal}
\caption{
Вид переносимого импульса (\ref{eq_impulse}) через 100 шагов разностной схемы.
Представлено аналитическое решение и численные решения схемами CIR-3D, CIP-3D-1 и CIP-3D-2.
}
\label{img_impulse_1}
\end{figure}

\begin{figure}[htb]
\setcaptionmargin{5mm}
\onelinecaptionstrue
\includegraphics{./images/fig3.pdf}
\captionstyle{normal}
\caption{
Вид переносимого импульса (\ref{eq_impulse}) через 100 шагов разностной схемы.
а) -- CIP-3D-1; б) -- CIP-3D-2; в) -- БИС1-3D-1; г) -- БИС1-3D-2; д) -- БИС2-3D-1; е) -- БИС2-3D-2.
Сплошной линией на всех графиках представлено аналитическое решение.
}
\label{img_impulse_2}
\end{figure}

\begin{table}
\setcaptionmargin{0mm} \onelinecaptionsfalse
\captionstyle{flushleft} \caption {Сеточная сходимость. Вектор переноса (1, 1, 1) направлен вдоль диагонали ячеек сетки} \label{tab_convergence_diagonal}
\bigskip
\input{table1.tex}
\end{table}

\begin{table}
\setcaptionmargin{0mm} \onelinecaptionsfalse
\captionstyle{flushleft} \caption {Сеточная сходимость. Вектор переноса (1, 2, 3) направлен не вдоль диагонали ячеек сетки} \label{tab_convergence_nondiagonal}
\bigskip
\input{table2.tex}
\end{table}

\end{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%% Character code reference %%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                             %
%     Upper case russian letters (CP866): АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ   %                                                                       %
%     Lower case russian letters (CP866): абвгдеёжзийклмнопрстуфхцчшщъыьэюя   %
%                     Upper case letters: ABCDEFGHIJKLMNOPQRSTUVWXYZ          %
%                     Lower case letters: abcdefghijklmnopqrstuvwxyz          %
%                                   Digits: 0123456789                        %
% Square, curly, angle braces, parentheses: [] {} <> ()                       %
%                Backslash, slash, solidus: \ / |                             %
%       Period, interrogative, exclamation: . ? !                             %
%                 Comma, colon, semi-colon: , : ;                             %
%          Underscore, hyphen, equals sign: _ - =                             %
%             Quotes (left, right, double): ` ' "                             %
%     Commercial-at, hash, dollar, percent: @ # $ %                           %
%  Ampersand, asterisk, plus, caret, tilde: & * +   ^                         %
%                                                                             %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
