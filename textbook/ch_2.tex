\section{Компактные сеточно-характеристические схемы}

\subsection {Построение и анализ}

Альтернативой расширению пространственного шаблона с целью повышения порядка аппроксимации разностной схемы является использование продолженных систем уравнений.
При этом используются дифференциальные следствия исходных уравнений.
Схемы, построенные с применением данного подхода, называются компактными за счёт компактности разностного шаблона.

Введём в рассмотрение дополнительно к уравнению \ref{eq_advection} его дифференциальное следствие:
\begin{equation}
\label{eq_advection_diff}
\nu_t + \lambda \nu_x  = 0,
\end{equation}

где $\nu(x, t) = u_x(x, t)$ - дополнительная искомая функция.
При этом в качестве начального условия может быть записано выражение $\nu(x, 0) = u_x(x, 0)$.

Рассмотрим двухточечный по пространству шаблон рис. \ref{stencil_2_2}.
На нём на текущем временном слое известны, как значения функции $u(x, t)$ - $u^n_m$ и $u^n_{m-1}$, так и функции $\nu(x, t)$ - $\nu^n_m$ и $\nu^n_{m-1}$ в узлах $x^n_m$ и $x^n_{m-1}$.
Таким образом, по их значениям может быть однозначно восстановлен полином третьего порядка с учётом:
\begin{eqnarray}
\label{eq_polynom_3_ext}
u^n(x) = F_3(x)  = a_3x^3 + b_3x^2 + c_3x + d_3, \nonumber\\
\nu^n(x) = F'_3(x) = 3a_3x^2 + 2b_3x + c_3.
\end{eqnarray}

Коэффициенты $a_3$, $b_3$, $c_3$ и $d_3$ равны соответственно:
\begin{eqnarray*}
\label{eq_polynom_3_ext_params}
a_3 = \frac{\nu^n_m + \nu^n_{m-1}}{h^2} - 2\frac{u^n_m -u^n_{m-1}}{h^3}, \\
b_3 = \frac{2\nu^n_m + \nu^n_{m-1}}{h} - 3\frac{u^n_m -u^n_{m-1}}{h^2}, \\
c_3 = \nu^n_m, \\
d_3 = u^n_m.
\end{eqnarray*}

Добавим к рассматриваемому шаблону точку $x^n_{m+1}$. В таком случае количество известных величин увеличивается до шести, и становится возможным восстановление полинома пятого порядка, который в общем виде представим формулой:
\begin{equation}
\label{eq_polynom_5} 
F_5(x) = a_5x^5 + b_5x^4 + c_5x^3 + d_5x^2 + e_5x + f_5.
\end{equation}

Его коэффициенты вычисляются по формулам:
\begin{eqnarray*}
\label{eq_polynom_5_ext_params}
a_5 = -\frac{3u^n_{m+1} - 3u^n_{m-1} - 4h\nu^n_m - h\nu^n_{m+1} - h\nu^n_{m-1}}{4h^5}, \\
b_5 = -\frac{-4u^n_m + 2u^n_{m+1} + 2u^n_{m-1} - h\nu^n_{m+1} + h\nu^n_{m-1}}{4h^4}, \\
c_5 = -\frac{-5u^n_{m+1} + 5u^n_{m-1} + 8h\nu^n_m + h\nu^n_{m+1} + h\nu^n_{m-1}}{4h^3}, \\
d_5 = -\frac{8u^n_m - 4u^n_{m+1} - 4u^n_{m-1} + h\nu^n_{m+1} - h\nu^n_{m-1}}{4h^2}, \\
e_5 = \nu^n_m, \\
f_5 = u^n_m.
\end{eqnarray*}

\subsection {Реализация на языке Си}

\lstset{language=C}

По сравнению с программной реализацией схем на расширенном шаблоне необходимо дополнительно хранить значения производной решения.
Для этого вводятся массивы $dU\_c$ и $dU\_n$.
Кроме того, функция $interpolatedValue$ принимает в аргументах значения производной, и реализована функция $interpolatedDValue(double\;*u, double\;*du)$, восстанавливающая значение производной.
Прототипы функций приведены в файле \textbf{advection\_ext.h}, а их реализация - в файле \textbf{advection\_ext.c}.

\lstinputlisting{./src/advection_ext.h}

\lstinputlisting{./src/advection_ext.c}

Дополнительно к массиву $double\;stencil\_values$ введён массив $double\;stencil\_Dvalues$, в который перед обработкой каждого узла загружаются значения из массива $dU\_c$, соответствующие точкам шаблона.
Отметим, что в случае разрывного начального условия $ROUGH\_INITIAL$ на нулевом слое может быть использовано нулевое начальное условие на значения производной, в случае $SMOOTH\_INITIAL$ - $\nu(x,0)=u'_t(x,0)$

На рис. \ref{compact_stencil_cmp} приведено сравнение численного решения, полученного компактной схемой третьего порядка, с аналитическим решением.
В качестве начального условия использовался разрывный прямоугольный импульс, заданный в центре расчётной области.
Представлено распределение искомой функции после одного полного оборота.

\begin{figure}[h]
  \center
  \includegraphics[scale=0.6]{src/images/ext/fig_compact_cmp_rough.png}
  \caption{Сравнение численного решения компактной схемой с аналитическим решением}
\label{compact_stencil_cmp}
\end{figure}

\textbf{$\blacktriangle$ Исследовательские задания}

\begin {enumerate}
\item{Измените программу \textbf{Advection\_ext} так, чтобы убрать лишнее повторное вычисление коэффициентов полинома при расчёте значений функции и её производной.}
\item{Доработайте программу \textbf{Advection\_ext} для реализации схемы 5-го порядка согласно теории, изложенной в предыдущей главе.
Проверьте поведение схемы на гладких и разрывных решениях.}
\item{Доработайте программу \textbf{Advection\_ext} для реализации компактных схем повышенного порядка, основанных на расширении сеточного шаблона.
Отметим, что некоторые из них могут не обладать свойством устойчивости.
Можно ли при данном подходе построить схему чётного порядка сходимости?
Какими особенностями она будет обладать?
Проверьте поведение схем на гладких и разрывных решениях.}
\item{Проведите комплексное сравнение времени работы программ \textbf{Advection} и \textbf{Advection\_ext}.
Исследуйте вопрос, какую из схем оптимальнее (по времени расчёта) использовать для получения заданной изначально ошибки на аналитическом решении.}
\end {enumerate}

\clearpage
