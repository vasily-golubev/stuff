\section{Система уравнений акустики}

\subsection {Переход в инварианты Римана}

Рассмотрим задачу о распространении волн давления малой амплитуды в газе в одномерной постановке.
Будем считать, что равновестное состояние характеризуется нулевой скоростью течения газа, плотностью $\rho_0$ и давлением $P(\rho_0)$.
Неизвестными функциями являются давление $p(x, t)$ и скорость $u(x, t)$, как малые величины относительно равновесных значений.
Если ввести обозначение $K_0=\rho_0 P'(\rho_0)$, то динамические процессы, происходящие в среде, могут быть описаны линейной системой дифференциальных уравнений: 
\begin{equation}
\label{eq_acoustic}
\left[ \begin{array}{c} p \\ u \end{array} \right]_t
+
\left[ \begin{array}{cc} 0 & K_0 \\ \frac{1}{\rho_0} & 0 \end{array} \right]
\left[ \begin{array}{c} p \\ u \end{array} \right]_x
= 0.
\end{equation}

Собственные значения матрицы данной системы $\lambda_{1,2}=\pm c_0$, где $c_0=\sqrt{P'(\rho_0)}$.
Матрица $S$, составленная из собственных векторов, и обратная к ней $S^{-1}$ имеют вид соответственно:
\begin{equation}
\label{eq_acoustic_eigmat}
S=\left[ \begin{array}{cc} -Z_0 & Z_0 \\ 1 & 1 \end{array} \right],
S^{-1}=\frac{1}{2Z_0}\left[ \begin{array}{cc} -1 & Z_0 \\ 1 & Z_0 \end{array} \right],
\end{equation}
где $Z_0=\rho_0c_0$.

Таким образом, система \ref{eq_acoustic} может быть переписана в виде:
\begin{equation}
\label{eq_acoustic_simply}
\left[ \begin{array}{c} p \\ u \end{array} \right]_t
+
S\left[ \begin{array}{cc} -c_0 & 0 \\ 0 & c_0 \end{array} \right]S^{-1}
\left[ \begin{array}{c} p \\ u \end{array} \right]_x
= 0.
\end{equation}

Домножая обе части \ref{eq_acoustic_simply} на $S^{-1}$ слева и вводя замену переменных
\begin{equation}
\label{eq_acoustic_change}
\left[ \begin{array}{c} w_1 \\ w_2 \end{array} \right]=S^{-1} \left[ \begin{array}{c} p \\ u \end{array} \right]
=\frac{1}{2Z_0}
\left[ \begin{array}{c} -p + Z_0u \\ p + Z_0u \end{array} \right].
\end{equation}
получим следующую систему уравнений:
\begin{equation}
\label{eq_acoustic_rim}
\left[ \begin{array}{c} w_1 \\ w_2 \end{array} \right]_t
+
\left[ \begin{array}{cc} -c_0 & 0 \\ 0 & c_0 \end{array} \right]
\left[ \begin{array}{c} w_1 \\ w_2 \end{array} \right]_x
= 0.
\end{equation}

Таким образом, для решения задачи о распространении волн малой амплитуды в газе достаточно решить два независимых уравнения переноса в переменных $w_1, w_2$ и перейти обратно к переменным $p$ и $u$.

\subsection {Построение компактных схем}

Рассмотрим систему уравнений переноса \ref{eq_acoustic_rim}.
Введём дополнительные искомые функции с соответствующими граничными условиями:
\begin{equation}
\label{eq_extended_rim}
\begin{cases}
\nu_1(x,t)=\frac{\partial w_1(x,t)}{\partial x}, \\
\nu_2(x,t)=\frac{\partial w_2(x,t)}{\partial x}, \\
\nu_1(x,0)=\frac{\partial w_1(x,0)}{\partial x}, \\
\nu_2(x,0)=\frac{\partial w_2(x,0)}{\partial x}.
\end{cases}
\end{equation}

Системы \ref{eq_acoustic_rim} и \ref{eq_extended_rim} вместе образуют две независимые продолженные системы для уравнений переноса $w_1$ и $w_2$, которые можно решать, используя полученные ранее компактные схемы.
Следуя \ref{eq_grid_feature}, можно записать, что
\begin{eqnarray*}
\label{eq_grid_feature_w1w2}
w_1(x_m, t_n + \tau) = w_1(x_m + c_0\tau, t_n), \\
w_2(x_m, t_n + \tau) = w_2(x_m - c_0\tau, t_n).
\end{eqnarray*}

Таким образом, минимальный шаблон для решения акустической системы включает в себя четыре точки ${x^{n+1}_m, x^n_m, x^n_{m-1}, x^n_{m+1}}$.
Зная матрицы перехода \ref{eq_acoustic_eigmat}, можно рассчитать значения инвариантов Римана на текущем слое по времени через переменные задачи:
\begin{eqnarray*}
\label{w1w2_n_pu}
w^n_{1,m} = \frac{1}{2Z_0}(-p^n_m + Z_0u^n_m), \\
w^n_{2,m} = \frac{1}{2Z_0}(p^n_m + Z_0u^n_m).
\end{eqnarray*}

Для решения каждой из продолженных систем можно воспользоваться компактной схемой третьего порядка точности.
Тогда для $w_2$ будем иметь:
\begin{eqnarray*}
\label{eq_interpolated_w2}
w^n_2(x) = a_2x^3 + b_2x^2 + c_2x + d_2, \\
\nu^n_2(x) = 3a_2^2 + 2b_2 + c_2, \\
a_2 = \frac{\nu^n_{2, m}+\nu^n_{2, m-1}}{h^2} - 2\frac{w^n_{2,m}-w^n_{2,m-1}}{h^3}, \\
b_2 = \frac{2\nu^n_{2, m}+\nu^n_{2, m-1}}{h} - 3\frac{w^n_{2,m}-w^n_{2,m-1}}{h^2}, \\
c_2 = \nu^n_{2,m}, \\
d_2 = w^n_{2,m}, \\
w^{n+1}_{2,m}=w^n_2(x_m - c_0\tau), \\
\nu^{n+1}_{2,m}=\nu^n_2(x_m - c_0\tau).
\end{eqnarray*}

А для $w_1$ будем иметь:
\begin{eqnarray*}
\label{eq_interpolated_w1}
w^n_1(x) = a_1x^3 + b_1x^2 + c_1x + d_1, \\
\nu^n_1(x) = 3a_1^2 + 2b_1 + c_1, \\
a_1 = \frac{\nu^n_{1, m+1}+\nu^n_{1, m}}{h^2} - 2\frac{w^n_{1,m+1}-w^n_{1,m}}{h^3}, \\
b_1 = \frac{2\nu^n_{1, m+1}+\nu^n_{1, m}}{h} - 3\frac{w^n_{1,m+1}-w^n_{1,m}}{h^2}, \\
c_1 = \nu^n_{1,m+1}, \\
d_1 = w^n_{1,m+1}, \\
w^{n+1}_{1,m}=w^n_1(x_m + c_0\tau), \\
\nu^{n+1}_{1,m}=\nu^n_1(x_m + c_0\tau).
\end{eqnarray*}

Зная матрицы перехода \ref{eq_acoustic_eigmat}, можно рассчитать значения переменных задачи через значения инвариантов Римана на следующем слое по времени:
\begin{eqnarray*}
\label{pu_n_w1w2}
p^{n+1}_m = Z_0(-w^{n+1}_{1,m} + w^{n+1}_{2,m}), \\
u^{n+1}_m = w^{n+1}_{1,m} + w^{n+1}_{2,m}.
\end{eqnarray*}

\textbf{$\blacktriangle$ Исследовательские задания}

\begin {enumerate}
\item{Постройте компактную схему пятого порядка точности для системы уравнений акустики.
Сколько точек в этом случае входит в её шаблон?
Предложите варианты асимметричных компактных схем, построенных на меньшем числе точек.
В чём, по вашему, заключается их недостаток?}
\item{Используя подход расширения пространственного шаблона для повышения точности схемы, постройте схемы с 1 до 5 порядка включительно.}
\end {enumerate}

\subsection {Пример численного расчёта}

Альтернативой расширению пространственного шаблона с целью повышения порядка аппроксимации разностной схемы является использование продолженных систем уравнений.
При этом используются дифференциальные следствия исходных уравнений.
Схемы, построенные с применением данного подхода, называются компактными за счёт компактности разностного шаблона.

\textbf{$\blacktriangle$ Исследовательские задания}

\begin {enumerate}
\item{Измените программу \textbf{Advection\_ext} так, чтобы убрать лишнее повторное вычисление коэффициентов полинома при расчёте значений функции и её производной.}
\end {enumerate}

\clearpage
