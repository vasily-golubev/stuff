\begin{center}
\Large { \textbf {Сеточно-характеристические методы для численного решения одномерного линейного уравнения переноса}}
\end{center}
\rule[5pt]{\textwidth}{0.5pt} \vspace {-8mm}

\section*{Введение}
\addcontentsline{toc}{section}{Введение}

Гиперболические системы уравнений составляют основу математических моделей множества физических процессов [1. Холодов А.С. Численные методы решения уравнений и систем гиперболического типа // Энциклопедия низкотемпературной плазмы. Т.VII-1. Ч.2. М.: Янус-К, 2008, С.141-174].
К ним относятся: задачи газовой динамики, линейно-упругого тела, примесного массопереноса.
К сожалению, превалирующее число прикладных задач, определяемых, как расчётной областью, так и начальными и граничными условиями, не имеют аналитического решения.
Таким образом, важной задачей является изучение существующих и разработка новых численных методов для решения гиперболических систем уравнений.

Одним из подходов к построению численных методов решения гиперболических систем уравнений является метод расщепления по пространственным переменным, который, совместно с соответствующей заменой переменных, позволяет свести задачу к последовательному решению набора линейных одномерных уравнений переноса.
Данная работа посвящена проблеме построения сеточных численных методов для его решения.
Рассматривается общий подход, основанный на сеточно-характеристическом методе и интерполяции искомой функции полиномами на расчётном шаблоне.
Описаны два различных способа повышения порядка аппроксимации схемы: расширение пространственного шаблона [2. Rusanov V.V. Calculation of intersection of non-steady shock waves with obstacles // J. Comput. Math. Phys. USSR. 1961. Vol. 1. P. 267-279] и дополнение исходного уравнения его дифференциальным следствием [3. Courant, Richard and Lax, Peter On nonlinear partial differential equations with two independent variables // Communications on Pure and Applied Mathematics, 1949. Vol. 2. P255-273].
Рассмотрен пример реализации численных схем на языке Си, предложены задачи для самостоятельной работы.

\subsection*{Одномерное линейное уравнение переноса}

Рассмотрим одномерное линейное уравнение переноса:
\begin{equation}
\label{eq_advection}
u_t + \lambda u_x  = 0.
\end{equation}

где $u(x,t)$ - искомая функция, например, концентрация взвешенных частиц в жидкости, $\lambda$ - скорость переноса.
Введём замену переменных
\begin{equation}
\label{eq_ksi}
\xi = x - \lambda t
\end{equation}

и будем искать решение уравнения \ref{eq_advection} в виде $u(\xi)$.
Прямой подстановкой можно убедиться, что \ref{eq_advection} превращается в тождество.
Таким образом, если рассмотреть два последовательных момента времени $t^n$ и $t^n+\tau$, можно записать следующее равенство:
\begin{equation}
\label{eq_grid_feature}
u(x_m, t_n+\tau) = u(x_m-\lambda\tau, t_n).
\end{equation}

На базе данного свойства построен класс высокоточных сеточно-характеристических численных методом [4. Магомедов К.М., Холодов А.С. Сеточно-характеристические численные методы // Наука, 1988. 287 с.].
Все дальнейшие выкладки будем проводить в предположении $\lambda\geq0$, поскольку обобщение на случай отрицательного коэффициента путём замены $\lambda$ на $-\lambda$ и изменения шаблона на противоположный не представляет труда.

\subsection*{Одномерные линейные уравнения газовой динамики}

Рассмотрим задачу о распространении волн давления малой амплитуды в газе в одномерной постановке.
Будем считать, что равновестное состояние характеризуется нулевой скоростью течения газа, плотностью $\rho_0$ и давлением $P(\rho_0)$.
Неизвестными функциями являются давление $p(x, t)$ и скорость $u(x, t)$, как малые величины относительно равновесных значений.
Если ввести обозначение $K_0=\rho_0 P'(\rho_0)$, то динамические процессы, происходящие в среде, могут быть описаны линейной системой дифференциальных уравнений: 
\begin{equation}
\label{eq_acoustic}
\left[ \begin{array}{c} p \\ u \end{array} \right]_t
+
\left[ \begin{array}{cc} 0 & K_0 \\ \frac{1}{\rho_0} & 0 \end{array} \right]
\left[ \begin{array}{c} p \\ u \end{array} \right]_x
= 0.
\end{equation}

Собственные значения матрицы данной системы $\lambda_{1,2}=\pm c_0$, где $c_0=\sqrt{P'(\rho_0)}$.
Матрица $S$, составленная из собственных векторов, и обратная к ней $S^{-1}$ имеют вид соответственно:
\begin{equation}
\label{eq_acoustic_eigmat}
S=\left[ \begin{array}{cc} -Z_0 & Z_0 \\ 1 & 1 \end{array} \right],
S^{-1}=\frac{1}{2Z_0}\left[ \begin{array}{cc} -1 & Z_0 \\ 1 & Z_0 \end{array} \right],
\end{equation}
где $Z_0=\rho_0c_0$.

Таким образом, система \ref{eq_acoustic} может быть переписана в виде:
\begin{equation}
\label{eq_acoustic_simply}
\left[ \begin{array}{c} p \\ u \end{array} \right]_t
+
S\left[ \begin{array}{cc} -c_0 & 0 \\ 0 & c_0 \end{array} \right]S^{-1}
\left[ \begin{array}{c} p \\ u \end{array} \right]_x
= 0.
\end{equation}

Домножая обе части \ref{eq_acoustic_simply} на $S^{-1}$ слева и вводя замену переменных
\begin{equation}
\label{eq_acoustic_change}
\left[ \begin{array}{c} w_1 \\ w_2 \end{array} \right]=S^{-1} \left[ \begin{array}{c} p \\ u \end{array} \right]
=\frac{1}{2Z_0}
\left[ \begin{array}{c} -p + Z_0u \\ p + Z_0u \end{array} \right].
\end{equation}
получим следующую систему уравнений:
\begin{equation}
\label{eq_acoustic_rim}
\left[ \begin{array}{c} w_1 \\ w_2 \end{array} \right]_t
+
\left[ \begin{array}{cc} -c_0 & 0 \\ 0 & c_0 \end{array} \right]
\left[ \begin{array}{c} w_1 \\ w_2 \end{array} \right]_x
= 0.
\end{equation}

Таким образом, для решения задачи о распространении волн малой амплитуды в газе достаточно решить два независимых уравнения переноса в переменных $w_1, w_2$ и перейти обратно к переменным $p$ и $u$.

\subsection*{Одномерные линейные уравнения упругой среды}

Рассмотрим задачу о распространении волн давления малой амплитуды в упругой среде в одномерной постановке.
Аналогично случаю с распространением возмущений в газе неизвестные функции будут отсчитываться от равновесных значений.
К ним относится напряжение $\sigma_{xx}(x, t)$ и скорость среды $u(x, t)$.
Дополнительно введём обозначения: $\lambda$ и $\mu$ - упругие параметры Лямэ, $\rho$ - плотность среды.
Динамические процессы, происходящие в среде, могут быть описаны линейной системой дифференциальных уравнений: 
\begin{equation}
\label{eq_elastic}
\left[ \begin{array}{c} \sigma_{xx} \\ u \end{array} \right]_t
+
\left[ \begin{array}{cc} 0 & -(\lambda + 2\mu) \\ -\frac{1}{\rho} & 0 \end{array} \right]
\left[ \begin{array}{c} \sigma_{xx} \\ u \end{array} \right]_x
= 0.
\end{equation}

Собственные значения матрицы данной системы $\lambda_{1,2}=\pm c_p$, где $c_p=\sqrt{\frac{\lambda+2\mu}{\rho}}$.
Матрица $S$, составленная из собственных векторов, и обратная к ней $S^{-1}$ имеют вид соответственно:
\begin{equation}
\label{eq_acoustic_eigmat}
S=\left[ \begin{array}{cc} Z & -Z \\ 1 & 1 \end{array} \right],
S^{-1}=\frac{1}{2Z}\left[ \begin{array}{cc} 1 & Z \\ -1 & Z \end{array} \right],
\end{equation}
где $Z=\rho c_p$.

Аналогично \ref{eq_acoustic_change} введением замены переменных
\begin{equation}
\label{eq_elastic_change}
\left[ \begin{array}{c} w_1 \\ w_2 \end{array} \right]=S^{-1} \left[ \begin{array}{c} \sigma_{xx} \\ u \end{array} \right]
=\frac{1}{2Z}
\left[ \begin{array}{c} \sigma_{xx} + Zu \\ -\sigma_{xx} + Zu \end{array} \right]
\end{equation}

исходную систему уравнений \ref{eq_elastic} можно преобразовать к виду:
\begin{equation}
\label{eq_elastic_rim}
\left[ \begin{array}{c} w_1 \\ w_2 \end{array} \right]_t
+
\left[ \begin{array}{cc} -c_p & 0 \\ 0 & c_p \end{array} \right]
\left[ \begin{array}{c} w_1 \\ w_2 \end{array} \right]_x
= 0.
\end{equation}

Таким образом, для решения задачи о распространении упругих волн малой амплитуды в среде достаточно решить два независимых уравнения переноса в переменных $w_1, w_2$ и перейти обратно к переменным $\sigma_{xx}$ и $u$.

\section {Сеточно-характеристические схемы на расширенном шаблоне}

\subsection {Построение и анализ}

Согласно уравнению \ref{eq_grid_feature} необходимо иметь возможность восстанавливать значение искомой функции $u(x,t)$ в произвольной точке расчётной области, тогда как при численном расчёте её значения хранятся в фиксированных узлах расчётной сетки.
Для решения данной задачи воспользуемся процедурой интерполяции функции полиномом заданной степени.
Отметим, что все рассматриваемые схемы будут относиться к явному типу, т.е. на слое $n+1$ будет присутствовать только одна точка шаблона $x^{n+1}_m$.

Рассмотрим двухточечный по пространству шаблон рис. \ref{stencil_2_2}.
На нём можно построить полином первой степени по значениям функции в узлах $x^n_m$ и $x^n_{m-1}$.

\begin{figure}[h]
  \center
  \includegraphics[scale=1.0]{pictures/stencil_2_2.pdf}
  \caption{Двухточечный по пространству шаблон, используемый для построения схемы первого порядка}
\label{stencil_2_2}
\end{figure}

В общем виде полином первого порядка представим в виде:
\begin{equation}
\label{eq_polynom_1}
F_1(x) = a_1x + b_1.
\end{equation}

Коэффициенты $a_1$ и $b_1$ могут быть найдены из условия прохождения полинома $F_1(x)$ через значения функции, хранимые в узлах шаблона:
\begin{eqnarray*}
\label{eq_polynom_1_params} 
a_1 = \frac{u^n_m - u^n_{m-1}}{h}, \\
b_1 = u^n_m.
\end{eqnarray*}

Подставляя их в выражение \ref{eq_polynom_1} и используя соотношение \ref{eq_grid_feature}, получим:
\begin{equation}
\label{eq_polynom_1_schema} 
u^{n+1}_m = u^n_m - \frac{\lambda\tau}{h}(u^n_m - u^n_{m-1}).
\end{equation}

Наиболее простым и интуитивно ясным способом повышения порядка аппроксимации схемы по пространству является расширение сеточного шаблона.

Расширим шаблон в положительном направлении, добавив точку $x^n_{m+1}$.
На нём может быть построен полином второй степени, в общем виде представимый соотношением:
\begin{equation}
\label{eq_polynom_2} 
F_2(x) = a_2x^2 + b_2x + c_2.
\end{equation}

Коэффициенты $a_2$, $b_2$ и $c_2$ могут быть найдены из условия прохождения полинома $F_2(x)$ через значения функции, хранимые в узлах шаблона:
\begin{eqnarray*}
\label{eq_polynom_2_params}
a_2 = \frac{u^n_{m+1} - 2u^n_m + u^n_{m-1}}{2h^2}, \\
b_2 = \frac{u^n_{m+1} - u^n_{m-1}}{2h}, \\
c_2 = u^n_m.
\end{eqnarray*}

Подставляя их в выражение \ref{eq_polynom_2} и используя соотношение \ref{eq_grid_feature}, получим:
\begin{equation}
\label{eq_polynom_2_schema} 
u^{n+1}_m = u^n_m - \frac{\lambda\tau}{2h}(u^n_{m+1} - u^n_{m-1}) + \frac{\lambda^2\tau^2}{2h^2}(u^n_{m+1}
- 2u^n_m + u^n_{m-1}).
\end{equation}

Для дальнейшего повышения порядка схемы расширим шаблон, добавив в него точку $x_{m-2}$.
На нём может быть построен полином третьей степени, в общем виде представимый соотношением:
\begin{equation}
\label{eq_polynom_3} 
F_3(x) = a_3x^3 + b_3x^2 + c_3x + d_3.
\end{equation}

Коэффициенты $a_3$, $b_3$, $c_3$ и $d_3$ могут быть найдены из условия прохождения полинома $F_3(x)$ через значения функции, хранимые в узлах шаблона:
\begin{eqnarray*}
\label{eq_polynom_3_params}
a_3 = \frac{u^n_{m+1} + 3u^n_{m-1} -3 u^n_m - u^n_{m-2}}{6h^3}, \\
b_3 = \frac{u^n_{m+1} - 2u^n_m + u^n_{m-1}}{2h^2}, \\
c_3 = \frac{2u^n_{m+1} + 3u^n_m - 6u^n_{m-1} + u^n_{m-2}}{6h}, \\
d_3 = u^n_m.
\end{eqnarray*}

Подставляя их в выражение \ref{eq_polynom_3} и используя соотношение \ref{eq_grid_feature}, получим:
\begin{eqnarray}
\label{eq_polynom_3_schema} 
u^{n+1}_m = u^n_m - \frac{\lambda\tau}{6h}(2u^n_{m+1} + 3u^n_m -6u^n_{m-1} + u^n_{m-2}) + \nonumber\\
+ \frac{\lambda^2\tau^2}{2h^2}(u^n_{m+1} - 2u^n_m + u^n_{m-1}) - \nonumber\\
- \frac{\lambda^3\tau^3}{6h^3}(u^n_{m+1} + 3u^n_{m-1} - 3u^n_m - u^n_{m-2}).
\end{eqnarray}

Для дальнейшего повышения порядка схемы расширим шаблон, добавив в него точку $x_{m+2}$.
На нём может быть построен полином четвёртой степени, в общем виде представимый соотношением:
\begin{equation}
\label{eq_polynom_4} 
F_4(x) = a_4x^4 + b_4x^3 + c_4x^2 + d_4x + e_4.
\end{equation}

Коэффициенты $a_4$, $b_4$, $c_4$, $d_4$ и $e_4$ могут быть найдены из условия прохождения полинома $F_4(x)$ через значения функции, хранимые в узлах шаблона:
\begin{eqnarray*}
\label{eq_polynom_4_params}
a_4 = \frac{6u^n_m - 4u^n_{m+1} - 4u^n_{m-1} + u^n_{m+2} + u^n_{m-2}}{24h^4}, \\
b_4 = \frac{2u^n_{m-1} - 2u^n_{m+1} + u^n_{m+2} - u^n_{m-2}}{12h^3}, \\
c_4 = \frac{16u^n_{m+1} - 30u^n_m + 16u^n_{m-1} - u^n_{m+2} - u^n_{m-2}}{24h^2}, \\
d_4 = \frac{8u^n_{m+1} - 8u^n_{m-1} - u^n_{m+2} + u^n_{m-2}}{12h}, \\
e_4 = u^n_m.
\end{eqnarray*}

Подставляя их в выражение \ref{eq_polynom_4} и используя соотношение \ref{eq_grid_feature}, получим:
\begin{eqnarray}
\label{eq_polynom_4_schema}
u^{n+1}_m = u^n_m - \frac{\lambda\tau}{12h}(8u^n_{m+1} - 8u^n_{m-1} - u^n_{m+2} + u^n_{m-2}) + \nonumber\\
+ \frac{\lambda^2\tau^2}{24h^2}(16u^n_{m+1} - 30u^n_m + 16u^n_{m-1} - u^n_{m+2} - u^n_{m-2}) - \nonumber\\
- \frac{\lambda^3\tau^3}{12h^3}(2u^n_{m-1} - 2u^n_{m+1} + u^n_{m+2} - u^n_{m-2}) + \nonumber\\
+ \frac{\lambda^4\tau^4}{24h^4}(6u^n_m - 4u^n_{m+1} - 4u^n_{m-1} + u^n_{m+2} + u^n_{m-2}).
\end{eqnarray}

\textbf{$\blacktriangle$ Исследовательские задания}

\begin {enumerate}
\item{Постройте схемы повышенных порядков аппроксимации (начиная с 5-го) путём расширения сеточного шаблона точками $x^n_{m-3}, x^n_{m+3}, x^n_{m-4}, x^n_{m+4}$, и т.д. соответственно.
Подумайте, какие могут возникнуть проблемы при их компьютерной реализации.}
\item{Как было сказано ранее, для случая $\lambda<0$ схема первого порядка может быть получена простой заменой знака у собственного числа и перехода от $x^n_{m-1}$ к $x^n_{m+1}$.
Подумайте, как можно реализовать численную схему, в которой собственные числа могут быть обоих знаков.
Простейший пример - движение взвеси частиц в жидкости со скоростью потока в заданном (положительном или отрицательном) направлении.}
\item{Покажите, что сеточно-характеристическая схема при аппроксимации полиномом второго порядка совпадает со схемой Лакса-Вендроффа [5. Lax, P.D., Wendroff, B. System of conservation laws / P.D. Lax, B. Wendroff // Comm. Pure and Appl. Math. – 1960. – Vol. 13, No. 2. – P. 217 – 237.].}
\item{Покажите, что сеточно-характеристическая схема при аппроксимации полиномом третьего порядка совпадает со схемой Русанова [6. Rusanov, V.V. Calculation of intersection of non-steady shock waves with obstacles / V.V. Rusanov // J. Comput. Math. Phys. USSR. – 1961. – Vol. 1. – P. 267-279].}
\end {enumerate}

\subsection {Реализация на языке Си}

\lstset{language=C}

Описанные вычислительные алгоритмы могут быть запрограммированы на любом языке программирования.
Рассмотрим реализацию численных схем на расширенном шаблоне для решения одномерного линейного уравнения переноса на языке Си.

Отдельные логические этапы алгоритма логично вынести в функции.
При таком подходе, например, можно будет обеспечить переход от одного типа интерполяции к другому изменением лишь функции интерполяции без излишнего дублирования кода.
Рассмотрим файл с прототипами функций \textbf{advection.h}.

\lstinputlisting{./src/advection.h}

Определение $N$ задаёт количество узлов, на которое разбивается расчётная область $[-1, 1$], в глобальных массивах $U\_c$ и $U\_n$ хранятся значения искомой функции на текущем и следующем временном слое, соответственно.
Функция $initialize(void)$ производит заполнение массива $U\_c$ начальным условием, $singleStep()$ - выполняет один шаг расчётной схемы, проходя в цикле по всем узлам сетки.
Функция $interpolatedValue(double\;*u)$ проводит интерполяцию по точкам шаблона и возвращает значение полинома в точке $x_0=-\lambda\tau$, $debugPrint()$ - выводит состояние текущего временного слоя в схематичном виде на стандартный поток вывода, $debugGnuplot()$ - сохраняет в файл для последующего построения графиков в программе Gnuplot.
Их реализации приведены в файле \textbf{advection.c}.

\lstinputlisting{./src/advection.c}

Используемые обозначения: $l=\lambda$, $h$ - шаг сетки, $tau$ - шаг по времени, $k=\frac{l*tau}{h}$, $M$ - число шагов по времени.
Реализовано два вида начальных условий, используемых в замисимости от флагов компиляции:
\begin{enumerate}
\item{ROUGH\_INITIAL - разрывный прямоугольный единичный импульс, заданный в центре области.}
\item{SMOOTH\_INITIAL - гладкая функция $sin^4(\pi x)$, заданная на всей области.}
\end{enumerate}

Для прозрачной реализации процедуры интерполяции по заданному шаблону применён специальный приём.
В массив $int\;stencil$ в зависимости от флагов компиляции записываются смещения (в индексах) узлов относительно центрального, соответствующие используемому шаблону.
Дополнительно выделяется массив $double\;stencil\_values$, в который перед обработкой каждого узла загружаются значения из массива $U\_c$, соответствующие точкам шаблона.
При этом реализуются циклические граничные условия, т.е. справа от крайнего правого узла располагается крайний левый узел.

Для компиляции программы используется скрипт \textbf{build.sh}.

\lstset{language=bash}

\lstinputlisting{./src/build.sh}

Распределение искомой функции по области расчёта, сохранённое функцией $debugGnuplot(void)$, может быть визуализировано, например, скриптом \textbf{plot.plot}.

\lstset{language=Gnuplot}

\lstinputlisting{./src/plot.plot}

На рис. \ref{wide_stencil_cmp} приведено сравнение численных решений, полученных схемами на расширенных шаблонах.
В качестве начального условия использовался разрывный прямоугольный импульс, заданный в центре расчётной области.
Представлено распределение искомой функции после одного полного оборота.

\begin{figure}[h]
  \center
  \includegraphics[scale=0.6]{src/images/wide/fig_wide_stencil_cmp_rough.png}
  \caption{Сравнение схем 1-3 порядков на расширенных шаблонах}
\label{wide_stencil_cmp}
\end{figure}

\textbf{$\blacktriangle$ Исследовательские задания}

\begin {enumerate}
\item{Доработайте программу \textbf{Advection} для реализации схемы 4-го порядка согласно теории, изложенной в предыдущей главе.
Проверьте поведение схемы на гладких и разрывных решениях.}
\item{Доработайте программу \textbf{Advection} для реализации схем повышенного порядка, основанных на расширении сеточного шаблона.
Проверьте поведение схем на гладких и разрывных решениях.}
\end {enumerate}

\clearpage
