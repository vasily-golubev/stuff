\begin{center}
\Large { \textbf {Построение сеточно-характеристических схем для одномерного линейного уравнения переноса}}
\end{center}
\rule[5pt]{\textwidth}{0.5pt} \vspace {-8mm}

\section*{Введение}
\addcontentsline{toc}{section}{Введение}

Гиперболические системы уравнений составляют основу математических моделей множества физических процессов.
К ним относятся: задачи газовой динамики, линейно-упругого тела, примесного массопереноса.
К сожалению, превалирующее число прикладных задач, определяющих, как расчётную область, так и начальные и граничные условия,
не имеют аналитического решения.
Таким образом, важной задачей является разработка численных методов для решения гиперболических систем уравнений.

Одним из подходов является метод расщепления по пространственным переменным, который совместно с соответствующей заменой переменных
позволяет свести задачу к последовательному решению набора линейных одномерных уравнений переноса. 
Данная работа посвящена проблеме построения сеточных численных методов для его решения.
Описывается общий подход, основанный на сеточно-характеристическом методе и интерполяции полиномами на расчётном шаблоне.
Автором в общем виде излагается алгоритм, который может быть непосредственно реализован на языке Си.


\subsection*{Одномерное линейное уравнение переноса}

Рассмотрим одномерное линейное уравнение переноса:
\begin{equation}
\label{eq_advection}
u_t + \lambda u_x  = 0.
\end{equation}

где $u(x,t)$ - искомая функция, например, концентрация взвешенных частиц в жидкости, $\lambda$ - скорость переноса.
Введём замену переменных
\begin{equation}
\label{eq_ksi}
\xi = x - \lambda t
\end{equation}

и будем искать решение уравнения \ref{eq_advection} в виде $u(\xi)$.
Прямой подстановкой можно убедиться, что $u_\xi == 0$.
Таким образом, если рассмотреть два последовательных момента времени $t^n$ и $t^n+\tau$, можно записать следующее равенство:
\begin{equation}
\label{eq_grid_feature}
u^{n+1}_m = u^n (x_m-\lambda\tau).
\end{equation}

Отметим, что все дальнейшие выкладки будут симметричны относительно замены $\lambda$ на $-\lambda$ и изменения шаблона на противоположный.
Для наглядности в дальнейшем будем полагать $\lambda\geq0$.

\subsection*{Одномерные уравнения газовой динамики}

Рассмотрим задачу о распространении волн давления малой амплитуды в газе в одномерной постановке.
Будем считать, что равновестное состояние характеризуется нулевой скоростью течения газа, плотностью $\rho_0$ и давлением $P(\rho_0)$.
Неизвестными функциями являются давление $p(x, t)$ и скорость $u(x, t)$, как малые величины относительно равновесных значений.
Если ввести обозначение $K_0=\rho_0 P'(\rho_0)$, то динамические процессы, происходящие в среде, могут быть описаны линейной системой дифференциальных уравнений: 
\begin{equation}
\label{eq_acoustic}
\left[ \begin{array}{c} p \\ u \end{array} \right]_t
+
\left[ \begin{array}{cc} 0 & K_0 \\ \frac{1}{\rho_0} & 0 \end{array} \right]
\left[ \begin{array}{c} p \\ u \end{array} \right]_x
= 0.
\end{equation}

Собственные значения матрицы данной системы $\lambda_{1,2}=\pm c_0$, где $c_0=\sqrt{P'(\rho_0)}$.
Матрица, составленная из собственных векторов, $S$ и обратная к ней $S^{-1}$ имеют вид соответственно
\begin{equation}
\label{eq_acoustic_eigmat}
S=\left[ \begin{array}{cc} -Z_0 & Z_0 \\ 1 & 1 \end{array} \right],
S^{-1}=\frac{1}{2Z_0}\left[ \begin{array}{cc} -1 & Z_0 \\ 1 & Z_0 \end{array} \right],
\end{equation}
где $Z_0=\rho_0c_0$.

Таким образом, уравнение \ref{eq_acoustic} может быть переписано в виде:
\begin{equation}
\label{eq_acoustic_simply}
\left[ \begin{array}{c} p \\ u \end{array} \right]_t
+
S\left[ \begin{array}{cc} -c_0 & 0 \\ 0 & c_0 \end{array} \right]S^{-1}
\left[ \begin{array}{c} p \\ u \end{array} \right]_x
= 0.
\end{equation}

Домножая обе части \ref{eq_acoustic_simply} на $S^{-1}$ слева и вводя замену переменных
\begin{equation}
\label{eq_acoustic_change}
\left[ \begin{array}{c} w_1 \\ w_2 \end{array} \right]=S^{-1} \left[ \begin{array}{c} p \\ u \end{array} \right]
=\frac{1}{2Z_0}
\left[ \begin{array}{c} -p + Z_0u \\ p + Z_0u \end{array} \right].
\end{equation}
получим следующую систему уравнений:
\begin{equation}
\label{eq_acoustic_rim}
\left[ \begin{array}{c} w_1 \\ w_2 \end{array} \right]_t
+
\left[ \begin{array}{cc} -c_0 & 0 \\ 0 & c_0 \end{array} \right]
\left[ \begin{array}{c} w_1 \\ w_2 \end{array} \right]_x
= 0.
\end{equation}

Таким образом, для решения задачи о распространении волн малой амплитуды в газе достаточно решить два независимых уравнения переноса и перейти обратно к переменным $p$ и $u$.

\subsection*{Одномерные уравнения упругой среды}

Рассмотрим задачу о распространении волн давления малой амплитуды в упругой среде в одномерной постановке.
Аналогично случаю с распространением возмущений в газе неизвестные функции будут отсчитываться от равновесных значений.
К ним относится напряжение $\sigma_{xx}(x, t)$ и скорость среды $u(x, t)$.
Дополнительно введём обозначения: $\lambda$ и $\mu$ - упругие параметры Лямэ, $\rho$ - плотность среды.
Динамические процессы, происходящие в среде, могут быть описаны линейной системой дифференциальных уравнений: 
\begin{equation}
\label{eq_elastic}
\left[ \begin{array}{c} \sigma_{xx} \\ u \end{array} \right]_t
+
\left[ \begin{array}{cc} 0 & -(\lambda + 2\mu) \\ -\frac{1}{\rho} & 0 \end{array} \right]
\left[ \begin{array}{c} \sigma_{xx} \\ u \end{array} \right]_x
= 0.
\end{equation}

Собственные значения матрицы данной системы $\lambda_{1,2}=\pm c_p$, где $c_p=\sqrt{\frac{\lambda+2\mu}{\rho}}$.
Матрица, составленная из собственных векторов, $S$ и обратная к ней $S^{-1}$ имеют вид соответственно
\begin{equation}
\label{eq_acoustic_eigmat}
S=\left[ \begin{array}{cc} Z & -Z \\ 1 & 1 \end{array} \right],
S^{-1}=\frac{1}{2Z}\left[ \begin{array}{cc} 1 & Z \\ -1 & Z \end{array} \right],
\end{equation}
где $Z=\rho c_p$.

Аналогично \ref{eq_acoustic_change} введением замены переменных
\begin{equation}
\label{eq_elastic_change}
\left[ \begin{array}{c} w_1 \\ w_2 \end{array} \right]=S^{-1} \left[ \begin{array}{c} \sigma_{xx} \\ u \end{array} \right]
=\frac{1}{2Z}
\left[ \begin{array}{c} \sigma_{xx} + Zu \\ -\sigma_{xx} + Zu \end{array} \right].
\end{equation}
исходную систему уравнений \ref{eq_acoustic} можно преобразовать к виду:
\begin{equation}
\label{eq_elastic_rim}
\left[ \begin{array}{c} w_1 \\ w_2 \end{array} \right]_t
+
\left[ \begin{array}{cc} -c_p & 0 \\ 0 & c_p \end{array} \right]
\left[ \begin{array}{c} w_1 \\ w_2 \end{array} \right]_x
= 0.
\end{equation}

Таким образом, для решения задачи о распространении волн малой амплитуды в упругой среде достаточно решить два независимых уравнения переноса и перейти обратно к переменным $\sigma_{xx}$ и $u$.

\section {Сеточные схемы на расширенном пространственном шаблоне}

Согласно вышеизложенному, необходимо иметь возможность восстанавливать значение функции $u(x,t)$ в произвольной точке расчётной области,
тогда как при численном расчёте её значения хранятся в фиксированных узлах сетки.
Для решения данной задачи воспользуемся процедурой интерполяции полиномом заданной степени.
Отметим, что все рассматриваемые схемы будут относиться к явному типу, т.е. на слое $n+1$ будет присутствовать только одна точка шаблона
$x^{n+1}_m$.
Рассмотрим двухточечный по пространству шаблон рис. \ref{stencil_2_2}.
На нём можно построить полином первой степени по значениям функции в узлах $x^n_m$ и $x^n_{m-1}$.

\begin{figure}[h]
  \center
  \includegraphics[scale=0.4]{pictures/stencil_2_2.pdf}
  \caption{Двухточечный по пространству шаблон, используемый для построения схемы первого порядка}
\label{stencil_2_2}
\end{figure}

В общем виде полином первого порядка представим в виде:
\begin{equation}
\label{eq_polynom_1}
F_1(x) = a_1x + b_1.
\end{equation}
Коэффициенты $a_1$ и $b_1$ могут быть найдены из условий равенства значений полинома в узлах шаблона:
\begin{eqnarray*}
\label{eq_polynom_1_params} 
a_1 = \frac{u^n_m - u^n_{m-1}}{h}, \\
b_1 = u^n_m.
\end{eqnarray*}

Подставляя их в выражение \ref{eq_polynom_1} и используя соотношение \ref{eq_grid_feature}, получим:
\begin{equation}
\label{eq_polynom_1_schema} 
u^{n+1}_m = u^n_m - \frac{\lambda\tau}{h}(u^n_m - u^n_{m-1}).
\end{equation}

Наиболее простым и интуитивным способом повышения порядка точности схемы по пространству является расширение сеточного шаблона.
Расширим шаблон в положительном направлении, добавив точку $x^n_{m+1}$ (см. рис. \ref{stencil_2_2}).

\begin{figure}[h]
  \center
% FIXME Correct path for image.
  \includegraphics[scale=0.4]{pictures/stencil_2_2.pdf}
  \caption{Трёхточечный по пространству шаблон, используемый для построения схемы первого порядка}
\label{stencil_2_2}
\end{figure}

На нём может быть построен полином второй степени, в общем виде представимый соотношением:
\begin{equation}
\label{eq_polynom_2} 
F_2(x) = a_2x^2 + b_2x + c_2.
\end{equation}

Коэффициенты $a_2$, $b_2$ и $c_2$ могут быть найдены из условий равенства значений полинома в узлах шаблона:
\begin{eqnarray*}
\label{eq_polynom_2_params}
a_2 = \frac{u^n_{m+1} - 2u^n_m + u^n_{m-1}}{2h^2}, \\
b_2 = \frac{u^n_{m+1} - u^n_{m-1}}{2h}, \\
c_2 = u^n_m.
\end{eqnarray*}

Подставляя их в выражение \ref{eq_polynom_2} и используя соотношение \ref{eq_grid_feature}, получим:
\begin{equation}
\label{eq_polynom_2_schema} 
u^{n+1}_m = u^n_m - \frac{\lambda\tau}{2h}(u^n_{m+1} - u^n_{m-1}) + \frac{\lambda^2\tau^2}{2h^2}(u^n_{m+1}
- 2u^n_m + u^n_{m-1}).
\end{equation}

Для дальнейшего повышения порядка схемы расширим шаблон, добавив в него точку $x_{m-2}$.
На нём может быть построен полином третьей степени, в общем виде представимый соотношением:
\begin{equation}
\label{eq_polynom_3} 
F_3(x) = a_3x^3 + b_3x^2 + c_3x + d_3.
\end{equation}

Коэффициенты $a_3$, $b_3$, $c_3$ и $d_3$ могут быть найдены из условий равенства значений полинома в узлах шаблона:
\begin{eqnarray*}
\label{eq_polynom_3_params}
a_3 = \frac{u^n_{m+1} + 3u^n_{m-1} -3 u^n_m - u^n_{m-2}}{6h^3}, \\
b_3 = \frac{u^n_{m+1} - 2u^n_m + u^n_{m-1}}{2h^2}, \\
c_3 = \frac{2u^n_{m+1} + 3u^n_m - 6u^n_{m-1} + u^n_{m-2}}{6h}, \\
d_3 = u^n_m.
\end{eqnarray*}

Подставляя их в выражение \ref{eq_polynom_3} и используя соотношение \ref{eq_grid_feature}, получим:
\begin{eqnarray}
\label{eq_polynom_3_schema} 
u^{n+1}_m = u^n_m - \frac{\lambda\tau}{6h}(2u^n_{m+1} + 3u^n_m -6u^n_{m-1} + u^n_{m-2}) + \nonumber\\
+ \frac{\lambda^2\tau^2}{2h^2}(u^n_{m+1} - 2u^n_m + u^n_{m-1}) - \nonumber\\
- \frac{\lambda^3\tau^3}{6h^3}(u^n_{m+1} + 3u^n_{m-1} - 3u^n_m - u^n_{m-2}).
\end{eqnarray}

Для дальнейшего повышения порядка схемы расширим шаблон, добавив в него точку $x_{m+2}$.
На нём может быть построен полином четвёртой степени, в общем виде представимый соотношением:
\begin{equation}
\label{eq_polynom_4} 
F_3(x) = a_4x^4 + b_4x^3 + c_4x^2 + d_4x + e_4.
\end{equation}

Коэффициенты $a_4$, $b_4$, $c_4$, $d_4$ и $e_4$ могут быть найдены из условий равенства значений полинома в узлах шаблона:
\begin{eqnarray*}
\label{eq_polynom_4_params}
a_4 = \frac{6u^n_m - 4u^n_{m+1} - 4u^n_{m-1} + u^n_{m+2} + u^n_{m-2}}{24h^4}, \\
b_4 = \frac{2u^n_{m-1} - 2u^n_{m+1} + u^n_{m+2} - u^n_{m-2}}{12h^3}, \\
c_4 = \frac{16u^n_{m+1} - 30u^n_m + 16u^n_{m-1} - u^n_{m+2} + u^n_{m-2}}{24h^2}, \\
d_4 = \frac{8u^n_{m+1} - 8u^n_{m-1} - u^n_{m+2} + u^n_{m-2}}{12h}, \\
e_4 = u^n_m.
\end{eqnarray*}

Подставляя их в выражение \ref{eq_polynom_4} и используя соотношение \ref{eq_grid_feature}, получим:
\begin{eqnarray}
\label{eq_polynom_4_schema}
u^{n+1}_m = u^n_m - \frac{\lambda\tau}{12h}(8u^n_{m+1} - 8u^n_{m-1} - u^n_{m+1} + u^n_{m-2}) + \nonumber\\
+ \frac{\lambda^2\tau^2}{24h^2}(16u^n_{m+1} - 30u^n_m + 16u^n_{m-1} - u^n_{m+2} + u^n_{m-2}) + \nonumber\\
+ \frac{\lambda^3\tau^3}{12h^3}(2u^n_{m-1} - 2u^n_{m+1} + u^n_{m+2} - u^n_{m-2}) + \nonumber\\
+ \frac{\lambda^4\tau^4}{24h^4}(6u^n_m - 4u^n_{m+1} - 4u^n_{m-1} + u^n_{m+2} + u^n_{m-2}).
\end{eqnarray}

$FIXME_FIXME_FIXME_FIXME_FIXME_FIXME$

\subsection {Реализация на языке C}

Алгоритмы, изложенные в предыдущем параграме могут легко быть реализованы на любом языке программирования.
Так, например, изложим код на языке C, реализующий решение одномерного уравнения переноса на каждом из перечисленных шаблонов.
В заголовочном файле advection.h приведены прототипы разработанных функций.
Как и следовало ожидать, весь процесс расчёта разделился на следующие этапы: инициализация начального условия, один шаг численной схемы с
нахождением значения в точке пересечения характеристики с предыдущим временным слоем путём полиномиальной интерполяции и вывод результатов расчётов.

\lstset{language=C}

\lstinputlisting{./src/advection.h}

\lstinputlisting{./src/advection.c}

\lstset{language=bash}

\lstinputlisting{./src/build.sh}

\lstset{language=Gnuplot}

\lstinputlisting{./src/plot.plot}

Цифровой радиоканал предназначен для передачи дискретных данных. Разумная модель таких данных~---~это бесконечный в обе стороны
поток информационных символов:
\[ \dots \quad c_{-n}, \dots ,c_{-2},c_{-1},c_{0},c_{1},c_{2},\dots, c_{n} \quad \dots \]

Значения символов $c_j$, вообще говоря, комплексные, выби\-раются из некоторого конечного множества (\emph{созвездия}) мощности
$M$. Тогда каждый символ переносит $\log_2 \, M$ битов информации. Простейший случай -- это бинарный поток, когда
$M=2$,~$c_j=\pm 1$ и символ переносит 1 бит.

\vspace{0.2cm}
\textbf{$\blacktriangle$ Исследовательское задание}

\vspace {0.1 cm}

\emph{Задание единое для всех. Различие только в \textbf{выборе} инвертируемого символа $En-m$.}

\vspace{0.1cm}
\begin{tabular}{llllll}
1. &  $E5-6$; & 2. &  $E6-7$; & 3. &  $E7-8$;\\
4. &  $E8-9$; & 5. &  $E9-10$; & 6. &  $E10-11;$\\
\end{tabular}

Блоки с оптимальными в этом смысле корреляциями называют кодами Баркера. Показано, что коды Баркера существуют только для длин $N=2,3,4,5,7,11,13$. Вот их полный перечень:
\begin{itemize}
\item $\bar{c}\,(2)  = (+,-)$
\item $\bar{c}\,(3)  = (+,+,-)$
\item $\bar{c}\,(4)  = (+,+,-,+), (+,+,+,-)$
\end{itemize}

Естественной мерой качества сигнала оказывается его спектральная эффективность $\varrho = R/F_s$~--- число передаваемых бод на
герц используемой полосы. При выборе способа передачи цифровых данных возникает задача оптимизации спектральной эффективности.
Относительно просто она трактуется для систем с линейной модуляцией.

\begin{figure}[h]
  \center
  \includegraphics[scale=0.4]{pictures/055-ris2.png}
  \caption{Спектр ЯМР в антиферромагнетике
Mn${}_{3}$Al${}_{2}$Ge${}_{3}$O${}_{12}$: 
кружки~--- положение максимумов поглощения в эксперименте; линии~--- теоретический расчет}\label{YaRM}
\end{figure}

Комплексная огибающая сигнала линейной модуляции имеет вид:
\[x(t) = \sum c_n \, p(t-nT).\]
Каждый символ $c_n$ передается как амплитуда некоторого базового импульса $p(t)$. Форма импульса для всех символов одинакова (рис.~\ref{YaRM}),
отличие только во временном положении. Шаг $T$ следования импульсов и определяет бодовую скорость:~$R=1/T$.

\clearpage
