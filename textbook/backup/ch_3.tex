\section{Задачи повышенной сложности}
Как было показано ранее, множество одномерных задач из различных областей науки может быть сведено к последовательному решению линейных одномерных уравнений переноса.
Очевидно, что реальные практические задачи существенно не одномерны, заданы на сложных пространственных областях и т.д.
В настоящей главе покажем подход, который может быть применён для их решения.

Для простоты изложения будем рассматривать задачу двумерного переноса примеси в потоке жидкости.
Данный процесс описывается уравнением переноса вида:
\begin{equation}
\label{eq_advection_2d}
u_t + \lambda_x u_x  + \lambda_y u_y = 0.
\end{equation}

где $u(x,y,t)$ - искомая функция, $\left[ \begin{array}{c} \lambda_x \\ \lambda_y \end{array} \right]$ - вектор скорости переноса.
Для его решения используем подход расщепления по направлениям.
При этом решение исходного уравнения \ref{eq_advection_2d} заменяется последовательным решением двух уравнений (шаг X и шаг Y соответственно):
\begin{eqnarray}
\label{eq_advection_2d_split}
u_t + \lambda_x u_x = 0, \\
u_t + \lambda_y u_y = 0.
\end{eqnarray}

Каждое из уравнений \ref{eq_advection_2d_split} может быть решено любой из схем, построенных на расширенном шаблоне.
При этом, для шага Y входными данными будет являться распределение, полученное после выполнения шага X, и наоборот.
Отметим, что данный подход применим, как на квадратных, так и на параллелепипедных расчётных сетках.

\textbf{$\blacktriangle$ Задача 1.}
Реализуйте программу \textbf{Advection\_2D}, в которой бы моделировался процесс двумерного переноса схемами на расширенных шаблонах.
Проведите серию тестовых расчётов, как на гладком, так и на разрывном решении.
Какие особенности численного решения вы наблюдаете?

\textbf{$\blacktriangle$ Задача 2.}
По аналогии с двумерным случаем реализуйте решение трёхмерного уравнения линейного переноса с помощью подхода расщепления по направлениям в виде программы \textbf{Advection\_3D}.

Основным отличием способа построения одномерных компактных схем от схем на расширенном шаблоне является дополнительное хранение и пересчёт значений производной решения.
Попробуем использовать напрямую подход расщепления по направлениям.
На шаге X имеет одномерное уравнение переноса, которое следую методике построения продолженных схем дополняем дифференциальным следствием (производная по X):
\begin{equation}
\label{eq_advection_2d_x_ext}
\begin{cases}
u_t + \lambda_x u_x = 0, \\
(u_x)_t + \lambda_x (u_x)_x = 0.
\end{cases}
\end{equation}
Данная система может быть решена схемой 3-го или 5-го (возможно выше) порядка точности, после чего будут известны значения $u^{n+1/2}$ и $u^{n+1/2}_x$ на промежуточном временном слое.
На шаге по Y аналогично записываем решаемую систему уравнений в виде:
\begin{equation}
\label{eq_advection_2d_y_ext}
\begin{cases}
u_t + \lambda_y u_y = 0, \\
(u_y)_t + \lambda_y (u_y)_y = 0.
\end{cases}
\end{equation}
Но для её решения необходимо знание значений $u^{n+1/2}_y$!
При этом система \ref{eq_advection_2d_x_ext} может быть дополнена следствием:
\begin{equation}
\label{eq_advection_2d_uy}
(u_y)x + \lambda_x (u_y)_x = 0.
\end{equation}
Для его нахождения могут быть использованы два принципиально разных подхода:
\begin{enumerate}
\item{Решение уравнения переноса \ref{eq_advection_2d_uy} схемой первого порядка.}
\item{Дополнение системы \ref{eq_advection_2d_x_ext} ещё одним дифференциальным следствием
$(u_{xy})_t + \lambda_x (u_{xy})_x = 0$ и решение двух независимых продолженных систем уравнений компактной схемой.}
\end{enumerate}

\textbf{$\blacktriangle$ Задача 3.}
Реализуйте программу \textbf{Advection\_ext\_2D}, в которой бы моделировался процесс двумерного переноса компактными схемами.
Рассмотрите два случая: а) решение одной продолженной системы и использование схемы 1го порядка б) решение двух продолженных систем.
Проведите серию тестовых расчётов, как на гладком, так и на разрывном решении.
Оцените порядок сходимости построенных схем.
Проведите их сравнительный анализ, перечислите плюсы и минусы.

\textbf{$\blacktriangle$ Задача 4.}
Постройте компактные схемы для решения трёхмерного линейного уравнения переноса.
Какие варианты их построения возможны?
Какие их плюсы и минусы?
Попробуйте оценить порядок сходимости на гладком решении.
Что является лимитирующим фактором?

\begin{flushleft}

\begin {tabular}  {p{2.20cm}  p{8.30cm}}
{\bf\normalsize Теорема 4. }
&
\it{
В случае регулярности (существования и единственности) решения пары двойственных задач P --- D
справедливы соотношения
$$
\lim \limits_{\tau \to +0} \bar x(\tau, u) = x^{*}(u) , \quad
\lim \limits_{\tau \to +0} \bar \Lambda(\tau, u) = \Lambda^{*}(u) \; ,
$$
где $\bar x(\tau, u)$ и $\bar \Lambda(\tau, u)$ -- решения системы (15) при фиксированном $u$.%
}
\end {tabular}

\end{flushleft}



\noindent
\hbox{%
\color[gray]{0.85}{ \vrule width 4.0mm } \hspace{.5em} \color[rgb]{0,0,0} \parbox{0.9\textwidth}%
{{\bf Доказательство}

\medskip
\noindent
Функция Лагранжа задачи P в регулярном случае при фиксированном $u$ имеет единственную седловую точку $\{x^{*}(u),\Lambda^{*}(u)\}.$
Функция $U(\tau, x, \Lambda, u)$ всегда имеет единственную седловую точку при фиксированных $\tau,u$.
Тогда, в силу теоремы 3, получаем, что для регулярной исходной задачи P
$$
\lim \limits_{\tau \to +0} \bar x(\tau, u) = x^{*}(u) , \quad
\lim \limits_{\tau \to +0} \bar \Lambda(\tau, u) = \Lambda^{*}(u) \; .
$$

\medskip

\noindent
{\bf Теорема доказана.}}
}



\section{Свойства сглаженных аппроксимаций}
%\addcontentsline{toc}{section}{Свойства сглаженных аппроксимаций}

\noindent Рассмотрим теперь конкретные функции $Q (\tau, s)$, задающими правые части уравнений системы (15).
В таблице 1 приведены некоторые их виды, представляющие интерес с точки зрения вычислительной практики.

Тот факт, что
$-\frac{\displaystyle \partial P}{\displaystyle \partial s}$ является функцией только одного аргумента
$\frac{\displaystyle s}{\displaystyle \tau}$ (см. условие (6)), определяет специальный вид функции $Q(\tau,s),$
а именно,  $Q(\tau,s) = \tau \Psi(s).$
Действительно, функция $Q(\tau,s),$ как обратная к $-\frac{\displaystyle \partial P}{\displaystyle \partial s},$
определяется соотношением
$$
 -\Phi^{-1}(s)   = \frac{\displaystyle Q(\tau,s)}{\displaystyle \tau} \; ,
$$
где функции $\Psi$ и $\Phi$ взаимно обратные. Поэтому $Q(\tau,s)=\tau \Psi(s).$\pagebreak


\begin{center}
{Таблица 1. Примеры различных типов штрафных функций}
\end{center}
\begin{center}
\noindent
\begin{tabular} {||c|c|c|c||}
\hline
\hline
& & &  \\
$P(\tau,s)$ & $-\frac{\displaystyle \partial P}{\displaystyle \partial s}$ &
$Q(\tau,s)$ & $R(\tau,s)$ \\
& & &  \\
\hline
\hline
& & & \\
$\tau e^{-\cfrac{ s}{ \tau}}$ & $e^{-\cfrac{ s}{ \tau}}$ & $\tau \ln \cfrac{1}{s}$ &
$-\tau s \ln \frac{\displaystyle s}{\displaystyle e}$ \\
& & &  \\
\hline
& & &  \\
$-\tau \ln s$ & $\frac{\displaystyle \tau }{\displaystyle s }$ & $\frac{\displaystyle \tau }{\displaystyle s }$ & $\tau \ln s$ \\
& & & \\
\hline
& & &   \\
$
\parbox{2cm}{\scriptsize Через элемен- тарные функции выражает- ся, но громоздко }
$
&
$ \sqrt { \left( \frac{\displaystyle s }{\displaystyle \tau } \right)^2 {\displaystyle + 1} }
\;\; {\displaystyle -} \;\; \frac{\displaystyle s }{\displaystyle \tau }$
&
$\frac{\displaystyle \tau }{\displaystyle 2 }
\left (  \frac{\displaystyle 1 }{\displaystyle s } - s \right ) $ &
$-\frac{\displaystyle \tau }{\displaystyle 2 }
\left (  \frac{\displaystyle s^2 }{\displaystyle 2 } - \ln s \right ) $ \\
& & &  \\
\hline
& & &   \\
$\frac{\displaystyle \tau^2 }{\displaystyle s }$ & $ \left( \frac{\displaystyle \tau }{\displaystyle s } \right)^2$ &
$\frac{\displaystyle \tau }{\displaystyle \sqrt{s} }$& $2\tau\sqrt{s}$ \\
& & &  \\
\hline
& & &   \\
$\parbox{2cm}{\scriptsize Через элемен- тарные функции не выража- ется }$ &
$ \ln\left( 1 + e^{-\frac{\displaystyle s }{\displaystyle \tau }} \right) $ &
$\tau \ln \cfrac{1}{e^{\displaystyle s} - 1}$ & $\parbox{2cm}{\scriptsize Через элемен- тарные функции не выража- ется }$ \\
& & &  \\
\hline
\hline
\end{tabular}
\end{center}



\bigskip
Отметим, что в практических расчетах важен вид лишь функций $Q(\tau,s),$ входящих в условие системы (15).
Степень сложности остальных функций, приведенных в таблице 1, особой роли не играет.

Соотношения (11)--(12) гарантируют близость значений функций $\overline x (\tau, u)$ и $ \overline \Lambda (\tau, u)$
к значениям зависимостей $x^*(u)$ и $\lambda^*(u)$ там, где последние существуют и однозначны.

Кроме того,
функции $\overline x (\tau, u)$ и $ \overline \Lambda (\tau, u)$ определены и имеют положительные (в силу условий (6) и (13)) значения
{\it для любых} параметров $u$ (включая значения, при которых задачи P или D несовместны),
а также однозначны в точках переопределенности задач P или D.

Функции $\overline x (\tau, u)$ и $ \overline \Lambda (\tau, u)$ допускают аппроксимацию по формуле Тейлора,
поскольку к соотношениям (15) применима классическая теорема о неявных функциях \ref{s6}
при условии, что $Q(\tau,s)$ достаточно гладкая. Отметим, что для штрафных функций, приведенных в таблице~1,
порядок тейлоровской аппроксимации для $\overline x (\tau, u)$ и $ \overline \Lambda (\tau, u)$ может быть любым.


Как уже отмечалось, вообще говоря, не любые классы штрафных функций могут применяться в рассматриваемом подходе.
Во-первых, нельзя использовать {\it внешние} штрафные функции, например такие как:
$$
P(\tau,s) = \left\{
\begin{array} {rr}
0 \; , & \mbox{ при } s \ge 0 \; , \\
\cfrac{s^2}{2\tau} \; , & \mbox{ при } s < 0 \; , \\
\end{array}
\right.
$$
поскольку в этом случае $-\cfrac{\partial P}{\partial s}$ не имеют обратной функции.




\begin{figure}[tbph]
\centerline{\includegraphics[width=4in,height=2.5in]{pictures/RisU-L.jpg}}
\caption{График зависимости $U-L$ от $u$ для $\tau=0.1$ и $\tau=0.01$.}
\end{figure}\label{RisU-L.jpg}
\pagebreak

\begin{figure}[tbph]
\centerline{\includegraphics[width=4.4in,height=2.75in]{pictures/RisXTau=01.jpg}}
\caption{Зависимость решений системы~(15) в примере~1 от значения параметра $u$ для $\tau=0.1$.}\label{RisXTau=01}
%
\bigskip
\bigskip
%
\centerline{\includegraphics[width=4.4in,height=2.75in]{pictures/RisXTau=001.jpg}}
\caption{Зависимость решений системы~(15) в примере~1 от значения параметра $u$ для $\tau=0.01$.}\label{RisXTau=001}
\end{figure}




\clearpage
