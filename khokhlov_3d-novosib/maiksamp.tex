\documentclass[11pt]{article}
\usepackage{ucs}
\usepackage[T2A]{fontenc}
\usepackage[utf8x]{inputenc}
\usepackage[russian,english]{babel}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{epstopdf}
\usepackage{todonotes}
\usepackage{geometry}
\geometry{papersize={22.5 cm, 15.5 cm}}
\usepackage{algorithm}
\usepackage{algpseudocode}

\title{Компактные сеточно-характеристические схемы повышенного порядка точности для трёхмерного линейного уравнения переноса}

\date{}

\author{Голубев B.И., Хохлов Н.И., Петров И.Б.}

\begin{document}

\maketitle

\section{Введение}

Множество самых разнообразных физических явлений (движение взвеси частиц в жидкости, динамическая нагрузка упруго-пластических сред, процессы газовой динамики) могут быть математически описаны гиперболической системой уравнений \cite{Kholodov2008}.
Простейшим примером уравнения данного типа является линейное уравнение переноса.
Отметим, что получить аналитическое решение для большинства прикладных задач не представляется возможным.
В связи с этим активно развиваются разностные численные методы.

Поскольку численное решение приближается к истинному решению при измельчении расчётной сетки, актуальной задачей является повышение порядка аппроксимации схем.
Из распространённых подходов отметим следующие: расширение сеточного шаблона \cite{Rusanov1961}, использование комбинаций сеточных функций, полученных на разных сетках,
использование дифференциальных следствий начальных уравнений \cite{Khol2006}.
Схемы, построенные без расширения сеточного шаблона, принято называть компактными \cite{Tolstih1990}.
К их преимуществам можно отнести локальность, облегчающую формулирование граничных условий.

В работе \cite{Yabe1991} была предложена бикомпактная (на двухточечном шаблоне) схема третьего порядка, построенная с использованием интерполяционных полиномов.
В дальнейшем она была обобщена на многомерный случай \cite{Yabe2004}.
Отметим, однако, что указанная схема не является монотонной и приводит к нефизическим осцилляциям на разрывном решении.
Для преодоления данного недостатка в работе \cite{Khokhlov1D2014} были предложены две бикомпактные схемы (БИС1 и БИС2) для одномерного
линейного уравнения переноса, построенные на основе сеточно-характеристического метода \cite{Magometov-Kholodov-1969}.
На гладких решениях они демонстрируют, соответственно, второй и третий порядок сходимости, как по пространству, так и по времени.
При этом с использованием гибридизации решения \cite{petrov1984} на основе сеточно-характеристического критерия \cite{van1979} и на основе критерия,
основанного на поиске экстремума интерполяционного полинома на выбранном интервале, предложенного в работе \cite{Khokhlov1D2014},
удалось добиться отсутствия нефизических осцилляций и слабого размытия решения со временем.
В дальнейшем в работе \cite{Golubev2D2014} они были обобщены на двумерный случай с использованием подхода расщепления по направлениям с сохранением качественного поведения и порядка аппроксимации.

В данной работе проводится обобщение схем БИС1 и БИС2 на трёхмерный случай.
Используется подход расщепления по координатам, позволяющий свести задачу к последовательному решению одномерных задач.
В дальнейшем проводится дополнение начальных уравнений их дифференциальными следствиями, что позволяет использовать компактные схемы.
Отдельно исследуется вопрос о влиянии способа переноса ортогональной (дополнительной) производной на порядок сходимости итоговой схемы.
Предложены трёхмерные численные схемы, сохраняющие повышенный порядок сходимости на гладких решениях и отсутствие нефизических осцилляций на разрывном решении.

\section{Одномерное линейное уравнение переноса}

Рассмотрим простейшее одномерное линейное уравнение переноса:
\begin{equation}
\label{eq_advection}
u_t + \lambda u_x = 0.
\end{equation}

Будем полагать, что $\lambda = const > 0$,
поскольку для отрицательных $\lambda$ все построения аналогичны и могут быть осуществлены заменой $\lambda$ на $-\lambda$
и сеточного шаблона на симметричный по $x$ относительно рассчитываемой точки $(t^n, x_m)$.

Помимо уравнения (\ref{eq_advection}) также рассмотрим его дифференциальное следствие.
Введем в дополнение к $u(t, x)$ новую искомую функцию $\nu(t, x) = u_x(t, x)$ и продифференцировав уравнение (\ref{eq_advection}) по $x$
получим для $\nu(t, x)$ аналогичное уравнение переноса:
\begin{equation}
\label{eq_advection_ext}
\nu_t + \lambda \nu_x = 0.
\end{equation}

Построение продолженных разностных схем будем рассматривать на двухточечном шаблоне с пространственным шагом $h$ и временным шагом $\tau$:
\begin{equation}
\label{eq_stencil_3}
(t^n, x_{m-1}), (t^n, x_m), (t^{n+1}, x_m).
\end{equation}

Будем использовать систему координат, в которой точка $(t^n, x_m)$ имеет координаты $(0, 0)$,
а точка $(t^n, x_{m-1})$ -- $(0, -h)$ соответственно.
Рассмотрим на $(-h, 0)$ интерполяционные полиномы $f(x)$,
которые аппроксимирует функцию $u(x)$ на заданном интервале.
В дальнейшем индекс по времени будем опускать, где это возможно.
Решение уравнения (\ref{eq_advection}) на временном шаге $n+1$ может быть найдено как
$$
u^{n+1}_m = f(-\lambda\tau),
$$
а решение продолженной системы будет:
$$
\nu^{n+1}_m = f'(-\lambda\tau).
$$

На указанном шаблоне можно построить максимально полином третьей степени $F_3(x) = a_3x^3 + b_3x^2 + c_3x + d_3$.
Коэффициенты данного полинома могут быть найдены из значений $u_m, u_{m-1}, \nu_m, \nu_{m-1}$.
Дополнительно введём полиномы второй степени $F_{2l}(x)$ и $F_{2r}(x)$, коэффициенты в которых вычислены по значениям $u_{m-1}, u_m, \nu_{m-1}$ и $u_{m-1}, u_m, \nu_m$ соответственно.
Также рассмотрим полином первого порядка точности на рассматривамом шаблоне $F_1(x)$, коэффициенты которого находятся по значениям $u_m, u_{m-1}$.
Аппроксимация данным полиномом представляет собой схему первого порядка типа КИР (Куранта-Изаксона-Риса).
Обозначим данную схему как CIR.

Введём дополнительно необходимые обозначения:
$$
\nu_* = (u_m - u_{m-1}) / h,
$$
$$
\Delta_0 = |\nu_m - \nu_*|,
$$
$$
\Delta_1 = |\nu_{m-1} - \nu_*|,
$$
$$
x_0 = -\frac{b_3}{2a_3}.
$$

\subsection{Схема БИС1}

Cхема БИС1 (бикомпактная интерполяционная схема) основана на гибридизации по характеристическому критерию монотонности \cite{Khol2006, Magometov-Kholodov-1969}:
\begin{equation}
\label{eq_cond_gc}
min(u_m, u_{m-1}) \le u^{n+1}_m \le max(u_m, u_{m-1}).
\end{equation}

Значение $u^{n+1}_m$ последовательно вычисляется полиномами $F_3(x)$, $F_{2l}(x)$, $F_{2r}(x)$ и $F_1(x)$ до тех пор, пока не будет выполнен критерий монотонности.
В дальнейшем с использованием производной выбранного полинома вычисляется значение $\nu^{n+1}_m$.

\subsection{Схема БИС2}

Схема БИС2 строилась на основе анализа поведения интерполяционных полиномом на рассматриваемом интервале с целью
максимального повышения порядка.
Для краткости приведём непосредственно псевдокод расчётного алгоритма.

\begin{algorithm}
\begin{algorithmic}[1]
\If{$(\nu_m \nu_{m-1} \ge 0) \And (\nu_* \nu_m \ge 0)$}
\If{$(x_0 > -h) \And (x_0 < 0) \And (F'(x_0) \nu_* < 0)$}
\If{$min(\nu_m, \nu_{m-1}) \le \nu_* \le max(\nu_m, \nu_{m-1})$}
\State $u_m^{n+1}, \nu_m^{n+1} = F_1(x), F'_1(x)$
\Else
\If{$\Delta_0 > \Delta_1$}
\State $u_m^{n+1}, \nu_m^{n+1} = F_{2l}(x), F'_{2l}(x)$
\Else
\State $u_m^{n+1}, \nu_m^{n+1} = F_{2r}(x), F'_{2r}(x)$
\EndIf
\EndIf

\if 0
\algstore{bkbreak}
\end{algorithmic}
\end{algorithm}


\begin{algorithm}
\begin{algorithmic}[1]
\algrestore{bkbreak}

\fi

\Else
\State $u_m^{n+1}, \nu_m^{n+1} = F_3(x), F'_3(x)$
\EndIf
\ElsIf{$(\nu_m \nu_{m-1} \ge 0) \And (\nu_* \nu_m \le 0)$}
\State $u_m^{n+1},  \nu_m^{n+1} = F_1(x), F'_1(x)$
\Else
\If{$\Delta_0 > \Delta_1$}
\State $u_m^{n+1}, \nu_m^{n+1} = F_{2l}(x), F'_{2l}(x)$
\Else
\State $u_m^{n+1}, \nu_m^{n+1} = F_{2r}(x), F'_{2r}(x)$
\EndIf
\EndIf
\end{algorithmic}
\end{algorithm}

\if 0

\section{Двумерное линейное уравнение переноса}

Рассмотрим простейшее двумерное линейное уравнение переноса:
\begin{equation}
\label{eq_advection_2d}
u_t + \lambda_x u_x + \lambda_y u_y = 0
\end{equation}

и трёхточечный по пространству шаблон с пространственным шагом $h$ и временным шагом $\tau$:\begin{equation}
\label{eq_stencil_4}
(t^n, x_{i - 1}, y_j), (t^n, x_i, y_j), (t^n, x_i, y_{j - 1}), (t^{n + 1}, x_i, y_j).
\end{equation}

Будем полагать, что $\lambda_x = const > 0$ и $\lambda_y = const > 0$, поскольку для отрицательных $\lambda_x, \lambda_y$ все построения аналогичны и могут быть осуществлены заменой $\lambda_x, \lambda_y$ на $-\lambda_x, -\lambda_y$, соответственно, и сеточного шаблона на симметричный по $x, y$ относительно точки $(t^n, x_i, y_j)$.

На этапе построения разностных схем для решения уравнения (\ref{eq_advection_2d}) используем метод расщепления по координатам ($X$ и $Y$).
При этом примем связь между оператором перехода с текущего на следующий временной слой ($\hat{F_{2d}}$)
 и для отдельных шагов расщепления ($\hat{F_X}$, $\hat{F_Y}$) в виде:
\begin{equation}
\label{eq_operators}
\hat{F_{2d}} u^n_{i,j} = \hat{F_Y} \hat{F_X} u^n_{i,j}.
\end{equation}

Рассмотрим подробнее, например, шаг расщепления по $X$:
\begin{equation}
\label{eq_advection_x}
u_t + \lambda_x u_x = 0.
\end{equation}

Для удобства записи будем обозначать значения величин, полученные после данного шага, индексом $n + \frac{1}{2}$ по времени.
Дополним уравнение (\ref{eq_advection_x}) его следствием, получаемым дифференцированием по $x$ и введением дополнительной неизвестной функции $\nu(t, x, y) = \frac{\partial u(t, x, y)}{\partial x}$:
\begin{equation}
\label{eq_advection_x_ext}
\nu_t + \lambda_x \nu_x = 0.
\end{equation}

Отметим,что система (\ref{eq_advection_x} - \ref{eq_advection_x_ext}) является продолженной и может быть решена на рассматриваемом шаблоне с использованием одной из компактных схем (CIP, БИС1 или БИС2) \cite{Khokhlov_NEW} или схемой CIR \cite{Courant1952}.
Таким образом, могут быть вычислены значения $u^{n + \frac{1}{2}}_{i, j}$ и $\nu^{n + \frac{1}{2}}_{i, j}$.

Однако, на следующем шаге расщепления по $Y$ нам необходимо знать дополнительно значение $w^{n + \frac{1}{2}}_{i, j}$, где введено обозначение $w(t, x, y) = \frac{\partial u(t, x, y)}{\partial y}$. Аналогично, на шаге расщепления по $Y$ необходимо будет по той же процедуре вычислять значение $\nu^{n + 1}$.
Для краткости в дальнейшем будем называть $w$ и $\nu$ ортогональной (дополнительной) производной (по отношению к обычной частной производной $\nu$ и $w$ соответственно).
Авторами было предложено два различных способа вычисления её значения, существенно влияющих на порядок сходимости итоговой схемы.

\subsection{Перенос ортогональной (дополнительной) производной схемой CIR}

Дополним уравнение (\ref{eq_advection_x}) его следствием, получаемым дифференцированием по $y$:
\begin{equation}
\label{eq_advection_x_ort}
w_t + \lambda_x w_x = 0.
\end{equation}

Будем вычислять значение $w^{n + \frac{1}{2}}_{i, j}$ на шаге расщепления по $X$ решением уравнения (\ref{eq_advection_x_ort}) по схеме первого порядка сходимости по пространству CIR:
\begin{equation}
\label{eq_advection_x_ort_g}
w^{n + \frac{1}{2}}_{i, j} = w^{n}_{i, j} - \frac{\lambda_x\tau}{h}(w^{n}_{i, j} - w^{n}_{i - 1, j}).
\end{equation}

Полученные компактные двумерные сеточно-характеристические схемы назовём CIP-2D-1, БИС1-2D-1, БИС2-2D-1, соответственно, в зависимости от используемой компактной схемы для решения продолженной системы уравнений (\ref{eq_advection_x} - \ref{eq_advection_x_ext}) и аналогичной ей на шаге расщепления по $Y$.

\subsection{Перенос ортогональной (дополнительной) производной компактной схемой}

Введём в рассмотрение новую искомую функцию $p(t, x, y) = \frac{\partial^2 u(t, x, y)}{\partial x \partial y}$ и рассмотрим следствие уравнения (\ref{eq_advection_x_ort}), получаемое дифференцированием его по $x$:
\begin{equation}
\label{eq_advection_x_ort_ext}
p_t + \lambda_x p_x = 0.
\end{equation}

При таком подходе система уравнений (\ref{eq_advection_x_ort} - \ref{eq_advection_x_ort_ext}) является продолженной и может быть решена с использованием одной из компактных схем (CIP, БИС1 или БИС2).
Полученные компактные двумерные сеточно-характеристические схемы назовём CIP-2D-2, БИС1-2D-2, БИС2-2D-2, соответственно, в зависимости от используемой компактной схемы для решения продолженных систем уравнений (\ref{eq_advection_x} - \ref{eq_advection_x_ext}) и  (\ref{eq_advection_x_ort} - \ref{eq_advection_x_ort_ext}) и аналогичных им на шаге расщепления по $Y$.
Отметим, что в настоящей работе не исследовались двумерные схемы, которые могут быть получены при решении (\ref{eq_advection_x} - \ref{eq_advection_x_ext}) и  (\ref{eq_advection_x_ort} - \ref{eq_advection_x_ort_ext}) отличными друг от друга компактными схемами.

\subsection{Порядок сходимости и поведение на разрывном решении}

Тест на качественное поведение построенных двумерных разностных схем проводился с импульсом прямоугольной формы:
\begin{equation}
\label{eq_impulse_2d}
u(0, x, y) = 
\begin{cases}
1, & -0.5 \le x, y \le 0.5, \\
0, & \mbox{в противном случае}.
\end{cases}
\end{equation}

Использовалась сетка, состоящая из 20 узлов по каждой из координат и покрывающая область $[-1,1]\times[-1,1]$, с периодическими граничными условиями.
Решение представлено после 200 шагов разностной схемы, шаг по времени выбирался исходя из числа Куранта $0.2$.
Использовались значения параметров $\lambda_x = 1, \lambda_y = 0.5$.
Результаты для всех схем представлены на рис. \ref{img_impulse_2d}.

\begin{figure}[!h]
\begin{center}
\includegraphics[scale=0.8]{./images/fig1_2d.pdf}
\caption{
Вид переносимого импульса (\ref{eq_impulse_2d}) через 200 шагов разностной схемы.
а) -- CIP-2D-1; б) -- CIP-2D-2; в) -- БИС1-2D-1; г) -- БИС1-2D-2; д) -- БИС2-2D-1; е) -- БИС2-2D-2.
}
\label{img_impulse_2d}
\end{center}
\end{figure}

Также в таблице \ref{tab_convergence_nondiagonal_2d} приведены результаты тестирования сеточной сходимости рассмотренных схем.
В качестве начальных условий задавался импульс $u(0, x, y) = \sin^4(\pi x)\sin^4(\pi y)$ в области $[-1,1]\times[-1,1]$, и на границах области использовались периодические граничные условия.
При этом, если перенос ортогональной (дополнительной) производной в численной схеме осуществляется схемой CIR, то задавались начальные условия на частные производные искомой функции:
\begin{equation}
\label{eq_partial_derivatives}
\begin{cases}
\frac{\partial u}{\partial x} (0, x, y) = 4\pi\cos(\pi x)\sin^3(\pi x)\sin^4(\pi y), \\
\frac{\partial u}{\partial y} (0, x, y) = 4\pi\cos(\pi y)\sin^3(\pi y)\sin^4(\pi x).
\end{cases}
\end{equation}

При тестировании сходимости численных схем, использующих подход продолженных систем уравнений для переноса ортогональной (дополнительной) производной, дополнительно задавалось начальное условие на перекрёстную производную искомой функции:
\begin{equation}
\label{eq_cross_derivative}
\frac{\partial^2 u}{\partial y \partial x} (0, x, y) = 16\pi^2\cos(\pi x)\sin^3(\pi x)\cos(\pi y)\sin^3(\pi y).
\end{equation}


Согласно результатам расчётов, схема CIP-2D-1 обладает вторым порядком сходимости по нормам $L_1$ и $L_{\infty}$,
схема БИС1-2D-1 - полуторным порядком по норме $L_{\infty}$ и вторым по норме $L_1$, схема БИС2-2D-1 -
вторым порядком по нормам $L_1$ и $L_{\infty}$ вне зависимости от направления вектора потока.
Также, схема CIP-2D-2 обладает третьим порядком сходимости по нормам $L_1$ и $L_{\infty}$,
схема БИС1-2D-2 - полуторным порядком по норме $L_{\infty}$ и вторым с половиной по норме $L_1$, схема БИС2-2D-2 -
третьим порядком по нормам $L_1$ и $L_{\infty}$ вне зависимости от направления вектора потока.

\begin{table}
\caption {Сеточная сходимость. Вектор переноса (1, 0.5) направлен не вдоль диагонали ячеек сетки} \label{tab_convergence_nondiagonal_2d}
\bigskip
\input{table-2d.tex}
\end{table}

\fi

\section{Трёхмерное линейное уравнение переноса}

Рассмотрим простейшее трёхмерное линейное уравнение переноса:
\begin{equation}
\label{eq_advection_3d}
u_t + \lambda_x u_x + \lambda_y u_y + \lambda_z u_z = 0
\end{equation}

и четырёхточечный по пространству шаблон с пространственным шагом $h$ и временным шагом $\tau$:
\begin{equation}
\label{eq_stencil_4}
(t^n, x_{i - 1}, y_j, z_k), (t^n, x_i, y_{j - 1}, z_k), (t^n, x_i, y_j, z_{k - 1}), (t^n, x_i, y_j, z_k), (t^{n + 1}, x_i, y_j, z_k).
\end{equation}

Будем полагать, что $\lambda_x = const > 0$, $\lambda_y = const > 0$ и $\lambda_z = const > 0$, поскольку для отрицательных $\lambda_x, \lambda_y, \lambda_z$ все построения аналогичны и могут быть осуществлены заменой $\lambda_x, \lambda_y, \lambda_z$ на $-\lambda_x, -\lambda_y, -\lambda_z$, соответственно, и сеточного шаблона на симметричный по $x, y, z$ относительно точки $(t^n, x_i, y_j, z_k)$.

На этапе построения разностных схем для решения уравнения (\ref{eq_advection_3d}) используем метод расщепления по координатам ($X$, $Y$ и $Z$).
При этом примем связь между оператором перехода с текущего на следующий временной слой ($\hat{F_{3d}}$)
 и для отдельных шагов расщепления ($\hat{F_X}$, $\hat{F_Y}$, $\hat{F_Z}$) в виде:
\begin{equation}
\label{eq_operators}
\hat{F_{3d}} u^n_{i,j,k} = \hat{F_Z} \hat{F_Y} \hat{F_X} u^n_{i,j,k}.
\end{equation}

Рассмотрим подробнее, например, шаг расщепления по $X$:
\begin{equation}
\label{eq_advection_x}
u_t + \lambda_x u_x = 0.
\end{equation}

Для удобства записи будем обозначать значения величин, полученные после данного шага, индексом $n + \frac{1}{3}$ по времени, а после шага расшепления по $Y$ - индексом $n + \frac{2}{3}$.
Дополним уравнение (\ref{eq_advection_x}) его следствием, получаемым дифференцированием по $x$ и введением дополнительной неизвестной функции $\nu(t, x, y, z) = \frac{\partial u(t, x, y, z)}{\partial x}$:
\begin{equation}
\label{eq_advection_x_ext}
\nu_t + \lambda_x \nu_x = 0.
\end{equation}

Отметим,что система (\ref{eq_advection_x}, \ref{eq_advection_x_ext}) является продолженной и может быть решена на рассматриваемом шаблоне с использованием одной из компактных схем (CIP, БИС1 или БИС2) \cite{Khokhlov1D2014} или схемой CIR \cite{Courant1952}.
Таким образом, могут быть вычислены значения $u^{n + \frac{1}{3}}_{i, j, k}$ и $\nu^{n + \frac{1}{3}}_{i, j, k}$.

Однако, на следующем шаге расщепления по $Y$ нам необходимо знать дополнительно значение $w^{n + \frac{1}{3}}_{i, j, k}$, где введено обозначение $w(t, x, y, z) = \frac{\partial u(t, x, y, z)}{\partial y}$.
На шаге расщепления по $Z$ необходимо знать также значение $q^{n + \frac{2}{3}}_{i, j, k}$, где введено обозначение $q(t, x, y, z) = \frac{\partial u(t, x, y, z)}{\partial z}$.
Для краткости в дальнейшем будем называть первую производную по координате, не совпадающей с шагом расщепления, ортогональной (или дополнительной).
Так, например, на шаге расщепления по $X$ ортогональными являются две производные: $w$ и $q$.
Авторами было предложено два различных способа вычисления их значений, существенно влияющих на порядок сходимости итоговой схемы.

\subsection{Перенос ортогональных (дополнительных) производных схемой CIR}

Дополним уравнение (\ref{eq_advection_x}) его следствиями, получаемыми дифференцированием по $y$ и $z$:
\begin{eqnarray}
\label{eq_advection_x_ort_y}
w_t + \lambda_x w_x = 0, \\
\label{eq_advection_x_ort_z}
q_t + \lambda_x q_x = 0.
\end{eqnarray}

Будем вычислять значение $w^{n + \frac{1}{3}}_{i, j, k}$ на шаге расщепления по $X$ решением уравнения (\ref{eq_advection_x_ort_y}), а $q^{n + \frac{1}{3}}_{i, j, k}$ - уравнения (\ref{eq_advection_x_ort_z}) по схеме первого порядка сходимости по пространству CIR:
\begin{eqnarray}
\label{eq_advection_x_ort_y_g}
w^{n + \frac{1}{3}}_{i, j, k} = w^{n}_{i, j, k} - \frac{\lambda_x\tau}{h}(w^{n}_{i, j, k} - w^{n}_{i - 1, j, k}), \\
\label{eq_advection_x_ort_z_g}
q^{n + \frac{1}{3}}_{i, j, k} = q^{n}_{i, j, k} - \frac{\lambda_x\tau}{h}(q^{n}_{i, j, k} - q^{n}_{i - 1, j, k}).
\end{eqnarray}

Полученные компактные трёхмерные сеточно-характеристические схемы назовём CIP-3D-1, БИС1-3D-1, БИС2-3D-1, соответственно, в зависимости от используемой компактной схемы для решения продолженной системы уравнений (\ref{eq_advection_x}, \ref{eq_advection_x_ext}) и аналогичной ей на шагах расщепления по $Y$ и $Z$.

\subsection{Перенос ортогональных (дополнительных) производных компактной схемой}

Введём в рассмотрение новую искомую функцию $p(t, x, y, z) = \frac{\partial^2 u(t, x, y, z)}{\partial x \partial y}$ и рассмотрим следствие уравнения (\ref{eq_advection_x_ort_y}), получаемое дифференцированием его по $x$:
\begin{equation}
\label{eq_advection_y_ext}
p_t + \lambda_x p_x = 0.
\end{equation}

При таком подходе система уравнений (\ref{eq_advection_x_ort_y}, \ref{eq_advection_y_ext}) также является продолженной.
Расширим пространство искомых функций введением $r(t, x, y, z) = \frac{\partial^2 u(t, x, y, z)}{\partial  x \partial z}$ и рассмотрим следствие уравнения (\ref{eq_advection_x_ort_z}), получаемое дифференцированием его по $x$:
\begin{equation}
\label{eq_advection_z_ext}
r_t + \lambda_x r_x = 0.
\end{equation}

При таком подходе система уравнений (\ref{eq_advection_x_ort_z}, \ref{eq_advection_z_ext}) также является продолженной.
Вводя новые искомые функции $s(t, x, y, z) = \frac{\partial^2 u(t, x, y, z)}{\partial y \partial z}$ и $g(t, x, y, z) = \frac{\partial^3 u(t, x, y, z)}{\partial x \partial y \partial z}$ и дифференцируя уравнение (\ref{eq_advection_x_ort_y}) сначала по $z$, а потом по $x$, получим ещё одну продолженную систему уравнений:
\begin{eqnarray}
\label{eq_advection_x_add_yz}
s_t + \lambda_x s_x = 0, \\
\label{eq_advection_x_add_xyz}
g_t + \lambda_x g_x = 0.
\end{eqnarray}

Каждая из трёх записанных систем на шаге расщепления по $X$ может быть решена с использованием одной из компактных схем (CIP, БИС1 или БИС2).
Таким образом, могут быть вычислены значения всех величин $u, u_x, u_y, u_z, u_{xy}, u_{xz}, u_{xyz}$ на слое $n + \frac{1}{3}$.
На шаге расщепления по $Y$ и по $Z$ выражения для вычисления значений на слое $n + \frac{2}{3}$ и $n + 1$ строятся полностью аналогично вышеизложенному.
Полученные компактные трёхмерные сеточно-характеристические схемы назовём CIP-3D-2, БИС1-3D-2, БИС2-3D-2, соответственно, в зависимости от используемой компактной схемы для решения продолженных систем уравнений.
Отметим, что в настоящей работе не исследовались трёхмерные схемы, которые могут быть получены при решении систем (\ref{eq_advection_x}, \ref{eq_advection_x_ext}),  (\ref{eq_advection_x_ort_y}, \ref{eq_advection_y_ext}), (\ref{eq_advection_x_ort_z}, \ref{eq_advection_z_ext}) и (\ref{eq_advection_x_add_yz}, \ref{eq_advection_x_add_xyz}) отличными друг от друга компактными схемами.

\subsection{Порядок сходимости и поведение на разрывном решении}

Тест на качественное поведение построенных трёхмерных разностных схем проводился с импульсом прямоугольной формы:
\begin{equation}
\label{eq_impulse_3d}
u(0, x, y, z) = 
\begin{cases}
1, & -0.5 \le x, y, z \le 0.5, \\
0, & \mbox{в противном случае}.
\end{cases}
\end{equation}

Использовалась сетка, состоящая из 20 узлов по каждой из координат и покрывающая область $[-1,1]\times[-1,1]\times[-1,1]$, с периодическими граничными условиями.
Решение представлено после 100 шагов разностной схемы, шаг по времени выбирался исходя из числа Куранта $0.6$.
Использовались значения параметров $\lambda_x = 1, \lambda_y = 2, \lambda_z = 3$.
Результаты для всех схем (сечение области расчёта вдоль главной диагонали) представлены на рис. \ref{img_impulse_3d}.

\begin{figure}[!h]
\begin{center}
\includegraphics[scale=0.7]{./images/fig1_3d.pdf}
\caption{
Вид переносимого импульса (\ref{eq_impulse_3d}) через 100 шагов разностной схемы.
а) -- CIP-3D-1; б) -- CIP-3D-2; в) -- БИС1-3D-1; г) -- БИС1-3D-2; д) -- БИС2-3D-1; е) -- БИС2-3D-2.
Сплошной линией на всех графиках представлено аналитическое решение.
}
\label{img_impulse_3d}
\end{center}
\end{figure}

В таблице \ref{tab_convergence_nondiagonal_3d} приведены результаты тестирования сеточной сходимости рассмотренных схем.
Использовались следующие нормы: $L_1 = \sum\limits_{i, j, k} |u_{i, j, k}|h^3$, $L_{\infty} = max |u_{i, j,k}|$.
В качестве начальных условий задавался импульс $u(0, x, y, z) = \sin^4(\pi x)\sin^4(\pi y)\sin^4(\pi z)$ в области $[-1,1]\times[-1,1]\times[-1,1]$, и на границах области использовались периодические граничные условия.
При этом, если перенос ортогональных (дополнительных) производных в численной схеме осуществлялся схемой CIR, то задавались начальные условия на частные производные $\frac{\partial u}{\partial x}, \frac{\partial u}{\partial y}, \frac{\partial u}{\partial z}$ искомой функции, вычисленные аналитически.
При тестировании сходимости численных схем, использующих подход продолженных систем уравнений для переноса ортогональных (дополнительных) производных, дополнительно задавались начальные условия на следующие производные искомой функции: $\frac{\partial^2 u}{\partial x \partial y}, \frac{\partial^2 u}{\partial x \partial z}, \frac{\partial^2 u}{\partial y \partial z}, \frac{\partial^3 u}{\partial x \partial y \partial z}$, вычисленные аналитически.

Поскольку вычислительная сложность задачи получилась высокой, и не представлялось возможным провести расчёт на персональном компьютере за приемлемое время, была проведена параллелизация расчётного алгоритма с использованием технологии MPI, и все расчёты проводились на кластере Информационно-вычислительного центра Новосибирского государственного университета \href{http://www.nusc.ru/}{http://www.nusc.ru/}.

\begin{table}
\caption {Сеточная сходимость. Вектор переноса (1, 2, 3) направлен не вдоль диагонали ячеек сетки} \label{tab_convergence_nondiagonal_3d}
\bigskip
\input{table-3d.tex}
\end{table}

\section{Заключение}

В работе рассмотрена задача численного решения трёхмерного линейного уравнения переноса на прямоугольных расчётных сетках.
На основе метода расщепления по координатам решение исходной системы уравнений сведено к последовательному решению
трёх одномерных систем уравнений.
Проведено расширение одномерных систем уравнений их дифференциальными следствиями с получение набора продолженных систем уравнений.
Для их решения используются явные компактные сеточно-характеристические численные схемы на двухточечном по пространству шаблону.

Проведено обобщение схем CIP, БИС1 и БИС2 на трёхмерный случай.
Численное исследование порядка сходимости построенных схем на гладком решении показало его сохранение схемами
CIP-3D-2, БИС1-3D-2 и БИС2-3D-2.
При переносе ортогональных (дополнительных) производных схемой первого порядка точности порядок схем снижается до второго.

\begin{thebibliography}{99}

\bibitem{Kholodov2008}
Холодов А. C. Энциклопедия низкотемпературной плазмы. Т. VII-1. Ч. 2. Янус-К, Москва, 2008. 658 с.

\bibitem{Rusanov1961}
Rusanov V. Calculation of intersection of non-steady shock waves with obstacles // J. Comput. Math. Phys. USSR, 1961. V. 1. p. 267--279.

\bibitem{Khol2006}
Холодов А. С., Холодов Я. А. О критериях монотонности разностных схем для уравнений гиперболического типа // Журнал вычислительной математики и математическкой физики, 2006. Т. 46, № 9. с. 1638--1667.

\bibitem{Tolstih1990}
Толстых А. И. Компактные разностные схемы и их применение в задачах аэрогидродинамики. Наука, Москва, 1990. 230 с.

\bibitem{Yabe1991}
Yabe Takashi and Aoki, Takayuki and Sakaguchi, Gyo and Wang, PY and Ishikawa, Takeo The compact CIP (Cubic-Interpolated Pseudo-particle) method as a general hyperbolic solver // Computers \& Fluids, 1991. V. 19, I. 3--4. p. 421--431.

\bibitem{Yabe2004}
Yabe, Takashi and Mizoe, Hiroki and Takizawa, Kenji and Moriki, Hiroshi and Im, Hyo-Nam and Ogata, Youichi  Higher-order schemes with CIP method and adaptive Soroban grid towards mesh-free scheme // Journal of Computational Physics, 2004. V. 194, I. 1. p. 57--77.

\bibitem{Khokhlov1D2014}
Петров И. Б., Хохлов Н. И. Компактная сеточно-характеристическая схема для линейного уравнения переноса // Сб. научн. тр. "Моделирование процессов обработки информации" - М.: МФТИ, 2014. с. 18--22.

\bibitem{Magometov-Kholodov-1969}
Магометов К. М., Холодов, А. С. О построении разностных схем для уравнений гиперболического типа на основе характеристических соотношений // Журнал вычислительной математики и математическкой физики, 1969. Т. 9, № 2. с. 373--386.

\bibitem{petrov1984}
Петров И. Б., Холодов А. С. О регуляризации разрывных численных решений уравнений гиперболического типа // Журнал вычислительной математики и математической физики, 1984. Т. 24, №. 8. с. 1172--1188.

\bibitem{van1979}
Van Leer, Bram Towards the ultimate conservative difference scheme. V. A second-order sequel to Godunov's method // Journal of computational Physics, 1979. V.32, I. 1. P. 101--136.

\bibitem{Golubev2D2014}
Голубев В. И., Петров И. Б., Хохлов Н. И. Обобщение компактной схемы для линейного уравнения переноса на двумерный случай // Сб. научн. тр. "Моделирование процессов обработки информации" - М.: МФТИ, 2014. с. 23--26.

\bibitem{Courant1952}
Courant R., Isaacson E., Rees, M. On the solutions of nonlinear hyperbolic differential eqations by finite differences // Communications on Pure and Applied Mathematics, 1952. V. 5, I. 5. p. 243--254.

\end{thebibliography}

\section {Приложения}

\subsection {Название на русском и английском языках}

Компактные сеточно-характеристические схемы повышенного порядка точности для трёхмерного линейного уравнения переноса

Compact grid-characteristic schemes of higher orders for 3D linear transport equation

\subsection {Аннотации на русском и английском языках}
В работе рассматривается численное решение трёхмерного линейного уравнения переноса на параллелепипедных расчётных сетках.
С использованием подхода расщепления по координатам проведено обобщение компактных сеточно-характеристических схем повышенного порядка точности на трёхмерный случай.
Исследуется влияние отдельных шагов вычислительного алгоритма на точность итоговой схемы.
Предложен подход, позволяющий сохранить порядок сходимости схемы на гладком решении и минимизировать нефизические осцилляции на разрывном решении в трёхмерном случае.

In this paper a numerical solution of 3D linear transport equation on parallelepiped grids is described.
With the usage of split along coordinate axis technique compact grid-characteristic schemes of higher orders were generalized up to 3D case.
The influence of separate steps of the algorithm on the precision of the final sheme was estimated.
The approach for preserving the convergence order of scheme on smooth solution and minimize unphysical oscillations on discontinuous solution in 3D was proposed.

\subsection {Ключевые слова и фразы на русском и английском языках}

компактные схемы, численный сеточно-характеристический метод, уравнение переноса, компьютерное моделирование

compact schemes, numerical grid-characteristic method, transport equation, computer simulation

\subsection {Код классификации УДК}

УДК 519.63

\subsection {Полная информация об авторах}

Голубев Василий Иванович, 8-926-4572707, w.golubev@mail.ru, г. Долгопрудный, Институтский пер., д. 9, лаборатория прикладной вычислительной геофизики.

Хохлов Николай Игоревич, 8-916-0105212, k\_h@inbox.ru, г. Долгопрудный, Институтский пер., д. 9, лаборатория прикладной вычислительной геофизики.

Петров Игорь Борисович, 8-903-6810022, petrov@mipt.ru, г. Долгопрудный, Институтский пер., д. 9, лаборатория прикладной вычислительной геофизики.

\end{document}
