\documentclass[11pt]{article}
\usepackage{ucs}
\usepackage[T2A]{fontenc}
\usepackage[utf8x]{inputenc}
\usepackage[russian,english]{babel}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{hyperref}
\usepackage{epstopdf}
\usepackage{todonotes}
\usepackage{geometry}
\geometry{papersize={22.5 cm, 15.5 cm}}
\usepackage{algorithm}
\usepackage{algpseudocode}

\title{Компактные сеточно-характеристические схемы повышенного порядка точности для многомерного линейного уравнения переноса}

\date{}

\author{Голубев B.И., Хохлов Н.И., Петров И.Б.}

\begin{document}

\maketitle

\section{Введение}

Множество самых разнообразных физических явлений (движение взвеси частиц в жидкости, динамическая нагрузка упруго-пластических сред, процессы газовой динамики) могут быть математически описаны гиперболической системой уравнений \cite{Kholodov2008}.
Простейшим примером гиперболического уравнения является уравнение переноса, к решению которого в общем случае может быть сведено решение гиперболической системы уравнений \cite{Magometov-Kholodov-1969, Yanenko1978}.
Отметим, однако, что получить аналитическое решение для большинства прикладных задач не представляется возможным.
В связи с этим активно развиваются численные методы, например, разностные.

Поскольку численное решение приближается к истинному решению при измельчении расчётной сетки, актуальной задачей является повышение порядка аппроксимации схем.
Из распространённых подходов отметим следующие: расширение сеточного шаблона \cite{Rusanov1961}, использование комбинаций сеточных функций, полученных на разных сетках,
использование дифференциальных следствий начальных уравнений \cite{Courant1949, Khol2006, Grudn1977, Yanenko1978, Petuhov1964}.
Схемы, построенные с использованием последнего подхода, принято называть компактными \cite{Tolstih1990}.
К их преимуществам можно отнести локальность шаблона, облегчающую формулирование граничных условий.

Компактные схемы третьего и более высокого порядков на трёхточечном шаблоне представлены в работе \cite{Tolstih1990}, на двухточечном шаблоне четвёртого порядка - в работах \cite{Rogov2011} (подход введения пространственной первообразной функции в качестве дополнительной искомой функции) и \cite{Khol2006} (подход последовательного решения дифференциального следствия и исходной системы).

В работе \cite{Yabe1991} была предложена бикомпактная \cite{Kalitkin2008} схема третьего порядка, построенная с использованием интерполяционных полиномов
на двухточечном шаблоне.
В дальнейшем она была обобщена на многомерный случай \cite{Yabe2004}.
Отметим, однако, что указанная схема не является монотонной и приводит к нефизическим осцилляциям на разрывном решении.
Для преодоления данного недостатка в работе \cite{Khokhlov1D2014} были предложены две компактные схемы (БИС-1 и БИС-2) для одномерного
линейного уравнения переноса, построенные на основе сеточно-характеристического метода \cite{Magometov-Kholodov-1969, Kholodov1990}.
На гладких решениях они демонстрируют, соответственно, второй и третий порядок сходимости, как по пространству, так и по времени.
При этом с использованием гибридизации решения \cite{petrov1984} на основе сеточно-характеристического критерия \cite{van1979} и на основе критерия,
основанного на поиске экстремума интерполяционного полинома на выбранном интервале, предложенного в работе \cite{Khokhlov1D2014},
удалось добиться отсутствия нефизических осцилляций и слабого размытия решения со временем.
В дальнейшем в работе \cite{Golubev2D2014} они были обобщены на двумерный случай с использованием подхода расщепления по направлениям с сохранением качественного поведения и порядка аппроксимации.

В данной работе проводится обобщение бикомпактных сеточно-характеристических схем для линейного одномерного уравнения переноса на двумерный и трёхмерный случай.
Используется подход расщепления по координатам, позволяющий свести задачу к последовательному решению одномерных задач.
В дальнейшем проводится дополнение начальных уравнений их дифференциальными следствиями, что позволяет использовать схемы БИС1 и БИС2 на данном этапе.
Отдельно исследуется вопрос о влиянии способа переноса ортогональной (дополнительной) производной на порядок сходимости итоговой схемы.
Предложены трёхмерные численные схемы, сохраняющие повышенный порядок сходимости на гладких решениях и отсутствие нефизических осцилляций на разрывном решении.

\section{Одномерное линейное уравнение переноса}

Рассмотрим простейшее одномерное линейное уравнение переноса:
\begin{equation}
\label{eq_advection}
u_t + \lambda u_x = 0.
\end{equation}

Будем полагать, что $\lambda = const > 0$,
поскольку для отрицательных $\lambda$ все построения аналогичны и могут быть осуществлены заменой $\lambda$ на $-\lambda$
и сеточного шаблона на симметричный по $x$ относительно рассчитываемой точки $(t^n, x_m)$.

Помимо уравнения (\ref{eq_advection}) также рассмотрим его дифференциальное следствие.
Введем в дополнение к $u(t, x)$ новую искомую функцию $\nu(t, x) = u_x(t, x)$ и продифференцировав уравнение (\ref{eq_advection}) по $x$
получим для $\nu(t, x)$ аналогичное уравнение переноса:
\begin{equation}
\label{eq_advection_ext}
\nu_t + \lambda \nu_x = 0.
\end{equation}

Построение продолженных разностных схем будем рассматривать на двухточечном шаблоне с пространственным шагом $h$ и временным шагом $\tau$:
\begin{equation}
\label{eq_stencil_3}
(t^n, x_{m-1}), (t^n, x_m), (t^{n+1}, x_m).
\end{equation}

Будем использовать систему координат, в которой точка $(t^n, x_m)$ имеет координаты $(0, 0)$,
а точка $(t^n, x_{m-1})$ -- $(0, -h)$ соответственно.
Рассмотрим на $(-h, 0)$ интерполяционные полиномы $f(x)$,
которые аппроксимирует функцию $u(x)$ на заданном интервале.
В дальнейшем индекс по времени будем опускать, где это возможно.
Решение уравнения (\ref{eq_advection}) на временном шаге $n+1$ может быть найдено как
$$
u^{n+1}_m = f(-\lambda\tau),
$$
а решение продолженной системы будет:
$$
\nu^{n+1}_m = f'(-\lambda\tau).
$$

На указанном шаблоне можно построить максимально полином третьей степени $F_3(x)$.
Коэффициенты данного полинома могут быть найдены из значений $u_m, u_{m-1}, \nu_m, \nu_{m-1}$.
Дополнительно введём полиномы второй степени $F_{2l}(x)$ и $F_{2r}(x)$, коэффициенты в которых вычислены по значениям $u_{m-1}, u_m, \nu_{m-1}$ и $u_{m-1}, u_m, \nu_m$ соответственно.

Также рассмотрим полином первого порядка точности на рассматривамом шаблоне
\begin{equation}
\label{eq_poly_f1}
F_1(x) = a_1 x + b_1.
\end{equation}
Исходя из условий на границах интервала
$$
F_1(0) = u_m, F_1(-h) = u_{m-1}
$$
находим коэффициенты полинома.
Аппроксимация данным полиномом представляет собой схему первого порядка типа КИР (Куранта-Изаксона-Риса).
Обозначим данную схему как CIR.

Введём дополнительно необходимые обозначения.
$$
\nu_* = a_1 = (u_m - u_{m-1}) /h
$$

Знаки $\nu_*, \nu_m$ и $\nu_{m-1}$ совпадают, т. е. выполнены условия:
\begin{equation}
\label{eq_cond_1}
\begin{array}{l}
\nu_m \nu_{m-1} \ge 0, \\
\nu_* \nu_m \ge 0.
\end{array}
\end{equation}

В работе \cite{Khokhlov1D2014} были предложены две компактные схемы (БИС-1 и БИС-2) для одномерного
линейного уравнения переноса, построенные на основе сеточно-характеристического метода.
Рассмотрим каждую их них подробнее.

\subsection{Схема БИС1}

Cхема БИС1 (бикомпактная интерполяционная схема) основана на гибридизации по характеристическому критерию монотонности \cite{Khol2006, Magometov-Kholodov-1969}:
\begin{equation}
\label{eq_cond_gc}
min(u_m, u_{m-1}) \le u^{n+1}_m \le max(u_m, u_{m-1}).
\end{equation}

Значение $u^{n+1}_m$ последовательно вычисляется полиномами $F_3(x)$, $F_{2l}(x)$, $F_{2r}(x)$ и $F_1(x)$ до тех пор, пока не будет выполнен критерий монотонности.
В дальнейшем с использованием производной выбранного полинома вычисляется значение $\nu^{n+1}_m$.

\subsection{Схема БИС2}

Схема БИС2 строилась следующим образом.
\if 0
Если выполнены условия (\ref{eq_cond_1}) и (\ref{eq_cond_2}), то используется схема второго порядка исходя из (\ref{eq_cond_4}).
Если выполнено (\ref{eq_cond_1}), но не выполнено (\ref{eq_cond_2}), то используется схема третьего порядка (\ref{eq_poly_f3}).
Если выполнено условие (\ref{eq_cond_3}), то используется полином первого порядка (\ref{eq_poly_f1}).
В случае выполнения условия (\ref{eq_cond_5}) используются полиномы второго порядка, исходя из (\ref{eq_cond_4}).
Наконец, при выполнении условия (\ref{eq_cond_6}) используется полином первого порядка (\ref{eq_poly_f1}).

\fi

\todo{Explain fm in formulas}

\begin{algorithm}
\begin{algorithmic}[1]
\If{$(\nu_m \nu_{m-1} \ge 0) \And (\nu_* \nu_m \ge 0)$}
\If{$(x_0 > -h) \And (x_0 < 0) \And (f_m \nu_* < 0)$}
\If{$min(\nu_m, \nu_{m-1}) \le \nu_* \le max(\nu_m, \nu_{m-1})$}
\State $u_m^{n+1}, \nu_m^{n+1} = F_1(x), F'_1(x)$
\Else
\If{$\Delta_0 > \Delta_1$}
\State $u_m^{n+1}, \nu_m^{n+1} = F_{2l}(x), F'_{2l}(x)$
\Else
\State $u_m^{n+1}, \nu_m^{n+1} = F_{2r}(x), F'_{2r}(x)$
\EndIf
\EndIf
\Else
\State $u_m^{n+1}, \nu_m^{n+1} = F_3(x), F'_3(x)$
\EndIf
\ElsIf{$(\nu_m \nu_{m-1} \ge 0) \And (\nu_* \nu_m \le 0)$}
\State $u_m^{n+1},  \nu_m^{n+1} = F_1(x), F'_1(x)$
\Else
\If{$\Delta_0 > \Delta_1$}
\State $u_m^{n+1}, \nu_m^{n+1} = F_{2l}(x), F'_{2l}(x)$
\Else
\State $u_m^{n+1}, \nu_m^{n+1} = F_{2r}(x), F'_{2r}(x)$
\EndIf
\EndIf
\end{algorithmic}
\end{algorithm}

\section{Двумерное линейное уравнение переноса}

Рассмотрим простейшее двумерное линейное уравнение переноса:
\begin{equation}
\label{eq_advection_2d}
u_t + \lambda_x u_x + \lambda_y u_y = 0
\end{equation}

и трёхточечный по пространству шаблон с пространственным шагом $h$ и временным шагом $\tau$:\begin{equation}
\label{eq_stencil_4}
(t^n, x_{i - 1}, y_j), (t^n, x_i, y_j), (t^n, x_i, y_{j - 1}), (t^{n + 1}, x_i, y_j).
\end{equation}

Будем полагать, что $\lambda_x = const > 0$ и $\lambda_y = const > 0$, поскольку для отрицательных $\lambda_x, \lambda_y$ все построения аналогичны и могут быть осуществлены заменой $\lambda_x, \lambda_y$ на $-\lambda_x, -\lambda_y$, соответственно, и сеточного шаблона на симметричный по $x, y$ относительно точки $(t^n, x_i, y_j)$.

На этапе построения разностных схем для решения уравнения (\ref{eq_advection_2d}) используем метод расщепления по координатам ($X$ и $Y$).
При этом примем связь между оператором перехода с текущего на следующий временной слой ($\hat{F_{2d}}$)
 и для отдельных шагов расщепления ($\hat{F_X}$, $\hat{F_Y}$) в виде:
\begin{equation}
\label{eq_operators}
\hat{F_{2d}} u^n_{i,j} = \hat{F_Y} \hat{F_X} u^n_{i,j}.
\end{equation}

Рассмотрим подробнее, например, шаг расщепления по $X$:
\begin{equation}
\label{eq_advection_x}
u_t + \lambda_x u_x = 0.
\end{equation}

Для удобства записи будем обозначать значения величин, полученные после данного шага, индексом $n + \frac{1}{2}$ по времени.
Дополним уравнение (\ref{eq_advection_x}) его следствием, получаемым дифференцированием по $x$ и введением дополнительной неизвестной функции $\nu(t, x, y) = \frac{\partial u(t, x, y)}{\partial x}$:
\begin{equation}
\label{eq_advection_x_ext}
\nu_t + \lambda_x \nu_x = 0.
\end{equation}

Отметим,что система (\ref{eq_advection_x} - \ref{eq_advection_x_ext}) является продолженной и может быть решена на рассматриваемом шаблоне с использованием одной из компактных схем (CIP, БИС1 или БИС2) \cite{Khokhlov_NEW} или схемой CIR \cite{Courant1952}.
Таким образом, могут быть вычислены значения $u^{n + \frac{1}{2}}_{i, j}$ и $\nu^{n + \frac{1}{2}}_{i, j}$.

Однако, на следующем шаге расщепления по $Y$ нам необходимо знать дополнительно значение $w^{n + \frac{1}{2}}_{i, j}$, где введено обозначение $w(t, x, y) = \frac{\partial u(t, x, y)}{\partial y}$. Аналогично, на шаге расщепления по $Y$ необходимо будет по той же процедуре вычислять значение $\nu^{n + 1}$.
Для краткости в дальнейшем будем называть $w$ и $\nu$ ортогональной (дополнительной) производной (по отношению к обычной частной производной $\nu$ и $w$ соответственно).
Авторами было предложено два различных способа вычисления её значения, существенно влияющих на порядок сходимости итоговой схемы.

\subsection{Перенос ортогональной (дополнительной) производной схемой CIR}

Дополним уравнение (\ref{eq_advection_x}) его следствием, получаемым дифференцированием по $y$:
\begin{equation}
\label{eq_advection_x_ort}
w_t + \lambda_x w_x = 0.
\end{equation}

Будем вычислять значение $w^{n + \frac{1}{2}}_{i, j}$ на шаге расщепления по $X$ решением уравнения (\ref{eq_advection_x_ort}) по схеме первого порядка сходимости по пространству CIR:
\begin{equation}
\label{eq_advection_x_ort_g}
w^{n + \frac{1}{2}}_{i, j} = w^{n}_{i, j} - \frac{\lambda_x\tau}{h}(w^{n}_{i, j} - w^{n}_{i - 1, j}).
\end{equation}

Полученные компактные двумерные сеточно-характеристические схемы назовём CIP-2D-1, БИС1-2D-1, БИС2-2D-1, соответственно, в зависимости от используемой компактной схемы для решения продолженной системы уравнений (\ref{eq_advection_x} - \ref{eq_advection_x_ext}) и аналогичной ей на шаге расщепления по $Y$.

\subsection{Перенос ортогональной (дополнительной) производной компактной схемой}

Введём в рассмотрение новую искомую функцию $p(t, x, y) = \frac{\partial^2 u(t, x, y)}{\partial x \partial y}$ и рассмотрим следствие уравнения (\ref{eq_advection_x_ort}), получаемое дифференцированием его по $x$:
\begin{equation}
\label{eq_advection_x_ort_ext}
p_t + \lambda_x p_x = 0.
\end{equation}

При таком подходе система уравнений (\ref{eq_advection_x_ort} - \ref{eq_advection_x_ort_ext}) является продолженной и может быть решена с использованием одной из компактных схем (CIP, БИС1 или БИС2).
Полученные компактные двумерные сеточно-характеристические схемы назовём CIP-2D-2, БИС1-2D-2, БИС2-2D-2, соответственно, в зависимости от используемой компактной схемы для решения продолженных систем уравнений (\ref{eq_advection_x} - \ref{eq_advection_x_ext}) и  (\ref{eq_advection_x_ort} - \ref{eq_advection_x_ort_ext}) и аналогичных им на шаге расщепления по $Y$.
Отметим, что в настоящей работе не исследовались двумерные схемы, которые могут быть получены при решении (\ref{eq_advection_x} - \ref{eq_advection_x_ext}) и  (\ref{eq_advection_x_ort} - \ref{eq_advection_x_ort_ext}) отличными друг от друга компактными схемами.

\subsection{Порядок сходимости и поведение на разрывном решении}

Тест на качественное поведение построенных двумерных разностных схем проводился с импульсом прямоугольной формы:
\begin{equation}
\label{eq_impulse_2d}
u(0, x, y) = 
\begin{cases}
1, & -0.5 \le x, y \le 0.5, \\
0, & \mbox{в противном случае}.
\end{cases}
\end{equation}

Использовалась сетка, состоящая из 20 узлов по каждой из координат и покрывающая область $[-1,1]\times[-1,1]$, с периодическими граничными условиями.
Решение представлено после 200 шагов разностной схемы, шаг по времени выбирался исходя из числа Куранта $0.2$.
Использовались значения параметров $\lambda_x = 1, \lambda_y = 0.5$.
Результаты для всех схем представлены на рис. \ref{img_impulse_2d}.

\begin{figure}[!h]
\begin{center}
\includegraphics[scale=0.8]{./images/fig1_2d.pdf}
\caption{
Вид переносимого импульса (\ref{eq_impulse_2d}) через 200 шагов разностной схемы.
а) -- CIP-2D-1; б) -- CIP-2D-2; в) -- БИС1-2D-1; г) -- БИС1-2D-2; д) -- БИС2-2D-1; е) -- БИС2-2D-2.
}
\label{img_impulse_2d}
\end{center}
\end{figure}

Также в таблице \ref{tab_convergence_nondiagonal_2d} приведены результаты тестирования сеточной сходимости рассмотренных схем.
В качестве начальных условий задавался импульс $u(0, x, y) = \sin^4(\pi x)\sin^4(\pi y)$ в области $[-1,1]\times[-1,1]$, и на границах области использовались периодические граничные условия.
При этом, если перенос ортогональной (дополнительной) производной в численной схеме осуществляется схемой CIR, то задавались начальные условия на частные производные искомой функции:
\begin{equation}
\label{eq_partial_derivatives}
\begin{cases}
\frac{\partial u}{\partial x} (0, x, y) = 4\pi\cos(\pi x)\sin^3(\pi x)\sin^4(\pi y), \\
\frac{\partial u}{\partial y} (0, x, y) = 4\pi\cos(\pi y)\sin^3(\pi y)\sin^4(\pi x).
\end{cases}
\end{equation}

При тестировании сходимости численных схем, использующих подход продолженных систем уравнений для переноса ортогональной (дополнительной) производной, дополнительно задавалось начальное условие на перекрёстную производную искомой функции:
\begin{equation}
\label{eq_cross_derivative}
\frac{\partial^2 u}{\partial y \partial x} (0, x, y) = 16\pi^2\cos(\pi x)\sin^3(\pi x)\cos(\pi y)\sin^3(\pi y).
\end{equation}


Согласно результатам расчётов, схема CIP-2D-1 обладает вторым порядком сходимости по нормам $L_1$ и $L_{\infty}$,
схема БИС1-2D-1 - полуторным порядком по норме $L_{\infty}$ и вторым по норме $L_1$, схема БИС2-2D-1 -
вторым порядком по нормам $L_1$ и $L_{\infty}$ вне зависимости от направления вектора потока.
Также, схема CIP-2D-2 обладает третьим порядком сходимости по нормам $L_1$ и $L_{\infty}$,
схема БИС1-2D-2 - полуторным порядком по норме $L_{\infty}$ и вторым с половиной по норме $L_1$, схема БИС2-2D-2 -
третьим порядком по нормам $L_1$ и $L_{\infty}$ вне зависимости от направления вектора потока.

\begin{table}
\caption {Сеточная сходимость. Вектор переноса (1, 0.5) направлен не вдоль диагонали ячеек сетки} \label{tab_convergence_nondiagonal_2d}
\bigskip
\input{table-2d.tex}
\end{table}

\section{Трёхмерное линейное уравнение переноса}

Рассмотрим простейшее трёхмерное линейное уравнение переноса:
\begin{equation}
\label{eq_advection_3d}
u_t + \lambda_x u_x + \lambda_y u_y + \lambda_z u_z = 0
\end{equation}

и четырёхточечный по пространству шаблон с пространственным шагом $h$ и временным шагом $\tau$:
\begin{equation}
\label{eq_stencil_4}
(t^n, x_{i - 1}, y_j, z_k), (t^n, x_i, y_{j - 1}, z_k), (t^n, x_i, y_j, z_{k - 1}), (t^n, x_i, y_j, z_k), (t^{n + 1}, x_i, y_j, z_k).
\end{equation}

Будем полагать, что $\lambda_x = const > 0$, $\lambda_y = const > 0$ и $\lambda_z = const > 0$, поскольку для отрицательных $\lambda_x, \lambda_y, \lambda_z$ все построения аналогичны и могут быть осуществлены заменой $\lambda_x, \lambda_y, \lambda_z$ на $-\lambda_x, -\lambda_y, -\lambda_z$, соответственно, и сеточного шаблона на симметричный по $x, y, z$ относительно точки $(t^n, x_i, y_j, z_k)$.

На этапе построения разностных схем для решения уравнения (\ref{eq_advection_3d}) используем метод расщепления по координатам ($X$, $Y$ и $Z$).
При этом примем связь между оператором перехода с текущего на следующий временной слой ($\hat{F_{3d}}$)
 и для отдельных шагов расщепления ($\hat{F_X}$, $\hat{F_Y}$, $\hat{F_Z}$) в виде:
\begin{equation}
\label{eq_operators}
\hat{F_{3d}} u^n_{i,j,k} = \hat{F_Z} \hat{F_Y} \hat{F_X} u^n_{i,j,k}.
\end{equation}

Рассмотрим подробнее, например, шаг расщепления по $X$:
\begin{equation}
\label{eq_advection_x}
u_t + \lambda_x u_x = 0.
\end{equation}

Для удобства записи будем обозначать значения величин, полученные после данного шага, индексом $n + \frac{1}{3}$ по времени, а после шага расшепления по $Y$ - индексом $n + \frac{2}{3}$.
Дополним уравнение (\ref{eq_advection_x}) его следствием, получаемым дифференцированием по $x$ и введением дополнительной неизвестной функции $\nu(t, x, y, z) = \frac{\partial u(t, x, y, z)}{\partial x}$:
\begin{equation}
\label{eq_advection_x_ext}
\nu_t + \lambda_x \nu_x = 0.
\end{equation}

Отметим,что система (\ref{eq_advection_x}, \ref{eq_advection_x_ext}) является продолженной и может быть решена на рассматриваемом шаблоне с использованием одной из компактных схем (CIP, БИС1 или БИС2) \cite{Khokhlov1D2014} или схемой CIR \cite{Courant1952}.
Таким образом, могут быть вычислены значения $u^{n + \frac{1}{3}}_{i, j, k}$ и $\nu^{n + \frac{1}{3}}_{i, j, k}$.

Однако, на следующем шаге расщепления по $Y$ нам необходимо знать дополнительно значение $w^{n + \frac{1}{3}}_{i, j, k}$, где введено обозначение $w(t, x, y, z) = \frac{\partial u(t, x, y, z)}{\partial y}$.
На шаге расщепления по $Z$ необходимо знать также значение $q^{n + \frac{2}{3}}_{i, j, k}$, где введено обозначение $q(t, x, y, z) = \frac{\partial u(t, x, y, z)}{\partial z}$.
Для краткости в дальнейшем будем называть первую производную по координате, не совпадающей с шагом расщепления, ортогональной (или дополнительной).
Так, например, на шаге расщепления по $X$ ортогональными являются две производные: $w$ и $q$.
Авторами было предложено два различных способа вычисления их значений, существенно влияющих на порядок сходимости итоговой схемы.

\subsection{Перенос ортогональных (дополнительных) производных схемой CIR}

Дополним уравнение (\ref{eq_advection_x}) его следствиями, получаемыми дифференцированием по $y$ и $z$:
\begin{eqnarray}
\label{eq_advection_x_ort_y}
w_t + \lambda_x w_x = 0, \\
\label{eq_advection_x_ort_z}
q_t + \lambda_x q_x = 0.
\end{eqnarray}

Будем вычислять значение $w^{n + \frac{1}{3}}_{i, j, k}$ на шаге расщепления по $X$ решением уравнения (\ref{eq_advection_x_ort_y}), а $q^{n + \frac{1}{3}}_{i, j, k}$ - уравнения (\ref{eq_advection_x_ort_z}) по схеме первого порядка сходимости по пространству CIR:
\begin{eqnarray}
\label{eq_advection_x_ort_y_g}
w^{n + \frac{1}{3}}_{i, j, k} = w^{n}_{i, j, k} - \frac{\lambda_x\tau}{h}(w^{n}_{i, j, k} - w^{n}_{i - 1, j, k}), \\
\label{eq_advection_x_ort_z_g}
q^{n + \frac{1}{3}}_{i, j, k} = q^{n}_{i, j, k} - \frac{\lambda_x\tau}{h}(q^{n}_{i, j, k} - q^{n}_{i - 1, j, k}).
\end{eqnarray}

Полученные компактные трёхмерные сеточно-характеристические схемы назовём CIP-3D-1, БИС1-3D-1, БИС2-3D-1, соответственно, в зависимости от используемой компактной схемы для решения продолженной системы уравнений (\ref{eq_advection_x}, \ref{eq_advection_x_ext}) и аналогичной ей на шагах расщепления по $Y$ и $Z$.

\subsection{Перенос ортогональных (дополнительных) производных компактной схемой}

Введём в рассмотрение новую искомую функцию $p(t, x, y, z) = \frac{\partial^2 u(t, x, y, z)}{\partial x \partial y}$ и рассмотрим следствие уравнения (\ref{eq_advection_x_ort_y}), получаемое дифференцированием его по $x$:
\begin{equation}
\label{eq_advection_y_ext}
p_t + \lambda_x p_x = 0.
\end{equation}

При таком подходе система уравнений (\ref{eq_advection_x_ort_y}, \ref{eq_advection_y_ext}) также является продолженной.
Расширим пространство искомых функций введением $r(t, x, y, z) = \frac{\partial^2 u(t, x, y, z)}{\partial  x \partial z}$ и рассмотрим следствие уравнения (\ref{eq_advection_x_ort_z}), получаемое дифференцированием его по $x$:
\begin{equation}
\label{eq_advection_z_ext}
r_t + \lambda_x r_x = 0.
\end{equation}

При таком подходе система уравнений (\ref{eq_advection_x_ort_z}, \ref{eq_advection_z_ext}) также является продолженной.
Вводя новые искомые функции $s(t, x, y, z) = \frac{\partial^2 u(t, x, y, z)}{\partial y \partial z}$ и $g(t, x, y, z) = \frac{\partial^3 u(t, x, y, z)}{\partial x \partial y \partial z}$ и дифференцируя уравнение (\ref{eq_advection_x_ort_y}) сначала по $z$, а потом по $x$, получим ещё одну продолженную систему уравнений:
\begin{eqnarray}
\label{eq_advection_x_add_yz}
s_t + \lambda_x s_x = 0, \\
\label{eq_advection_x_add_xyz}
g_t + \lambda_x g_x = 0.
\end{eqnarray}

Каждая из трёх записанных систем на шаге расщепления по $X$ может быть решена с использованием одной из компактных схем (CIP, БИС1 или БИС2).
Таким образом, могут быть вычислены значения всех величин $u, u_x, u_y, u_z, u_{xy}, u_{xz}, u_{xyz}$ на слое $n + \frac{1}{3}$.
На шаге расщепления по $Y$ и по $Z$ выражения для вычисления значений на слое $n + \frac{2}{3}$ и $n + 1$ строятся полностью аналогично вышеизложенному.
Полученные компактные трёхмерные сеточно-характеристические схемы назовём CIP-3D-2, БИС1-3D-2, БИС2-3D-2, соответственно, в зависимости от используемой компактной схемы для решения продолженных систем уравнений.
Отметим, что в настоящей работе не исследовались трёхмерные схемы, которые могут быть получены при решении систем (\ref{eq_advection_x}, \ref{eq_advection_x_ext}),  (\ref{eq_advection_x_ort_y}, \ref{eq_advection_y_ext}), (\ref{eq_advection_x_ort_z}, \ref{eq_advection_z_ext}) и (\ref{eq_advection_x_add_yz}, \ref{eq_advection_x_add_xyz}) отличными друг от друга компактными схемами.

\subsection{Порядок сходимости и поведение на разрывном решении}

Тест на качественное поведение построенных трёхмерных разностных схем проводился с импульсом прямоугольной формы:
\begin{equation}
\label{eq_impulse_3d}
u(0, x, y, z) = 
\begin{cases}
1, & -0.5 \le x, y, z \le 0.5, \\
0, & \mbox{в противном случае}.
\end{cases}
\end{equation}

Использовалась сетка, состоящая из 20 узлов по каждой из координат и покрывающая область $[-1,1]\times[-1,1]\times[-1,1]$, с периодическими граничными условиями.
Решение представлено после 100 шагов разностной схемы, шаг по времени выбирался исходя из числа Куранта $0.6$.
Использовались значения параметров $\lambda_x = 1, \lambda_y = 2, \lambda_z = 3$.
Результаты для всех схем (сечение области расчёта вдоль главной диагонали) представлены на рис. \ref{img_impulse_3d}.

\begin{figure}[!h]
\begin{center}
\includegraphics[scale=0.7]{./images/fig1_3d.pdf}
\caption{
Вид переносимого импульса (\ref{eq_impulse_3d}) через 100 шагов разностной схемы.
а) -- CIP-3D-1; б) -- CIP-3D-2; в) -- БИС1-3D-1; г) -- БИС1-3D-2; д) -- БИС2-3D-1; е) -- БИС2-3D-2.
Сплошной линией на всех графиках представлено аналитическое решение.
}
\label{img_impulse_3d}
\end{center}
\end{figure}

В таблице и \ref{tab_convergence_nondiagonal_3d} приведены результаты тестирования сеточной сходимости рассмотренных схем.
Использовались следующие нормы: $L_1 = \sum\limits_{i, j, k} |u_{i, j, k}|h^3$, $L_{\infty} = max |u_{i, j,k}|$.
В качестве начальных условий задавался импульс $u(0, x, y, z) = \sin^4(\pi x)\sin^4(\pi y)\sin^4(\pi z)$ в области $[-1,1]\times[-1,1]\times[-1,1]$, и на границах области использовались периодические граничные условия.
При этом, если перенос ортогональных (дополнительных) производных в численной схеме осуществлялся схемой CIR, то задавались начальные условия на частные производные искомой функции:
\begin{equation}
\label{eq_partial_derivatives}
\begin{cases}
\frac{\partial u}{\partial x} (0, x, y, z) = 4\pi\cos(\pi x)\sin^3(\pi x)\sin^4(\pi y)\sin^4(\pi z), \\
\frac{\partial u}{\partial y} (0, x, y, z) = 4\pi\cos(\pi y)\sin^3(\pi y)\sin^4(\pi x)\sin^4(\pi z), \\
\frac{\partial u}{\partial z} (0, x, y, z) = 4\pi\cos(\pi z)\sin^3(\pi z)\sin^4(\pi x)\sin^4(\pi y).
\end{cases}
\end{equation}

При тестировании сходимости численных схем, использующих подход продолженных систем уравнений для переноса ортогональных (дополнительных) производных, дополнительно задавались начальные условия на следующие производные искомой функции:
\begin{equation}
\label{eq_cross_derivative}
\begin{cases}
\frac{\partial^2 u}{\partial x \partial y} (0, x, y, z) = 16\pi^2\cos(\pi x)\sin^3(\pi x)\cos(\pi y)\sin^3(\pi y)\sin^4(\pi z), \\
\frac{\partial^2 u}{\partial x \partial z} (0, x, y, z) = 16\pi^2\cos(\pi x)\sin^3(\pi x)\cos(\pi z)\sin^3(\pi z)\sin^4(\pi y), \\
\frac{\partial^2 u}{\partial y \partial z} (0, x, y, z) = 16\pi^2\cos(\pi y)\sin^3(\pi y)\cos(\pi z)\sin^3(\pi z)\sin^4(\pi x), \\
\frac{\partial^3 u}{\partial x \partial y \partial z} (0, x, y, z) = 64\pi^3\cos(\pi x)\sin^3(\pi x)\cos(\pi y)\sin^3(\pi y)\cos(\pi z)\sin^3(\pi z).
\end{cases}
\end{equation}

Поскольку вычислительная сложность задачи получилась высокой, и не представлялось возможным провести расчёт на персональном компьютере за приемлемое время, была проведена параллелизация расчётного алгоритма с использованием технологии MPI, и все расчёты проводились на кластере Информационно-вычислительного центра Новосибирского государственного университета \href{http://www.nusc.ru/}{http://www.nusc.ru/}.

Согласно результатам расчётов, схема CIP-3D-1 обладает вторым порядком сходимости по нормам $L_1$ и $L_{\infty}$,
схема БИС1-3D-1 - полуторным порядком по норме $L_{\infty}$ и вторым по норме $L_1$, схема БИС2-3D-1 -
вторым порядком по нормам $L_1$ и $L_{\infty}$ вне зависимости от направления вектора потока.
Также, схема CIP-3D-2 обладает третьим порядком сходимости по нормам $L_1$ и $L_{\infty}$,
схема БИС1-3D-2 - полуторным порядком по норме $L_{\infty}$ и вторым с половиной по норме $L_1$, схема БИС2-3D-2 -
третьим порядком по нормам $L_1$ и $L_{\infty}$ вне зависимости от направления вектора потока.

\begin{table}
\caption {Сеточная сходимость. Вектор переноса (1, 2, 3) направлен не вдоль диагонали ячеек сетки} \label{tab_convergence_nondiagonal_3d}
\bigskip
\input{table-3d.tex}
\end{table}

\section{Заключение}

В работе рассмотрена задача численного решения трёхмерного линейного уравнения переноса на прямоугольных расчётных сетках.
На основе метода расщепления по координатам решение исходной системы уравнений сведено к последовательному решению
трёх одномерных систем уравнений.
Проведено расширение одномерных систем уравнений их дифференциальными следствиями с получение набора продолженных систем уравнений.
Для их решения используются явные компактные сеточно-характеристические численные схемы на двухточечном по пространству шаблону.

Проведено обобщение схем CIP, БИС1 и БИС2 на трёхмерный случай.
Численное исследование порядка сходимости построенных схем на гладком решении показало его сохранение схемами
CIP-3D-2, БИС1-3D-2 и БИС2-3D-2.
При переносе ортогональных (дополнительных) производных схемой первого порядка точности порядок схем снижается до второго.

\begin{thebibliography}{99}
\bibitem{Yabe1985}
Takewaki, H. and Nishiguchi, A. and Yabe, T. Journal of Computational Physics 261--268 Cubic Interpolated Pseudo-particle Method (CIP) for Solving Hyperbolic-Type Equations 61 1985

\bibitem{Yabe1991}
Yabe, Takashi and Aoki, Takayuki and Sakaguchi, Gyo and Wang, PY and Ishikawa, Takeo 10.1016/0045-7930(91)90067-R 00457930 Computers \& Fluids jan 3-4 421--431 The compact CIP (Cubic-Interpolated Pseudo-particle) method as a general hyperbolic solver 19 1991

\bibitem{Yabe1996-1}
Xiao, F. and Yabe, T. and Ito, T. Computer Physics Communications 1--12 Constructing oscillation preventing scheme for advection equation by rational function 93 1996

\bibitem{Yabe1996-2}
Xiao, F. and Yabe, T. and Ito, T. Computer Physics Communications 103--118 Constructing a multi-dimensional oscillation preventing scheme for the advection equation by a rational function 94 1996

\bibitem{Yabe2004}
Yabe, Takashi and Mizoe, Hiroki and Takizawa, Kenji and Moriki, Hiroshi and Im, Hyo-Nam and Ogata, Youichi 10.1016/j.jcp.2003.08.019 00219991 Journal of Computational Physics 1 57--77 Higher-order schemes with CIP method and adaptive Soroban grid towards mesh-free scheme 194 2004

\bibitem{Feng2012}
Feng, R. Commun. Comput. Phys. 1588--1602 High order cubic-polinomial interpolation schemes on triangular meshes 12 2012

\bibitem{Khol2006}
Холодов, А. С. and Холодов, Я. А. Журнал вычислительной математики и математическкой физики 9 1638--1667 О критериях монотонности разностных схем для уравнений гиперболического типа 46 2006

\bibitem{Magometov-Kholodov-1969}
Магомедов, К. М. and Холодов, А. С. О построении разностных схем для уравнений гиперболического типа на основе характеристических соотношений Наука 1969 Журнал вычислительной математики и математической физики 2 373--386 9


\if 0

\bibitem
@article{Balsara2000,
author = {Balsara, Dinshaw S. and Shu, Chi-Wang},
doi = {10.1006/jcph.2000.6443},
issn = {00219991},
journal = {Journal of Computational Physics},
month = may,
number = {2},
pages = {405--452},
title = {Monotonicity Preserving Weighted Essentially Non-oscillatory Schemes with Increasingly High Order of Accuracy},
volume = {160},
year = {2000}
}
@article{Jiang1995,
author = {Jiang, GS and Shu, CW},
number = {126},
pages = {202--228},
journal = {Journal of Computational Physics},
title = {Efficient implementation of weighted ENO schemes.},
volume = {228},
year = {1995}
}
@article{Suresh1997,
author = {Suresh, A. and Huynh, H.T.},
doi = {10.1006/jcph.1997.5745},
issn = {00219991},
journal = {Journal of Computational Physics},
month = sep,
number = {1},
pages = {83--99},
title = {Accurate Monotonicity-Preserving Schemes with Runge-Kutta Time Stepping},
volume = {136},
year = {1997}
}
@article{Courant1949,
author = {Courant, Richard and Lax, Peter},
doi = {10.1002/cpa.3160020206},
issn = {00103640},
journal = {Communications on Pure and Applied Mathematics},
month = jun,
number = {2-3},
pages = {255--273},
title = {On nonlinear partial differential equations with two independent variables},
volume = {2},
year = {1949}
}
@book{Tolstih1990,
author = {Толстых, А. И.},
pages = {230},
publisher = {Наука},
address = {Москва},
year = {1990},
title = {Компактные разностные схемы и их применение в задачах аэрогидродинамики}
}
@article{Rogov2011,
author = {Рогов, Б. В. and Михайловская, Маргарита Николаевна},
journal = {Математическое моделирование},
keywords = {bicompact difference schemes,monotonicity,transport equation,линейного уравнения переноса,монотонные бикомпактные схемы для},
number = {6},
pages = {98--110},
title = {Монотонные бикомпактные схемы для линейного уравнения переноса},
volume = {23},
year = {2011}
}
@article{Grudn1977,
  title={Один прием построения разностных схем с произвольным порядком аппроксимации дифференциальных уравнений в частных производных},
  author={Грудницкий, В. Г. and Прохорчук, Ю. А.},
  journal={Докл. АН СССР},
  volume={234},
  number={6},
  pages={1249--1252},
  year={1977}
}
@book{Yanenko1978,
  title={Системы квазилинейных уравнений и их приложения к газовой динамике},
  author={Рождественский, Б.Л. and Яненко, Н.Н.},
  year={1978},
  publisher={Наука, Глав. ред. физико-математической лит-ры}
}

@article{petrov1984,
  title={О регуляризации разрывных численных решений уравнений гиперболического типа},
  author={Петров, Игорь Борисович and Холодов, Александр Сергеевич},
  journal={Журнал вычислительной математики и математической физики},
  volume={24},
  number={8},
  pages={1172--1188},
  year={1984},
  publisher={Российская академия наук, Отделение математических наук}
}
@article{van1979,
  title={Towards the ultimate conservative difference scheme. V. A second-order sequel to Godunov's method},
  author={Van Leer, Bram},
  journal={Journal of computational Physics},
  volume={32},
  number={1},
  pages={101--136},
  year={1979},
  publisher={Elsevier}
}
@book{Kholodov2008,
author = {Холодов,~А.~C.},
pages = {658},
publisher = {Янус-К},
address = {Москва},
year = {2008},
title = {Энциклопедия низкотемпературной плазмы.~Т.~VII-1.~Ч.~2.}
}
@article{Khokhlov1D2014,
  title={Компактная сеточно-характеристическая схема для линейного уравнения переноса},
  author={Петров, И. Б. and Хохлов, Н. И.},
  journal={Сб. научн. тр. "Моделирование процессов обработки информации" - М.: МФТИ},
  volume={},
  number={},
  pages={18--22},
  year={2014}
}
@article{Golubev2D2014,
  title={Обобщение компактной схемы для линейного уравнения переноса на двумерный случай},
  author={Голубев, В. И. and Петров, И. Б. and Хохлов, Н. И.},
  journal={Сб. научн. тр. "Моделирование процессов обработки информации" - М.: МФТИ},
  volume={},
  number={},
  pages={23--26},
  year={2014}
}
@article{Kholodov1990,
  title={Расчёт динамического деформирования и разрушения упругопластических тел сеточно-характеристическими методами},
  author={Иванов, В. Д. and Кондауров, В. И. and Петров, И. Б. and Холодов, А. С.},
  journal={Математическое моделирование},
  volume={2},
  number={11},
  pages={10--29},
  year={1990}
}
@article{Courant1952,
  title={On the solutions of nonlinear hyperbolic differential eqations by finite differences},
  author={Courant, R. and Isaacson, E. and Rees, M.},
  journal={Communications on Pure and Applied Mathematics},
  volume={5},
  number={5},
  pages={243--254},
  year={1952}
}
@article{Rusanov1961,
  title={Calculation of intersection of non-steady shock waves with obstacles},
  author={Rusanov, V.},
  journal={J. Comput. Math. Phys. USSR},
  volume={1},
  number={},
  pages={267--279},
  year={1961}
}
@article{Kalitkin2008,
  title={Бикомпактные схемы и слоистые среды},
  author={Калиткин, Н. Н. and Корякин, П. В.},
  journal={Докл. РАН},
  volume={419},
  number={6},
  pages={744--748},
  year={2008}
}
@book{Petuhov1964,
  title={Численный расчёт двумерных течений в пограничном слое},
  author={Петухов, И. В.},
  publisher={Сб. "Численные методы решения диффер. и интегр. ур-ний и квадратурные формулы" - М.: Изд-во АН СССР},
  pages={304--325},
  year={1964}
}

\fi

\end{thebibliography}

\if 0

\section {Приложения}

\subsection {Название на русском и английском языках}

Компактные сеточно-характеристические схемы повышенного порядка точности для многомерного линейного уравнения переноса

Compact grid-characteristic schemes of higher orders for multidimensional linear transport equation

\subsection {Аннотации на русском и английском языках}
В работе рассматривается численное решение трёхмерного линейного уравнения переноса на параллелепипедных расчётных сетках.
С использованием подхода расщепления по координатам проведено обобщение компактных сеточно-характеристических схем повышенного порядка точности на трёхмерный случай.
Исследуется влияние отдельных шагов вычислительного алгоритма на точность итоговой схемы.
Предложен подход, позволяющий сохранить порядок сходимости схемы на гладком решении и минимизировать нефизические осцилляции на разрывном решении в трёхмерном случае.

\todo{Перевести на англ.}

\subsection {Ключевые слова и фразы на русском и английском языках}

компактные схемы, численный сеточно-характеристический метод, уравнение переноса, компьютерное моделирование

compact schemes, numerical grid-characteristic method, transport equation, computer simulation

\subsection {Код классификации УДК}

УДК 519.63

\subsection {Полная информация об авторах}

Голубев Василий Иванович, 8-926-4572707, w.golubev@mail.ru, г. Долгопрудный, Институтский пер., д. 9, лаборатория прикладной вычислительной геофизики.

Хохлов Николай Игоревич, 8-916-0105212, k\_h@inbox.ru, г. Долгопрудный, Институтский пер., д. 9, лаборатория прикладной вычислительной геофизики.

Петров Игорь Борисович, 8-903-6810022, petrov@mipt.ru, г. Долгопрудный, Институтский пер., д. 9, лаборатория прикладной вычислительной геофизики.

\fi

\end{document}
