%
% ****** maiksamp.tex 29.11.2001 ******
%
\documentclass[
aps,%
12pt,%
final,%
notitlepage,%
oneside,%
onecolumn,%
nobibnotes,%
nofootinbib,% 
superscriptaddress,%
noshowpacs,%
centertags]%
{revtex4}
\usepackage{epstopdf}
\bibliographystyle{maik}
\begin{document}
\selectlanguage{russian}

\title{КОМПАКТНЫЕ СЕТОЧНО-ХАРАКТЕРИСТИЧЕСКИЕ СХЕМЫ ПОВЫШЕННОГО ПОРЯДКА ТОЧНОСТИ ДЛЯ ДВУМЕРНОГО ЛИНЕЙНОГО УРАВНЕНИЯ ПЕРЕНОСА}% Разбиение на строки осуществляется командой \\

\author{\firstname{В.~И.}~\surname{Голубев}}
% Здесь разбиение на строки осуществляется автоматически или командой \\
\email{w.golubev@mail.ru}
\affiliation{%
Московский физико-технический институт
}%
\author{\firstname{И.~Б.}~\surname{Петров}}
%
\email{petrov@mipt.ru}
\affiliation{%
Московский физико-технический институт
}%
\author{\firstname{Н.~И.}~\surname{Хохлов}}
\email{k_h@inbox.ru}
\affiliation{%
Московский физико-технический институт
}%



%\date{\today}
%\today печатает cегодняшнее число

\begin{abstract}
В работе рассматривается численное решение двумерного линейного уравнения переноса на прямоугольных расчётных сетках.
С использованием подхода расщеплениея по координатам, методики построения продолженных систем уравнений
и сеточно-характеристического метода проведено обобщение компактных схем повышенного порядка точности на двумерный случай.
Исследуется влияние отдельных шагов вычислительного алгоритма на порядок получающейся схемы.
По результатам численного исследования порядка сходимости схем на гладком решении и их поведения на разрывном решении
показано сохранение свойств одномерных схем при предложенном методе обобщения.
\end{abstract}

\maketitle

\section{Введение}

Гиперболические системы дифференциальных уравнений в частных производных составляют
основу множества математических моделей для решения прикладных задач.
Для корректного моделирования физических процессов,
численные методы должны иметь приемлемую точность.
Одним из направлений для построения численных методов повышенного порядка точности
является использование продолженных систем уравнений уравнений \cite{Courant1949}.
Схемы, построенные для таких систем,
используют дифференциальные следствия исходных уравнений \cite{Khol2006, Grudn1977, Yanenko1978},
которые рассматриваются как дополнительные искомые функции,
это позволяет использовать для численной аппроксимации шаблон с минимальным набором точек,
одновременно сохраняя высокий порядок точности.
Схемы такого типа принято называть компактными \cite{Tolstih1990}.

При построении компактных разностных схем для систем гиперболических уравнений в основном используются трехточечные \cite{Tolstih1990, Yanenko1978} и двухточечные шаблоны \cite{Rogov2011, Khol2006}.
Максимальный порядок схем для систем гиперболических уравнений на двухточечном шаблоне,
из представленных в литературе, -- четвертый \cite{Rogov2011, Khol2006}.
В работе \cite{Rogov2011} используются интегральные следствия исходных дифференциальных уравнений,
четвертый порядок схемы достигается за счет использования схемы бегущего счета.
Представленны монотонная схема первого порядка по времени и монотонизированная схема третьего порядка по времени,
обе схемы имеют четвертый порядок по координате.
В обзорной работе \cite{Khol2006} четвертый порядок схемы достигается за счет последовательного решения
дифференциального следствия и исходной системы.
Разностная схема для исходной системы использует значение из дифференциального следствия на двух временных слоях.
Схема монотонизированна, используя сеточно-характеристический критерий монотонности \cite{van1979}.

В данной работе рассматриваются компактные схемы второго-третьего порядка точности построенные используя интерполяционные полиномы.
Решение системы аппроксимируется используя набор интерполяцонных полиномов различной степени,
затем для обеспечения монотонного поведения решения,
схема гибридизируется \cite{petrov1984}, путем выбора того или иного полинома в зависимости от характера решения.
Используется гибридизация на основе сеточно-характеристического критерия \cite{van1979} и на основе критерия, 
основанного на поиске экстремума интерполяционного полинома на выбранном интервале, который предложен в данной работе.
Все схемы построены на минимальном трехточечном шаблоне,
поэтому их можно отнести к классу бикомпактных \cite{Rogov2011} разностных схем.
В результате удалось добиться монотонного поведения разностной схемы и слабого размытия решения со временем.

\section{Двумерное линейное уравнение переноса}

Рассмотрим простейшее двумерное линейное уравнение переноса:
\begin{equation}
\label{eq_advection_2d}
u_t + \lambda_x u_x + \lambda_y u_y = 0
\end{equation}

и трёхточечный по пространству шаблон (рис. \ref{img_stencil}) с пространственным шагом $h$ и временным шагом $\tau$:
\begin{equation}
\label{eq_stencil_4}
(t^n, x_{i - 1}, y_j), (t^n, x_i, y_j), (t^n, x_i, y_{j - 1}), (t^{n + 1}, x_i, y_j).
\end{equation}

Будем полагать, что $\lambda_x = const > 0$ и $\lambda_y = const > 0$, поскольку для отрицательных $\lambda_x, \lambda_y$ все построения аналогичны и могут быть осуществлены заменой $\lambda_x, \lambda_y$ на $-\lambda_x, -\lambda_y$, соответственно, и сеточного шаблона на симметричный по $x, y$ относительно точки $(t^n, x_i, y_j)$.

На этапе построения разностных схем для решения уравнения (\ref{eq_advection_2d}) используем метод расщепления по координатам ($X$ и $Y$).
При этом примем связь между оператором перехода с текущего на следующий временной слой ($\hat{F_{2d}}$)
 и для отдельных шагов расщепления ($\hat{F_X}$, $\hat{F_Y}$) в виде:
\begin{equation}
\label{eq_operators}
\hat{F_{2d}} u^n_{i,j} = \hat{F_Y} \hat{F_X} u^n_{i,j}.
\end{equation}

Рассмотрим подробнее, например, шаг расщепления по $X$:
\begin{equation}
\label{eq_advection_x}
u_t + \lambda_x u_x = 0.
\end{equation}

Для удобства записи будем обозначать значения величин, полученные после данного шага, индексом $n + \frac{1}{2}$ по времени.
Дополним уравнение (\ref{eq_advection_x}) его следствием, получаемым дифференцированием по $x$ и введением дополнительной неизвестной функции $\nu(t, x, y) = \frac{\partial u(t, x, y)}{\partial x}$:
\begin{equation}
\label{eq_advection_x_ext}
\nu_t + \lambda_x \nu_x = 0.
\end{equation}

Отметим,что система (\ref{eq_advection_x} - \ref{eq_advection_x_ext}) является продолженной и может быть решена на рассматриваемом шаблоне с использованием одной из компактных схем (CIP, БИС1 или БИС2) \cite{Rogov2011} или схемой CIR \cite{Rogov2011}.
Таким образом, могут быть вычислены значения $u^{n + \frac{1}{2}}_{i, j}$ и $\nu^{n + \frac{1}{2}}_{i, j}$.

Однако, на следующем шаге расщепления по $Y$ нам необходимо знать дополнительно значение $w^{n + \frac{1}{2}}_{i, j}$, где введено обозначение $w(t, x, y) = \frac{\partial u(t, x, y)}{\partial y}$. Аналогично, на шаге расщепления по $Y$ необходимо будет по той же процедуре вычислять значение $\nu^{n + 1}$.
Для краткости в дальнейшем будем называть $w$ и $\nu$ ортогональной производной (по отношению к обычной частной производной $\nu$ и $w$ соответственно).
Авторами было предложено два различных способа вычисления её значения, существенно влияющих на порядок сходимости итоговой схемы.

\section{Перенос ортогональной производной схемой CIR}

Дополним уравнение (\ref{eq_advection_x}) его следствием, получаемым дифференцированием по $y$:
\begin{equation}
\label{eq_advection_x_ort}
w_t + \lambda_x w_x = 0.
\end{equation}

Будем вычислять значение $w^{n + \frac{1}{2}}_{i, j}$ на шаге расщепления по $X$ решением уравнения (\ref{eq_advection_x_ort}) по схеме первого порядка сходимости по пространству CIR:
\begin{equation}
\label{eq_advection_x_ort_g}
w^{n + \frac{1}{2}}_{i, j} = w^{n}_{i, j} - \frac{\lambda_x\tau}{h}(w^{n}_{i, j} - w^{n}_{i - 1, j}).
\end{equation}

Полученные компактные двумерные сеточно-характеристические схемы назовём CIP-2D-1, БИС1-2D-1, БИС2-2D-1, соответственно, в зависимости от используемой компактной схемы для решения продолженной системы уравнений (\ref{eq_advection_x} - \ref{eq_advection_x_ext}) и аналогичной ей на шаге расщепления по $Y$.

\section{Перенос ортогональной производной компактной схемой}

Введём в рассмотрение новую искомую функцию $p(t, x, y) = \frac{\partial^2 u(t, x, y)}{\partial x \partial y}$ и рассмотрим следствие уравнения (\ref{eq_advection_x_ort}), получаемое дифференцированием его по $x$:
\begin{equation}
\label{eq_advection_x_ort_ext}
p_t + \lambda_x p_x = 0.
\end{equation}

При таком подходе система уравнений (\ref{eq_advection_x_ort} - \ref{eq_advection_x_ort_ext}) является продолженной и может быть решена с использованием одной из компактных схем (CIP, БИС1 или БИС2).
Полученные компактные двумерные сеточно-характеристические схемы назовём CIP-2D-2, БИС1-2D-2, БИС2-2D-2, соответственно, в зависимости от используемой компактной схемы для решения продолженных систем уравнений (\ref{eq_advection_x} - \ref{eq_advection_x_ext}) и  (\ref{eq_advection_x_ort} - \ref{eq_advection_x_ort_ext}) и аналогичных им на шаге расщепления по $Y$.
Отметим, что в настоящей работе не исследовались двумерные схемы, которые могут быть получены при решении (\ref{eq_advection_x} - \ref{eq_advection_x_ext}) и  (\ref{eq_advection_x_ort} - \ref{eq_advection_x_ort_ext}) отличными друг от друга компактными схемами.

\section{Порядок сходимости и поведение на разрывном решении}

Тест на качественное поведение построенных двумерных разностных схем проводился с импульсом прямоугольной формы:
\begin{equation}
\label{eq_impulse}
u(0, x, y) = 
\begin{cases}
1, & -0.5 \le x, y \le 0.5, \\
0, & \mbox{в противном случае}.
\end{cases}
\end{equation}

Использовалась сетка, состоящая из 20 узлов по каждой из координат и покрывающая область $[-1,1]\times[-1,1]$, с периодическими граничными условиями.
Решение представлено после 200 шагов разностной схемы, шаг по времени выбирался исходя из числа Куранта $0.2$.
Использовались значения параметров $\lambda_x = 1, \lambda_y = 0.5$.
Результаты для всех схем представленны на рис. \ref{img_impulse_1} и \ref{img_impulse_2}.

Как видно из графиков, при построении численной схемы на основе подхода к решению продолженной системы уравнений, удаётся добиться намного меньшего размытия, чем при использовании схемы CIR.
Также были вычислены нормы ошибок на разрывном решении для каждой из схем.
Использовалась сетка, содержащая 200 узлов по каждой из координат.
Также были проведены дополнительные расчёты с параметрами $\lambda_x = 1, \lambda_y = 1$, чтобы рассмотреть случай движения вдоль диагонали ячеек сетки.
Результаты оценок приведены в таблицах \ref{tab_errors_diagonal} и \ref{tab_errors}.
Использовались следующие нормы: $L_1 = \sum\limits_{i, j} |x_{i, j}|h^2$, $L_{\infty} = max |x_{i, j}|$.
Отметим, что схемы CIP-2D-1 и CIP-2D-2 являются осциллирующими.

В таблицах \ref{tab_convergence_diagonal} и \ref{tab_convergence} приведены результаты тестирования сеточной сходимости рассмотренных схем.
Исследовался, как случай вектора переноса, направленного вдоль диагонали ячейки сетки, так и не вдоль неё.
В качестве начальных условий задавался импульс $u(0, x, y) = \sin^4(\pi x)\sin^4(\pi y)$ в области $[-1,1]\times[-1,1]$, и на границах области использовались периодические граничные условия.
При этом, если перенос ортогональной производной в численной схеме осуществляется схемой CIR, то задавались начальные условия на частные производные искомой функции:
\begin{equation}
\label{eq_partial_derivatives}
\begin{cases}
\frac{\partial u}{\partial x} (0, x, y) = 4\pi\cos(\pi x)\sin^3(\pi x)\sin^4(\pi y), \\
\frac{\partial u}{\partial y} (0, x, y) = 4\pi\cos(\pi y)\sin^3(\pi y)\sin^4(\pi x).
\end{cases}
\end{equation}

При тестировании сходимости численных схем, использующих подход продолженных систем уравнений для переноса ортогональной производной, дополнительно задавалось начальное условие на перекрёстную производную искомой функции:
\begin{equation}
\label{eq_cross_derivative}
\frac{\partial^2 u}{\partial y \partial x} (0, x, y) = 16\pi^2\cos(\pi x)\sin^3(\pi x)\cos(\pi y)\sin^3(\pi y).
\end{equation}

Согласно результатам расчётов, схема CIP-2D-1 обладает вторым порядком сходимости по нормам $L_1$ и $L_{\infty}$,
схема БИС1-2D-1 - полуторным порядком по норме $L_{\infty}$ и вторым по норме $L_1$, схема БИС2-2D-1 -
вторым порядком по нормам $L_1$ и $L_{\infty}$ вне зависимости от направления вектора потока.
Также, схема CIP-2D-2 обладает третьим порядком сходимости по нормам $L_1$ и $L_{\infty}$,
схема БИС1-2D-2 - полуторным порядком по норме $L_{\infty}$ и вторым с половиной по норме $L_1$, схема БИС2-2D-2 -
третьим порядком по нормам $L_1$ и $L_{\infty}$ вне зависимости от направления вектора потока.

\section{Заключение}

В работе рассмотрена задача численного решения двумерного линейного уравнения переноса на прямоугольных расчётных сетках.
На основе метода расщепления по координатам решение исходной системы уравнений сведено к последовательному решению
двух одномерных систем уравнений.
Проведено расширение одномерных систем уравнений их дифференциальными следствиями с получение набора продолженных систем уравнений.
Для их решения используются явные компактные сеточно-характеристические численные схемы на двухточечном по пространству шаблону.

Проведено обобщение схем CIP, БИС1 и БИС2 на двумерный случай.
Численное исследование порядка сходимости построенных схем на гладком решении показало его сохранение схемами
CIP-2D-2, БИС1-2D-2 и БИС2-2D-2.
При переносе ортогональной производной схемой первого порядка точности порядок схем снижается до второго.

\begin{acknowledgments}
Авторы статьи благодарят академика РАН Белоцерковского О. М. и члена-корреспондента РАН Холодова А. С. за внимание к данной работе.
\end{acknowledgments}

%
% Список литературы
%
\bibliography{ref}{}
\bibliographystyle{maik}

\begin{figure}[htb]
\setcaptionmargin{5mm}
\onelinecaptionstrue
\includegraphics{./images/fig1.pdf}
\captionstyle{normal}
\caption{Шаблон разностной схемы}
\label{img_stencil}
\end{figure}


\begin{figure}[htb]
\setcaptionmargin{5mm}
\onelinecaptionstrue
\includegraphics{./images/fig2.pdf}
\captionstyle{normal}
\caption{
Вид переносимого импульса (\ref{eq_impulse}) через 200 шагов разностной схемы.
а) -- аналитическое решение; б) -- CIR; в) -- CIP-2D-1; г) -- CIP-2D-2.
}
\label{img_impulse_1}
\end{figure}

\begin{figure}[htb]
\setcaptionmargin{5mm}
\onelinecaptionstrue
\includegraphics{./images/fig3.pdf}
\captionstyle{normal}
\caption{
Вид переносимого импульса (\ref{eq_impulse}) через 200 шагов разностной схемы.
а) -- БИС1-2D-1; б) -- БИС1-2D-2; в) -- БИС2-2D-1; г) -- БИС2-2D-2.
}
\label{img_impulse_2}
\end{figure}

\begin{table}
\setcaptionmargin{0mm} \onelinecaptionsfalse
\captionstyle{flushleft} \caption {Нормы ошибок для различных схем. Вектор переноса направлен вдоль диагонали ячеек сетки} \label{tab_errors_diagonal}
\bigskip
\input{table1.tex}
\end{table}


\begin{table}
\setcaptionmargin{0mm} \onelinecaptionsfalse
\captionstyle{flushleft} \caption {Нормы ошибок для различных схем. Вектор переноса направлен не вдоль диагонали ячеек сетки} \label{tab_errors}
\bigskip
\input{table2.tex}
\end{table}


\begin{table}
\setcaptionmargin{0mm} \onelinecaptionsfalse
\captionstyle{flushleft} \caption {Сеточная сходимость. Вектор переноса направлен вдоль диагонали ячеек сетки} \label{tab_convergence}
\bigskip
\input{table3.tex}
\end{table}


\begin{table}
\setcaptionmargin{0mm} \onelinecaptionsfalse
\captionstyle{flushleft} \caption {Сеточная сходимость. Вектор переноса направлен не вдоль диагонали ячеек сетки} \label{tab_convergence_diagonal}
\bigskip
\input{table4.tex}
\end{table}


\end{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%% Character code reference %%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                             %
%     Upper case russian letters (CP866): АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ   %                                                                       %
%     Lower case russian letters (CP866): абвгдеёжзийклмнопрстуфхцчшщъыьэюя   %
%                     Upper case letters: ABCDEFGHIJKLMNOPQRSTUVWXYZ          %
%                     Lower case letters: abcdefghijklmnopqrstuvwxyz          %
%                                   Digits: 0123456789                        %
% Square, curly, angle braces, parentheses: [] {} <> ()                       %
%                Backslash, slash, solidus: \ / |                             %
%       Period, interrogative, exclamation: . ? !                             %
%                 Comma, colon, semi-colon: , : ;                             %
%          Underscore, hyphen, equals sign: _ - =                             %
%             Quotes (left, right, double): ` ' "                             %
%     Commercial-at, hash, dollar, percent: @ # $ %                           %
%  Ampersand, asterisk, plus, caret, tilde: & * +   ^                         %
%                                                                             %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% ****** End of file apssampr.tex ******
