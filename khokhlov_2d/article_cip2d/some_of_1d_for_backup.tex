%
% ****** maiksamp.tex 29.11.2001 ******
%
\documentclass[
aps,%
12pt,%
final,%
notitlepage,%
oneside,%
onecolumn,%
nobibnotes,%
nofootinbib,% 
superscriptaddress,%
noshowpacs,%
centertags]%
{revtex4}
\usepackage{epstopdf}
\bibliographystyle{maik}
\begin{document}
\selectlanguage{russian}

\title{ОБ ОДНОМ КЛАССЕ КОМПАКТНЫХ СХЕМ ВТОРОГО-ТРЕТЬЕГО ПОРЯДКА ТОЧНОСТИ ДЛЯ ДВУМЕРНОГО УРАВНЕНИЯ ПЕРЕНОСА}% Разбиение на строки осуществляется командой \\

\author{\firstname{В.~И.}~\surname{Голубев}}
% Здесь разбиение на строки осуществляется автоматически или командой \\
\email{w.golubev@mail.ru}
\affiliation{%
Московский физико-технический институт
}%
\author{\firstname{И.~Б.}~\surname{Петров}}
%
\email{petrov@mipt.ru}
\affiliation{%
Московский физико-технический институт
}%
\author{\firstname{Н.~И.}~\surname{Хохлов}}
\email{k_h@inbox.ru}
\affiliation{%
Московский физико-технический институт
}%



%\date{\today}
%\today печатает cегодняшнее число

\begin{abstract}
В работе рассмотрена задача численного решения двумерного линейного уравнения переноса.
На основе сеточно-характеристического подхода и идеологии продолженных систем уравнений
предложены две явные компактные гибридные схемы 1-2 и 2-3 порядка точности.
Они построены на основе метода пространственного расщепления и построения интерполяционного полинома.
Схема 2-3 порядка точности обладает монотонным поведением и слабо размывает решение со временем.
Проведено исследование сеточной сходимости для построенной разностной схемы,
и численно промоделировано распространение импульса прямоугольной формы для исследования качественного поведения разностной схемы на разрывных решениях.
\end{abstract}

\maketitle

\section{Введение}

Гиперболические системы дифференциальных уравнений в частных производных составляют
основу множества математических моделей для решения прикладных задач.
Для корректного моделирования физических процессов,
численные методы должны иметь приемлемую точность.
Одним из направлений для построения численных методов повышенного порядка точности
является использование продолженных систем уравнений уравнений \cite{Courant1949}.
Схемы, построенные для таких систем,
используют дифференциальные следствия исходных уравнений \cite{Khol2006, Grudn1977, Yanenko1978},
которые рассматриваются как дополнительные искомые функции,
это позволяет использовать для численной аппроксимации шаблон с минимальным набором точек,
одновременно сохраняя высокий порядок точности.
Схемы такого типа принято называть компактными \cite{Tolstih1990}.

При построении компактных разностных схем для систем гиперболических уравнений в основном используются трехточечные \cite{Tolstih1990, Yanenko1978} и двухточечные шаблоны \cite{Rogov2011, Khol2006}.
Максимальный порядок схем для систем гиперболических уравнений на двухточечном шаблоне,
из представленных в литературе, -- четвертый \cite{Rogov2011, Khol2006}.
В работе \cite{Rogov2011} используются интегральные следствия исходных дифференциальных уравнений,
четвертый порядок схемы достигается за счет использования схемы бегущего счета.
Представленны монотонная схема первого порядка по времени и монотонизированная схема третьего порядка по времени,
обе схемы имеют четвертый порядок по координате.
В обзорной работе \cite{Khol2006} четвертый порядок схемы достигается за счет последовательного решения
дифференциального следствия и исходной системы.
Разностная схема для исходной системы использует значение из дифференциального следствия на двух временных слоях.
Схема монотонизированна, используя сеточно-характеристический критерий монотонности \cite{van1979}.

В данной работе рассматриваются компактные схемы второго-третьего порядка точности построенные используя интерполяционные полиномы.
Решение системы аппроксимируется используя набор интерполяцонных полиномов различной степени,
затем для обеспечения монотонного поведения решения,
схема гибридизируется \cite{petrov1984}, путем выбора того или иного полинома в зависимости от характера решения.
Используется гибридизация на основе сеточно-характеристического критерия \cite{van1979} и на основе критерия, 
основанного на поиске экстремума интерполяционного полинома на выбранном интервале, который предложен в данной работе.
Все схемы построены на минимальном трехточечном шаблоне,
поэтому их можно отнести к классу бикомпактных \cite{Rogov2011} разностных схем.
В результате удалось добиться монотонного поведения разностной схемы и слабого размытия решения со временем.

\section{Продолженная система уравнений}

Рассмотрим простейшее однородное линейное уравнение переноса:
\begin{equation}
\label{eq_advection}
u_t + \lambda u_x = 0.
\end{equation}

Будем полагать, что $\lambda = const > 0$,
поскольку для отрицательных $\lambda$ все построения аналогичны и могут быть осущественны заменой $\lambda$ на $-\lambda$
и сеточного шаблона на симметричный по $x$ относительно рассчитываемой точки $(t^n, x_m)$.

Помимо уравнения (\ref{eq_advection}) также рассмотрим его дифференциальное следствие.
Введем в дополнение к $u(t, x)$ новую искомую функцию $\nu(t, x) = u_x(t, x)$ и продифференцировав уравнение (\ref{eq_advection}) по $x$
получим для $\nu(t, x)$ аналогичное уравнение переноса:
\begin{equation}
\label{eq_advection_ext}
\nu_t + \lambda \nu_x = 0.
\end{equation}

\section{Двумерное линейное уравнение переноса}

Рассмотрим простейшее двумерное линейное уравнение переноса:
\begin{equation}
\label{eq_advection_2d}
u_t + \lambda_x u_x + \lambda_y u_y = 0.
\end{equation}

и трёхточечный по пространству шаблон (рис. \ref{img_stencil}) с пространственным шагом $h$ и временным шагом $\tau$:
\begin{equation}
\label{eq_stencil_4}
(t^n, x_{i - 1}, y_j), (t^n, x_i, y_j), (t^n, x_i, y_{j - 1}), (t^{n + 1}, x_i, y_j).
\end{equation}

Будем полагать, что $\lambda_x = const > 0$ и $\lambda_y = const > 0$, поскольку для отрицательных $\lambda_x, \lambda_y$ все построения аналогичны и могут быть осуществлены заменой $\lambda_x, \lambda_y$ на $-\lambda_x, -\lambda_y$, соответственно, и сеточного шаблона на симметричный по $x, y$ относительно точки $(t^n, x_i, y_j)$.

На этапе построения разностных схем для решения уравнения (\ref{eq_advection_2d}) используем метод расщепления по координатам ($X$ и $Y$).
При этом примем связь между оператором перехода с текущего на следующий временной слой ($\hat{F_{2d}}$)
 и для отдельных шагов расщепления ($\hat{F_X}$, $\hat{F_Y}$) в виде:
\begin{equation}
\label{eq_operators}
\hat{F_{2d}} u^n_{i,j} = \hat{F_Y} \hat{F_X} u^n_{i,j}.
\end{equation}

Рассмотрим подробнее, например, шаг расщепления по $X$:
\begin{equation}
\label{eq_advection_x}
u_t + \lambda_x u_x = 0.
\end{equation}

Для удобства записи будем обозначать значения величин, полученные после данного шага индексом $n + \frac{1}{2}$ по времени.
Дополним уравнение (\ref{eq_advection_x}) его следствием, получаемым дифференцированием по $x$ и введением дополнительной функции $\nu(x, y, t) = \frac{\partial u(x, y, t)}{\partial x}$:
\begin{equation}
\label{eq_advection_x_ext}
\nu_t + \lambda_x \nu_x = 0.
\end{equation}

Отметим,что система (\ref{eq_advection_x} - \ref{eq_advection_x_ext}) является продолженной и может быть решена на рассматриваемом шаблоне с использованием одной из компактных схем (CIP, БИС1 или БИС2) или схемой CIR \cite{Rogov2011}.
Таким образом, могут быть вычислены значения $u^{n + \frac{1}{2}}_{i, j}$ и $\nu^{n + \frac{1}{2}}_{i, j}$.

Однако, на следующем шаге расщепления по $Y$ нам необходимо знать дополнительно значение $w^{n + \frac{1}{2}}_{i, j}$, где введено обозначение $w(x, y, t) = \frac{\partial u(x, y, t)}{\partial y}$. Аналогично, на шаге расщепления по $Y$ необходимо будет по той же процедуре вычислять значение $\nu^{n + 1}$.
Для краткости в дальнейшем будем называть $w$ и $\nu$ ортогональной производной (по отношению к обычной частной производной $\nu$ и $w$ соответственно).
Авторами было предложено два различных способа вычисления её значения, существенно влияющих на порядок сходимости итоговой схемы.

\section{Перенос ортогональной производной схемой CIR}

Дополним уравнение (\ref{eq_advection_x}) его следствием, получаемым дифференцированием по $y$:
\begin{equation}
\label{eq_advection_x_ort}
w_t + \lambda_x w_x = 0.
\end{equation}

Будем вычислять значение $w^{n + \frac{1}{2}}_{i, j}$ на шаге расщепления по $X$ решением уравнения (\ref{eq_advection_x_ort}) по схеме первого порядка сходимости по пространству CIR:
\begin{equation}
\label{eq_advection_x_ort_g}
w^{n + \frac{1}{2}}_{i, j} = w^{n}_{i, j} - \frac{\lambda_x\tau}{h} * (w^{n}_{i, j} - w^{n}_{i - 1, j}).
\end{equation}

Полученные компактные двумерные сеточно-характеристические схемы назовём CIP-2D-1, БИС1-2D-1, БИС2-2D-1, соответственно, в зависимости от используемой компактной схемы для решения продолженной системы уравнений (\ref{eq_advection_x} - \ref{eq_advection_x_ext}) и аналогичной ей на шаге расщепления по $Y$.

\section{Перенос ортогональной производной компактной схемой}

Введём в рассмотрение новую искомую функцию $p(t, x, y) = \frac{\partial^2 u(t, x, y)}{\partial x \partial y}$ и рассмотрим следствие уравнения (\ref{eq_advection_x_ort}), получаемое дифференцированием его по $x$:
\begin{equation}
\label{eq_advection_x_ort_ext}
p_t + \lambda_x p_x = 0.
\end{equation}

При таком подходе система уравнений (\ref{eq_advection_x_ort} - \ref{eq_advection_x_ort_ext}) является продолженной и может быть решена с использованием одной из компактных схем CIP, БИС1 или БИС2.
Полученные компактные двумерные сеточно-характеристические схемы назовём CIP-2D-2, БИС1-2D-2, БИС2-2D-2, соответственно, в зависимости от используемой компактной схемы для решения продолженных систем уравнений (\ref{eq_advection_x} - \ref{eq_advection_x_ext}) и  (\ref{eq_advection_x_ort} - \ref{eq_advection_x_ort_ext}) и аналогичных им на шаге расщепления по $Y$.
Отметим, что в настоящей работе не исследовались двумерные схемы, которые могут быть получены при решении (\ref{eq_advection_x} - \ref{eq_advection_x_ext}) и  (\ref{eq_advection_x_ort} - \ref{eq_advection_x_ort_ext}) отличными друг от друга компактными схемами.

\section{Численное исследование размытия и порядка сходимости построенных схем}

Тест на качественное поведение построенных двумерных разностных схем проводился с импульсом прямоугольной формы:
\begin{equation}
\label{eq_impulse}
u(0, x, y) = 
\begin{cases}
1, & -0.5 \le x, y \le 0.5, \\
0, & \mbox{в противном случае}.
\end{cases}
\end{equation}

Использовалась сетка, состоящая из 20 узлов и покрывающая отрезок $[-1,1]$, с периодическими граничными условиями.
Решение представлено после 100 шагов разностной схемы, шаг по времени выбирался исходя из числа Куранта $0.2$.
Использовались значения параметров $\lambda_x = 1, \lambda_y = 1$.
Результаты для всех схем представленны на рис. \ref{img_impulse_diagonal}.
Также были проведены дополнительные расчёты с параметрами $\lambda_x = 1, \lambda_y = 0.5$, чтобы рассмотреть случай движения не по диагонали ячеек сетки.
Результаты представленны на рис. \ref{img_impulse}.

Как видно из графиков, при построении численной схемы на основе подхода к решению продолженной системы уравнений, удаётся добиться намного меньшего размытия, чем при использовании схемы CIR.
Нормы ошибок приведены в таблицах \ref{tab_errors_diagonal} и \ref{tab_errors}.
Использовались следующие нормы: $L_1 = \sum\limits_{i, j} |x_{i, j}| * h^2$, $L_{\infty} = max |x_{i, j}|$.
Отметим, что схемы CIP-2D-1 и CIP-2D-2 являются осциллирующими.

В таблицах \ref{tab_convergence_diagonal} и \ref{tab_convergence} приведены результаты тестирования сеточной сходимости рассмотренных схем.
Исследовался, как случай вектора переноса, направленного вдоль диагонали ячейки сетки, так и не вдоль неё.
В качестве начальных условий задавался импульс $u(0, x, y) = \sin^4(\pi x)\sin^4(\pi y)$ в области $[-1,1]\dot[-1,1]$, и на границах области использовались периодические граничные условия.
При этом, если перенос ортогональной производной в численной схеме осуществляется схемой CIR, то задавались начальные условия на частные производные искомой функции:
\begin{equation}
\label{eq_partial_derivatives}
\begin{cases}
\frac{\partial u}{\partial x} (0, x, y) = 4\pi\cos(\pi x)\sin^3(\pi x)\sin^4(\pi y), \\
\frac{\partial u}{\partial y} (0, x, y) = 4\pi\cos(\pi y)\sin^3(\pi y)\sin^4(\pi x).
\end{cases}
\end{equation}

При тестировании сходимости численных схем, использующих подход продолженных систем уравнений для переноса ортогональной производной, дополнительно задавалось начальное условие на перекрёстную производную искомой функции:
\begin{equation}
\label{eq_cross_derivative}
\frac{\partial^2 u}{\partial y \partial x} (0, x, y) = 16\pi^2\cos(\pi x)\sin^3(\pi x)\cos(\pi y)\sin^3(\pi y).
\end{equation}

Согласно результатам расчётов, схема CIP-2D-1 обладает вторым порядком сходимости по нормам $L_1$ и $L_{\infty}$,
схема БИС1-2D-1 - полуторным порядком по норме $L_{\infty}$ и вторым по норме $L_1$, схема БИС2-2D-1 -
вторым порядком по нормам $L_1$ и $L_{\infty}$ вне зависимости от направления вектора потока.
Также, схема CIP-2D-2 обладает третьим порядком сходимости по нормам $L_1$ и $L_{\infty}$,
схема БИС1-2D-2 - полуторным порядком по норме $L_{\infty}$ и вторым с половиной по норме $L_1$, схема БИС2-2D-2 -
третьим порядком по нормам $L_1$ и $L_{\infty}$ вне зависимости от направления вектора потока.

\section{Былом}

Построение продолженных разностных схем будем рассматривать на двухточечном щаблоне (рис. \ref{img_stencil})
с пространственным шагом $h$ и временным шагом $\tau$:
\begin{equation}
\label{eq_stencil_3}
(t^n, x_{m-1}), (t^n, x_m), (t^{n+1}, x_m).
\end{equation}

Будем использовать систему координат, в которой точка $(t^n, x_m)$ имеет координаты $(0, 0)$,
а точка $(t^n, x_{m-1})$ -- $(0, -h)$ соответственно.

Рассмотрим на интервале $(-h, 0)$ интерполяционные полиномы $f(x)$,
которые аппроксимирует функцию $u(x)$ на заданном интервале.
В дальнейшем индекс по времени будем опускать, где это возможно.
Решение уравнения (\ref{eq_advection}) на временном шаге $n+1$ может быть найдено как
$$
u^{n+1}_m = f(-\lambda\tau),
$$
а решение продолженной системы будет:
$$
\nu^{n+1}_m = f'(-\lambda\tau).
$$

Полином максимальной степени, который можно построить на данном шаблоне -- это полином Эрмита третьей степени,
представим его в виде
\begin{equation}
\label{eq_poly_f3}
F_3(x) = a_3 x^3 + b_3 x^2 + c_3 x + d_3,
\end{equation}
для исходной системы (\ref{eq_advection}),
тогда дифференциальное приближение (\ref{eq_advection_ext}) будет аппроксимироваться его производной
\begin{equation}
\label{eq_poly_f3_der}
F_3'(x) = 3 a_3 x^2 + 2 b_3 x + c_3.
\end{equation}
Коэффициенты данного полинома могут быть найдены из условий:
\begin{equation}
\label{eq_poly_bound}
\begin{array}{l}
f(-h) = u^n_{m-1}, f(0) = u^n_m, \\
f'(-h) = \nu^n_{m-1}, f'(0) = \nu^n_m.
\end{array}
\end{equation}

Исходя из (\ref{eq_poly_bound}) находим:
$$
\begin{array}{l}
a_3 = \frac{\nu_m + \nu_{m-1}}{h^2} - \frac{2 (u_m - u_{m-1})}{h^3}, \\
b_3 = \frac{2 \nu_m + \nu_{m-1}}{h} - \frac{3 (u_m - u_{m-1})}{h^2}, \\
c_3 = \nu_m, \\
d_3 = u_m.
\end{array}
$$

Разностная схема, используюущая полином (\ref{eq_poly_f3}), по всей видимости,
впервые была предложена в работе \cite{Yabe1991},
в ней данная схема описана как для линейных, так и для квазилинейных систем гиперболических уравнений.
В оригинальной статье данная схема названа CIP (Cubic-Interpolated Pseudo-particle),
в дальнейшем будем придерживаться этого названия.
В последующих работах схема CIP была распространена на многомерный случай,
а также предложены некоторые улучшения схемы \cite{Yabe2004}.
Во всех работах схема CIP используется либо без ограничителей вовсе,
либо с ограничителем построенным на расширенном шаблоне,
использующем также точку $(t^n, x_{m+1})$ \cite{Yabe1991}.
В данной работе предложен способ добиться от схемы монотонного поведения путем понижения порядка интерполяционного полинома (\ref{eq_poly_f3}),
используя при этом компактный шаблон (\ref{eq_stencil_3}).

Результат работы схемы CIP для импульса сложной формы представлен на рис. \ref{img_impulse}б.


Наряду с полиномом (\ref{eq_poly_f3}) рассмотрим полиномы второго порядка точности,
обозначим их как $F_{2l}(x)$ и $F_{2r}(x)$:
\begin{equation}
\label{eq_poly_f2l}
F_{2l}(x) = a_{2l} x^2 + b_{2l} x + c_{2l},
\end{equation}
\begin{equation}
\label{eq_poly_f2r}
F_{2r}(x) = a_{2r} x^2 + b_{2r} x + c_{2r}.
\end{equation}

При этом полином $F_{2l}(x)$ построен используя точки $u_{m-1}, u_m, \nu_{m-1}$,
а $F_{2r}(x)$ используя точки $u_{m-1}, u_m, \nu_m$.
Коэффициенты полиномов (\ref{eq_poly_f2l}) и (\ref{eq_poly_f2r}) можно найти из условий:
$$
\begin{array}{l}
F_{2l}(0) = u_m, F_{2l}(-h) = u_{m-1}, F_{2l}'(-h) = \nu_{m-1}, \\
F_{2r}(0) = u_m, F_{2r}(-h) = u_{m-1}, F_{2r}'(0) = \nu_m.
\end{array}
$$

Они имеют следующий вид:
$$
\begin{array}{l}
a_{2l} = \frac{u_m - u_{m-1}}{h^2} - \frac{\nu_{m-1}}{h}, \\
b_{2l} = \frac{2 (u_m - u_{m-1})}{h} - \nu_{m-1}, \\
a_{2r} = \frac{\nu_m}{h} - \frac{u_m - u_{m-1}}{h^2}, \\
b_{2r} = \nu_m, \\
c_{2l} = c_{2r} = u_m.
\end{array}
$$

Для дифференциального приближения полиномы можно получить дифференцированием (\ref{eq_poly_f2l}) и (\ref{eq_poly_f2r}):
\begin{equation}
\label{eq_poly_f2l_ext}
F_{2l}'(x) = 2 a_{2l} x + b_{2l},
\end{equation}
\begin{equation}
\label{eq_poly_f2r_ext}
F_{2r}'(x) = 2 a_{2r} x + b_{2r}.
\end{equation}

Схемы, построенные на данных полиномах, имеют второй порядок точности, однако сильно осциллируют.
В дальнейшем обозначать схемы, использующих полиномы (\ref{eq_poly_f2l}) и (\ref{eq_poly_f2r}),
будем CIP2L и CIP2R соответственно.

Также рассмотрим полином первого порядка точности на рассматривамом шаблоне
\begin{equation}
\label{eq_poly_f1}
F_1(x) = a_1 x + b_1.
\end{equation}
Исходя из условий на границах интервала
$$
F_1(0) = u_m, F_1(-h) = u_{m-1}
$$
находим коэффициенты полинома (\ref{eq_poly_f1}):
$$
\begin{array}{l}
a_1 = \frac{u_m - u_{m-1}}{h}, \\
b_1 = u_m.
\end{array}
$$
Аппроксимация данным полиномом представляет собой схему первого порядка типа КИР (Куранта-Изаксона-Риса).
Дифференциальное приближение (\ref{eq_advection_ext}) в этом случае будет аппроксимироваться по формуле:
$$
F_1'(x) = a_1.
$$
Обозначим данную схему как CIR.

Далее на основе данных полиномов предлагаются подходы к постоению компактных разностных схем на шаблоне (\ref{eq_stencil_3}),
с целью получения от схемы CIP монотонного поведения путем выбора различных интерполяционных полиномов в зависимости от поведения решения.

\section{Исследование интерполяционных полиномов}

Введем численную производную функции $u(t, h)$ на интервале $(-h, 0)$,
ее можно аппроксимировать используя формулу первого порядка точности:
$$
\nu_* = a_1 = (u_m - u_{m-1}) / h.
$$

Рассмотрим поведение различных полиномов в зависимости от значений искомых величин на выбранном шаблоне.

Знаки $\nu_*, \nu_m$ и $\nu_{m-1}$ совпадают, т. е. выполнены условия:
\begin{equation}
\label{eq_cond_1}
\begin{array}{l}
\nu_m \nu_{m-1} \ge 0, \\
\nu_* \nu_m \ge 0.
\end{array}
\end{equation}

С целью повышения порядка точности целесообразнее использовать полином тертьей степени $F_3(x)$,
однако при выполнении условия (\ref{eq_cond_1}) у функции $F_3(x)$ возможны экстремумы на интервале $(-h, 0)$.
Условие наличия экстремума равносильно условию изменения знака производной на рассматриваемом интервале,
данное условие можно записать, например, в виде
(значение в вершине параболы по знаку не совпадает со значением на границах интервала, и вершина параболы лежит внутри интервала):
\begin{equation}
\label{eq_cond_2}
\begin{array}{l}
-h \le x_0 \le 0, \\
F_3'(x_0) \nu_* < 0,
\end{array}
\end{equation}
где $x_0 = -\frac{b_3}{2 a_3}$ -- координата вершины параболы.

В случае выполнения условия (\ref{eq_cond_2}) необходимо понижение порядка полинома.
Рассмотрим возможность применения полиномов второго порядка.
Если
\begin{equation}
\label{eq_cond_3}
min(\nu_m, \nu_{m-1}) \le \nu_* \le max(\nu_m, \nu_{m-1}),
\end{equation}
то полиномы (\ref{eq_poly_f2l}) и (\ref{eq_poly_f2r}) лежат по разные стороны от прямой (\ref{eq_poly_f1}) на всем интервале $(-h, 0)$.
Выпуклая комбинация данных полиномов также будет полиномом второго порядка:
\begin{equation}
\label{eq_poly_f2lr}
F_{2lr}(x) = \alpha F_{2l}(x) + (1 - \alpha) F_{2r}(x),
\end{equation}
для всех $0 \le \alpha \le 1$.
Поскольку полиномы лежат по разные стороны от прямой (\ref{eq_poly_f1}),
то можно выбрать такое $\alpha$,
что в интервале $(-h, 0)$ будет выполнено $F_{2lr}(x) = F_1(x)$,
и используя монотонный полином первой степени можно аппроксимировать решение вторым порядком.
Это получается потому, что коэффициент перед $x^2$ зануляется в полиноме (\ref{eq_poly_f2lr}).

Если условие (\ref{eq_cond_3}) не выполнено,
то полиномы (\ref{eq_poly_f2l}) и (\ref{eq_poly_f2r}) лежат по одну сторону от прямой (\ref{eq_poly_f1}) на интервале $(-h, 0)$.
В данной ситуации можно выбрать тот из полиномов,
который не имеет экстремума на интервале $(-h, 0)$,
в случае если оба полинома имеют экстремум, можно воспользоваться схемой первого порядка (\ref{eq_poly_f1}).
Однако, как показали тестовые расчеты,
по крайней мере для линейных уравнений,
можно выбрать тот из полиномов, который построен на производной лежащей ближе к $\nu_*$,
данное условие можно записать как
\begin{equation}
\label{eq_cond_4}
F(x) =
\begin{cases}
F_{2l}(x), & \Delta_{m-1} \le \Delta_m \\
F_{2r}(x), & \Delta_{m-1} > \Delta_m
\end{cases},
\end{equation}
где $\Delta_i = |\nu_i - \nu_*|$.
Использование такого подхода позволяет обеспечить второй порядок точности,
однако не гарантирует отсутствие экстремума на отрезке.

Рассмотрим следующий случай, знаки $\nu_m$ и $\nu_{m-1}$ различны, т. е.
\begin{equation}
\label{eq_cond_5}
\nu_m \nu_{m-1} < 0.
\end{equation}
В данном случае, при использовании интерполяции выше первого порядка, на рассматриваемом интервале всегда будет экстремум.
Однако поскольку производные меняют знак,
то наличие экстремума не является нефизичной осцилляцией и,
как показывают тесты,
применение полиномов порядков выше первого,
не вызывают появления нефизичных осцилляций в решении.
Полиномы второго порядка при таких условиях лежат по одну сторону от прямой заданной полиномом (\ref{eq_poly_f1}) на отрезке $(-h, 0)$,
и воспользоваться их выпуклой комбинацией нет возможности.
Можно использовать полином третьей степени (\ref{eq_poly_f3}),
либо выбрать полином второй степени исходя из условия (\ref{eq_cond_4}).
Для получения монотонного решения необходимо использовать интерполяцию первого порядка (\ref{eq_poly_f1}).

Наконец, знаки $\nu_m$, $\nu_{m-1}$ одинаковые, но отличны от знака $\nu_*$:
\begin{equation}
\label{eq_cond_6}
\begin{array}{l}
\nu_m \nu_{m-1} \ge 0, \\
\nu_* \nu_m \le 0.
\end{array}
\end{equation}
Тогда полином третьего порядка (\ref{eq_poly_f3}) имеет два экстремума в интервале $(-h, 0)$ и не применим.
Полиномы второго порядка (\ref{eq_poly_f2l}) и (\ref{eq_poly_f2r}) также имеют экстремумы на рассматриваемом интервале,
однако они лежат по разные стороны от прямой (\ref{eq_poly_f1}).
Используя их выпуклую комбинацию (\ref{eq_poly_f2lr}) всегда можно занулить коэффициент перед квадратичным членом в полученном полиноме
и использовать монотонный линейный полином (\ref{eq_poly_f1}), дающий в данном случае второй порядок аппроксимации.

На основе вышеизложенного анализа можно, выбирая в зависимости от решения тот или иной полином,
построить гибридную схему, дающую решение с монотонным поведением и отсутствием нефизичных осцилляций.

\section{Гибридные схемы}

Гибридизация, рассматриваемая в рамках данной работы,
заключается в выборе того или иного интерполяционного полинома в зависимости от характера решения на основе вышеизложенного материала.

Рассмотрим две гибридные схемы.

\subsection{Сеточно-характеристическая монотонизация}

Сеточно-характеристические схемы опираются на использовании характеристического критерия монотонности \cite{Khol2006, Magometov-Kholodov-1969}:
\begin{equation}
\label{eq_cond_gc}
min(u_m, u_{m-1}) \le u^{n+1}_m \le max(u_m, u_{m-1}).
\end{equation}
Подробно построение разностных схем, в том числе для продолженных систем уравнений,
основываных на использовании характеристического критерия монотонности (\ref{eq_cond_gc}) описано в \cite{Khol2006}.
Там же приводятся конечно-разностные схемы третьего и четвертого порядка точности для продолженных систем уравнений (\ref{eq_advection}) и (\ref{eq_advection_ext})
на компактном шаблоне (\ref{eq_stencil_3}).
В данной работе, в отличии от \cite{Khol2006},
используется интерполяционный полином, для решения изначальной системы (\ref{eq_advection}),
и производная от интерполяционного полинома, для решения дифференциального следствия (\ref{eq_advection_ext}).
В работе \cite{Khol2006} системы (\ref{eq_advection}) и (\ref{eq_advection_ext}) решаются независимо,
используя различные разностные схемы.
При этом гибридизация схем для изначальной системы уравнений и ее дифференциального следствия осуществляется независимо.

Гибридизация, основанная на характеристическом критерии,
для схем описанных в данной работе, осуществляется следующим образом.
Вычисляется значения $u^{n+1}_m$ используя некий интерполяционный полином.
Для полученного значения проверяется выполнение характеристического критерия монотонности (\ref{eq_cond_gc}),
в случае если критерий не выполнен порядок полинома понижается до тех пор,
пока не будет выполнен критерий (\ref{eq_cond_gc}) либо мы не прийдем к полиному первого порядка.
Данная операция производится последовательно над полиномами $F_3(x)$, $F_{2l}(x)$, $F_{2r}(x)$ и $F_1(x)$.
После выбора полинома для интерполяции вычисляется значение $\nu^{n+1}_m$ используя его производную.
Для данной схемы будем в дальнейшем использовать обозначение БИС1 (бикомпактная интерполяционная схема).

\subsection{Гибридная схема 2-3 порядка точности}

Также исследовалась гибридизация схемы третьего порядка точности исходя из поведения полиномов на рассматриваемом интервале.
Схема строится следующим образом.
Если выполнены условия (\ref{eq_cond_1}) и (\ref{eq_cond_2}) используется схема второго порядка исходя из (\ref{eq_cond_4}).
Если выполнено (\ref{eq_cond_1}), но не выполнено (\ref{eq_cond_2}) используется схема третьего порядка (\ref{eq_poly_f3}).
Если выполнено условие (\ref{eq_cond_3}) используется полином первого порядка (\ref{eq_poly_f1}), но как показано выше он будет давать второй порядок.
В случае выполнения условия (\ref{eq_cond_5}) используются полиномы второго порядка, исходя из (\ref{eq_cond_4}).
Наконец, при выполнении условия (\ref{eq_cond_6}) используется полином первого порядка (\ref{eq_poly_f1}), также дающий второй порядок.
Обозначим данную схему как БИС2.
Схема тестировалась на импульсе сложной формы (\ref{eq_complex_impulse}) при различных значениях числа Куранта,
во всех случаях схема показывала монотонное поведение с отсутствием нефизичных осцилляций.

\section{Тестирование схем}

Тест на качественное поведение разностных схем проводился с импульсом сложной формы \cite{Balsara2000, Jiang1995, Suresh1997}:
\begin{equation}
\label{eq_complex_impulse}
u(0, x) = 
\begin{cases}
\exp(-\ln 2 (x + 0.7)^2 / 0.0009), & -0.8 \le x \le -0.6, \\
1, & -0.4 \le x \le -0.2, \\
1 - |10 x - 1|, & 0.0 \le x \le 0.2, \\
(1 - 100 (x - 0.5)^2)^{1/2}, & 0.4 \le x \le 0.6, \\
0, & \mbox{в противном случае}.
\end{cases}
\end{equation}
Данное начальное условие состоит из разрывного прямоугольного импульса,
треугольного импульса, испульса формы гауссого распределения и половины эллипса.
Использовалась сетка, состоящая из 200 узлов и с периодичными граничными условиями.
Решение представленно после 400 шагов разностной схемы,
шаг по времени выбирался исходя из числа Куранта $0.5$.
Результаты для всех схем представленны на рис. \ref{img_impulse}.

Как видно из графиков, схемы построенные на полиномах порядка выше первого, осциллируют.
При этом схема третьего порядка имеет наименьшие осцилляции и, в ряде случаев, может быть применена без монотонизатора.
Гибридные схемы имеют монотонное поведение,
схема БИС1 монотонна по характеристическому критерию,
схема БИС2 показывает монотонное поведение,
к тому же на узких импульсах показывает более лучшее поведение чем схема БИС1.
По всей видимости это связано с тем, что при наличии естественного экстремума на интервале $(-h, 0)$,
характеристический критерий его срежет.

Нормы ошибок для данного теста приведены в таблице \ref{tab_errors}.
Использовались следующие нормы: $L_1 = \sum\limits_i |x_i|$, $L_2 = (\sum\limits_i x_i^2)^{1/2}$, $L_{\infty} = max |x_i|$.

Как видно наименьшие нормы дает схема CIP, однако из неосциллирующих схем меньшие ошибки у схемы БИС2.

В таблице \ref{tab_convergence} приведены результаты тестирования сеточной сходимости рассмотренных схем.
В качестве начальных условий задавался импульс $u_0(x) = \sin^4(\pi x)$ в области $[-1,1]$ и периодическими граничными условиями.
Как видно из результатов численный порядок сходимости схемы БИС2 больше чем у БИС1.

\section{Заключение}

В работе рассмотрен ряд компактных разностных схем для одномерного уравнения переноса на двухточечном шаблоне.
Разностные схемы построены используя интерполяционные полиномы 1-3 порядка точности.
На основе различных разностных схем, возможных на данном шаблоне построены гибридные разностные схемы,
обладающие монотонным поведением.
Построена гибридная разностная схема, основанная на сеточно-характеристическом критерии монотонности,
и гибридная разностная схема основанная на критерии гибридизации, предложенным в данной работе.
Критерий гибридизации основан на поиске локальных экстремумов на интервале, который включает в себя сеточный шаблон.
В результате удалось получить схемы, дающие монотонное поведение и слабо размывающие решение со временем.
Теоретически порядок построенных схем 1-3, в зависимости от поведения решения.
Численное исследование сходимости разностных схем показывает порядок точности 2-2.6.

\begin{acknowledgments}
Авторы статьи благодарят академика РАН Белоцерковского О. М. и члена-корреспондента РАН Холодова А. С. за внимание к данной работе.
\end{acknowledgments}

%
% Список литературы
%
\bibliography{ref}{}
\bibliographystyle{maik}

\begin{figure}[htb]
\setcaptionmargin{5mm}
\onelinecaptionstrue
\includegraphics{img1.eps}
\captionstyle{normal}
\caption{Шаблон разностной схемы}
\label{img_stencil}
\end{figure}


\begin{figure}[htb]
\setcaptionmargin{5mm}
\onelinecaptionstrue
\includegraphics{img2.eps}
\captionstyle{normal}
\caption{
Численное (точки) и точное (линия) решение линейного уравнения переноса (\ref{eq_advection})
для начальных данных (\ref{eq_complex_impulse}) через 400 шагов разностной схемы.
a) -- CIR; б) -- CIP; в) -- CIP2L; г) -- CIP2R; д) -- БИС1; е) -- БИС2.
}
\label{img_impulse}
\end{figure}


\begin{table}
\setcaptionmargin{0mm} \onelinecaptionsfalse
\captionstyle{flushleft} \caption {Нормы ошибок для различных схем. Вектор переноса направлен вдоль диагонали ячеек сетки} \label{tab_errors_diagonal}
\bigskip
\input{table1.tex}
\end{table}


\begin{table}
\setcaptionmargin{0mm} \onelinecaptionsfalse
\captionstyle{flushleft} \caption {Нормы ошибок для различных схем. Вектор переноса направлен не вдоль диагонали ячеек сетки} \label{tab_errors}
\bigskip
\input{table2.tex}
\end{table}


\begin{table}
\setcaptionmargin{0mm} \onelinecaptionsfalse
\captionstyle{flushleft} \caption {Сеточная сходимость. Вектор переноса направлен вдоль диагонали ячеек сетки} \label{tab_convergence}
\bigskip
\input{table3.tex}
\end{table}


\begin{table}
\setcaptionmargin{0mm} \onelinecaptionsfalse
\captionstyle{flushleft} \caption {Сеточная сходимость. Вектор переноса направлен не вдоль диагонали ячеек сетки} \label{tab_convergence_diagonal}
\bigskip
\input{table4.tex}
\end{table}


\end{document}
%%%%%%%%%%%%%%%%%%%%%%%%%%%% Character code reference %%%%%%%%%%%%%%%%%%%%%%%%%%
%                                                                             %
%     Upper case russian letters (CP866): АБВГДЕЁЖЗИЙКЛМНОПРСТУФХЦЧШЩЪЫЬЭЮЯ   %                                                                       %
%     Lower case russian letters (CP866): абвгдеёжзийклмнопрстуфхцчшщъыьэюя   %
%                     Upper case letters: ABCDEFGHIJKLMNOPQRSTUVWXYZ          %
%                     Lower case letters: abcdefghijklmnopqrstuvwxyz          %
%                                   Digits: 0123456789                        %
% Square, curly, angle braces, parentheses: [] {} <> ()                       %
%                Backslash, slash, solidus: \ / |                             %
%       Period, interrogative, exclamation: . ? !                             %
%                 Comma, colon, semi-colon: , : ;                             %
%          Underscore, hyphen, equals sign: _ - =                             %
%             Quotes (left, right, double): ` ' "                             %
%     Commercial-at, hash, dollar, percent: @ # $ %                           %
%  Ampersand, asterisk, plus, caret, tilde: & * +   ^                         %
%                                                                             %
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% ****** End of file apssampr.tex ******
